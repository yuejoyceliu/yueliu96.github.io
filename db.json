{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"source/images/1.jpg","path":"images/1.jpg","modified":1,"renderable":0},{"_id":"source/images/2.jpg","path":"images/2.jpg","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"302b857a701a00d1ec91d371174afb26843e7a1c","modified":1546638009306},{"_id":"source/CNAME","hash":"34b0caf4553966b44e77c33fc9be806570c103a8","modified":1546638009307},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1546638009454},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1546638009454},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1546638009468},{"_id":"themes/next/.gitignore","hash":"0b5c2ffd41f66eb1849d6426ba8cf9649eeed329","modified":1546638009461},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1546638009348},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1546638009453},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1546638009453},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1546638009469},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1546638009492},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1546638009314},{"_id":"themes/next/README.cn.md","hash":"2c766b3369ed477bce134a5450dab45bef161504","modified":1546638009314},{"_id":"themes/next/README.md","hash":"8ce60ce578963eb4e1eb5e33e1efc2fc4779af9c","modified":1546638009460},{"_id":"themes/next/_config.yml","hash":"373376fd4fb11d96c0d18d2039731078bbe2d2ad","modified":1546997571607},{"_id":"themes/next/bower.json","hash":"0674f11d3d514e087a176da0e1d85c2286aa5fba","modified":1546638009453},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1546638009348},{"_id":"themes/next/package.json","hash":"036d3a1346203d2f1a3958024df7f74e7ac07bfe","modified":1546638009461},{"_id":"source/_posts/Gaussian-on-Hyak.md","hash":"2741c4efffc861cedf1c4b78d864d5818b82fbc6","modified":1546638009311},{"_id":"source/_posts/Hyak-Tips.md","hash":"a6096f731b52c4a7d905cea46f18b9179bcee3d9","modified":1546638009311},{"_id":"source/_posts/Mopac-with-Cuby4.md","hash":"a87940ce6a6698e9cdf3bac35793cf898339b60f","modified":1546638009309},{"_id":"source/_posts/Newton-X-on-Hyak.md","hash":"2049d8e495c964833e43791de33cfc1a45bb934c","modified":1546638009310},{"_id":"source/_posts/Nucleotide-Papers.md","hash":"89c54132ce306ee09d6e03d702eb82af34b72974","modified":1546993474831},{"_id":"source/_posts/Scientific-Computing.md","hash":"640ce6e6aa12daa21faa23a6fd4a69597289b365","modified":1546638009310},{"_id":"source/categories/index.md","hash":"e990de558ab07030e63299e19b6890b46ebea2cc","modified":1546638009313},{"_id":"source/images/1.jpg","hash":"2fdff1a3c058e5372b6d203c064f000ba95fb4bd","modified":1546638009308},{"_id":"source/images/2.jpg","hash":"e33b4160050646dfca5df19826522c652ebaa330","modified":1546638009307},{"_id":"source/tags/index.md","hash":"7a3dbc2db7783440e1e1265294488c986083ba2f","modified":1546638009312},{"_id":"themes/next/.git/COMMIT_EDITMSG","hash":"5f34d5fbff766861237d89ebb6d2c0e976fa9c1d","modified":1546638380812},{"_id":"themes/next/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1546638009480},{"_id":"themes/next/.git/config","hash":"bf7d1df65cf34d0f25a7184a58c37a09f72e4be7","modified":1546638009469},{"_id":"themes/next/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1546638009484},{"_id":"themes/next/.git/index","hash":"ff91c349c51f0224584d4efefcdca35dc9214c83","modified":1546638380811},{"_id":"themes/next/.git/packed-refs","hash":"69237944e31c16fe545d1f47b0b1e5b1d99660da","modified":1546638009491},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1546638009468},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"50d48c47162817a3810a9d9ad51104e83947419a","modified":1546638009468},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"902f627155a65099e0a37842ff396a58d0dc306f","modified":1546638009467},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1546638009467},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1546638009457},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1546638009455},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1546638009458},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1546638009459},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1546638009456},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1546638009457},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1546638009458},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1546638009456},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1546638009458},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1546638009455},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1546638009457},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1546638009459},{"_id":"themes/next/languages/vi.yml","hash":"fd08d3c8d2c62965a98ac420fdaf95e54c25d97c","modified":1546638009460},{"_id":"themes/next/languages/zh-Hans.yml","hash":"16ef56d0dea94638de7d200984c90ae56f26b4fe","modified":1546638009455},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1546638009459},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1546638009460},{"_id":"themes/next/layout/_layout.swig","hash":"da0929166674ea637e0ad454f85ad0d7bac4aff2","modified":1546638009318},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1546638009330},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1546638009318},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1546638009323},{"_id":"themes/next/layout/page.swig","hash":"969caaee05bdea725e99016eb63d810893a73e99","modified":1546638009322},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1546638009322},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1546638009316},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1546638009316},{"_id":"themes/next/scripts/merge-configs.js","hash":"81e86717ecfb775986b945d17f0a4ba27532ef07","modified":1546638009463},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1546638009462},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1546638009315},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1546638009315},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1546638009315},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009452},{"_id":"themes/next/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1546638009485},{"_id":"themes/next/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1546638009484},{"_id":"themes/next/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1546638009486},{"_id":"themes/next/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1546638009487},{"_id":"themes/next/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1546638009487},{"_id":"themes/next/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1546638009485},{"_id":"themes/next/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1546638009488},{"_id":"themes/next/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1546638009485},{"_id":"themes/next/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1546638009486},{"_id":"themes/next/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1546638009487},{"_id":"themes/next/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1546638009488},{"_id":"themes/next/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1546638009481},{"_id":"themes/next/.git/logs/HEAD","hash":"a4db6ec691b4e74c700808959279a140f8ec18d4","modified":1546638380814},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1546638009317},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1546638009317},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1546638009348},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1546638009347},{"_id":"themes/next/layout/_macro/post.swig","hash":"446a35a2cd389f8cfc3aa38973a9b44ad0740134","modified":1546638009346},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1546638009347},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"6a54c3c85ff6b19d275827a327abbf4bd99b2ebf","modified":1546638009346},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1546638009346},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1546638009327},{"_id":"themes/next/layout/_partials/footer.swig","hash":"c4d6181f5d3db5365e622f78714af8cc58d7a45e","modified":1546638009327},{"_id":"themes/next/layout/_partials/header.swig","hash":"ed042be6252848058c90109236ec988e392d91d4","modified":1546638009328},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1546638009324},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1546638009326},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1546638009320},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1546638009321},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1546638009321},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1546638009339},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1546638009335},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1546638009336},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1546638009339},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1546638009340},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1546638009335},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1546638009336},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1546638009328},{"_id":"themes/next/layout/_partials/head.swig","hash":"6b94fe8f3279daea5623c49ef4bb35917ba57510","modified":1546638009328},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1546638009465},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1546638009464},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1546638009466},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1546638009465},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1546638009466},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1546638009466},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1546638009463},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1546638009464},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1546638009464},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1546638009383},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1546638009399},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1546638009401},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1546638009398},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1546638009403},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1546638009400},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1546638009398},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1546638009398},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1546638009402},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1546638009399},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1546638009403},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1546638009402},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1546638009401},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1546638009400},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1546638009403},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1546638009397},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1546638009400},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1546638009402},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1546638009399},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009319},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009320},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009396},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009397},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009395},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009383},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1546638009381},{"_id":"themes/next/.git/objects/0f/cfd8ca662fcce8e3ebd4132edef31b25b97753","hash":"7d7008a596ec7a1025cab1a0bb605518215b6161","modified":1546638380811},{"_id":"themes/next/.git/objects/86/93a6b1ebc353272f579aa84000681a89526cc1","hash":"d85f17554d334a8c4cf566350971ff75ca363bdb","modified":1546638380813},{"_id":"themes/next/.git/objects/dd/cd3eedf60b943ee98ccc1ffc058d7c22e30a7f","hash":"74399d87ea775b177003d167f0e6609d7e6c5b37","modified":1546638338728},{"_id":"themes/next/.git/refs/heads/master","hash":"2cecb1555522d07e849e415d9127f57fa81128b2","modified":1546638380814},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1546638009326},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1546638009326},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1546638009325},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1546638009324},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1546638009325},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1546638009330},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1546638009329},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1546638009329},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1546638009330},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1546638009322},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1546638009319},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1546638009320},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1546638009343},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1546638009342},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1546638009344},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1546638009345},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"18e7bef8923d83ea42df6c97405e515a876cede4","modified":1546638009342},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1546638009343},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1546638009344},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1546638009341},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1546638009342},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1546638009345},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1546638009343},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1546638009344},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1546638009341},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1546638009334},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1546638009332},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1546638009334},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1546638009332},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1546638009333},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1546638009333},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1546638009335},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1546638009332},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1546638009333},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1546638009337},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1546638009337},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1546638009337},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1546638009340},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"328d9a9696cc2ccf59c67d3c26000d569f46344c","modified":1546638009350},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1546638009395},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1546638009396},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1546638009396},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1546638009382},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1546638009382},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1546638009383},{"_id":"themes/next/source/css/_variables/base.styl","hash":"29c261fa6b4046322559074d75239c6b272fb8a3","modified":1546638009382},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1546638009409},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1546638009407},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1546638009406},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1546638009408},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1546638009405},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1546638009406},{"_id":"themes/next/source/js/src/motion.js","hash":"754b294394f102c8fd9423a1789ddb1201677898","modified":1546638009408},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1546638009407},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1546638009406},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1546638009406},{"_id":"themes/next/source/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1546638009408},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1546638009415},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1546638009431},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1546638009416},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1546638009424},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1546638009424},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1546638009411},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1546638009410},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1546638009411},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1546638009410},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1546638009448},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1546638009448},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1546638009446},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1546638009448},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1546638009447},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1546638009425},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1546638009440},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1546638009440},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1546638009439},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1546638009439},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1546638009441},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1546638009439},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1546638009414},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1546638009413},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1546638009413},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1546638009429},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1546638009427},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1546638009429},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1546638009427},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1546638009430},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1546638009429},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1546638009430},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1546638009426},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1546638009428},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1546638009427},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1546638009431},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1546638009428},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1546638009426},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1546638009435},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1546638009435},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1546638009433},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1546638009433},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1546638009432},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1546638009428},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1546638009436},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1546638009432},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1546638009433},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1546638009425},{"_id":"themes/next/.git/logs/refs/heads/master","hash":"a4db6ec691b4e74c700808959279a140f8ec18d4","modified":1546638380814},{"_id":"themes/next/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1546638009490},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1546638009338},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1546638009339},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1546638009366},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"31050fc7a25784805b4843550151c93bfa55c9c8","modified":1546638009371},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1546638009366},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1546638009367},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1546638009353},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1546638009366},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1546638009371},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1546638009381},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"f7c44b0ee46cf2cf82a4c9455ba8d8b55299976f","modified":1546638009351},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1546638009351},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1546638009352},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1546638009351},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1546638009352},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1546638009352},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1546638009387},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1546638009391},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1546638009393},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1546638009394},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1546638009394},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1546638009392},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1546638009393},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1546638009391},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1546638009385},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1546638009386},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"4aac01962520d60b03b23022ab601ad4bd19c08c","modified":1546638009386},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1546638009386},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1546638009385},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1546638009389},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1546638009388},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1546638009390},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1546638009388},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9d16fa3c14ed76b71229f022b63a02fd0f580958","modified":1546638009389},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1546638009389},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1546638009405},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1546638009442},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1546638009445},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1546638009420},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1546638009420},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1546638009420},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1546638009418},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1546638009418},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1546638009419},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1546638009418},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1546638009419},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1546638009417},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1546638009412},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1546638009412},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1546638009446},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1546638009447},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1546638009447},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1546638009438},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1546638009437},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1546638009442},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1546638009442},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1546638009451},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1546638009450},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1546638009434},{"_id":"themes/next/.git/logs/refs/remotes/origin/HEAD","hash":"9f5d9911207b7d62c72c6e0fd0907394d2431f3c","modified":1546638009483},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1546638009358},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1546638009380},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1546638009380},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1546638009379},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1546638009378},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1546638009379},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1546638009365},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1546638009364},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1546638009365},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1546638009377},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1546638009378},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"2039590632bba3943c39319d80ef630af7928185","modified":1546638009377},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1546638009377},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1546638009376},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1546638009362},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1546638009363},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1546638009362},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1546638009362},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1546638009364},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1546638009360},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1546638009359},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1546638009360},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1546638009358},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1546638009359},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1546638009361},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1546638009360},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1546638009361},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1546638009363},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"262debfd4442fa03d9919ceb88b948339df03fb0","modified":1546638009359},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1546638009354},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"920343e41c124221a17f050bbb989494d44f7a24","modified":1546638009356},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1546638009355},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1546638009354},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1546638009357},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1546638009355},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"12937cae17c96c74d5c58db6cb29de3b2dfa14a2","modified":1546638009356},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1546638009357},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1546638009356},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1546638009355},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1546638009370},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1546638009368},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"37e951e734a252fe8a81f452b963df2ba90bfe90","modified":1546638009368},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1546638009370},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1546638009369},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1546638009369},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1546638009370},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1546638009368},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1546638009369},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1546638009374},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1546638009372},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1546638009373},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1546638009373},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1546638009372},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1546638009375},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1546638009373},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1546638009375},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1546638009375},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1546638009374},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1546638009392},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1546638009391},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1546638009384},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1546638009443},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1546638009443},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1546638009444},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1546638009445},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1546638009444},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1546638009421},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1546638009423},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1546638009423},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1546638009422},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1546638009422},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1546638009422},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1546638009450},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1546638009452},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1546638009451},{"_id":"themes/next/.git/objects/pack/pack-1b80b41c64d61c1e5e55fc67b35497bd98589095.idx","hash":"976514cc31374cafe8545b3643142a6facb743cf","modified":1546638009479},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1546638009415},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1546638009449},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1546638009436},{"_id":"themes/next/.git/objects/pack/pack-1b80b41c64d61c1e5e55fc67b35497bd98589095.pack","hash":"26d8e1e2208fd8011a3c35cad66f252602a540df","modified":1546638009477}],"Category":[{"name":"Turecek Lab Tutorial","_id":"cjqojihky0004p45kfrwh3471"},{"name":"NoteBook","_id":"cjqojihq8000jp45kbr6k1wup"}],"Data":[],"Page":[{"title":"categories","date":"2018-12-18T07:03:54.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2018-12-17 23:03:54\ntype: \"categories\"\n---\n","updated":"2019-01-04T21:40:09.313Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cjqojihkv0001p45kgrbdz1gg","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"tags","date":"2018-12-18T07:05:29.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2018-12-17 23:05:29\ntype: \"tags\"\n---\n","updated":"2019-01-04T21:40:09.312Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cjqojihkx0003p45k5m6pjtg8","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Hyak Tips","date":"2018-12-31T21:41:04.000Z","_content":"\nTips on: [file transfer](#scp) | [memory & disk space](#memdisk) | [python scripts](#pyscripts) | [squeue format](#squeue) | to be continue...\n\nHyak Mox Overview website: [click me](https://wiki.cac.washington.edu/display/hyakusers/Hyak+mox+Overview)\n\n# <jump id='scp'>File Transfer</jump>\n\n- from ikt to mox\n  \n  ```\n  hyakbbcp myfile mox1.hyak.uw.edu:mydirectory\n  hyakbbcp -r myfolder mox1.hyak.uw.edu:mydirectory\n  ```\n\n- from mox to ikt\n\n  ```\n  hyakbbcp myfile ikt1.hyak.uw.edu:mydirectory\n  hyakbbcp -r myfolder ikt1.hyak.uw.edu:mydirectory\n  ```\n- into hyak\n  \n  ```\n  scp myfile user@mox.hyak.uw.edu:path/of/destination\n  ```\n- out of hyak\n  \n  ```\n  scp user@ikt.hyak.uw.edu:path/of/your/file .\n  ```\n\n- into or out of hyak by sftp\n  \n  ```\n  sftp user@mox.hyak.uw.edu\n  get myfile   #move myfile from hyak to local direcotry\n  get -r myfolder \n  put myfile   #move myfile from local directory to hyak\n  put -r myfolder\n  ls           #list files and folders on hyak directory\n  lls          #list files and folders on local directory\n  ```\n\n# <jump id='memdisk'>Memory and Disk Space\n\n- Commonality\n  - Place to hold data\n  - Unit: bytes, kilobytes, megabytes, etc\n- Difference\n  - Memory is known as random access memory (RAM), which stores actively running programs on the computer. The more memory is, the more it is able to run complex programs and more programs at the same time.\n  - Disk space is a spindle of magnetic discs to store files you download, install or save.\n- Command\n  - mem: `free -g` (g:GB,m:MB,k:KB)\n  - disk space: `df -h`\n\n# <jump id='pyscripts'>Python Scripts</jump>\n\n- It's a good choice to store useful python scripts in user's home directory, whose quotas are set to 10 GB with a limit of 5,000 files. \n- Python scripts starting with `#!/usr/bin/env python`, can be executed by `directory/pyfile ...` besides `python pyfile ...`. \n- Use `chmod u+x pyfile` if it isn't executable\n- Batch operation of python scripts by bash command `for ...; do ...; done`\n  - example: \n   \n     If *xyz2gjf$.$py* (usage: `python xyz2gjf.py xyz-file` )is in a subdirecotry *myscripts* of home directory, run `chmod u+x ~/myscripts/xyz2gjf.py` first if it is not executable, move to a directory containing several xyz files and run `for i in *xyz; do ~/myscripts/xyz2gjf.py $i; done` to convert all *xyz files to gjf format.\n\n# <jump id='squeue'>Squeue Format</jump>\n\nadd `export SQUEUE_FORMAT=\"the-format-you-like\"` to /.bash_profile file and then run `source /.bash_profile`\n\n- My own version:\n  \n  ```\n  export SQUEUE_FORMAT=\"%.7i %9P %15j %.8u %.2t %.12M %.12L %.5C %.7m  %.4D %R\"\n  ```\n    what is like:\n\n    ```\n      JOBID PARTITION NAME          USER ST         TIME    TIME_LEFT  CPUS MIN_MEM  NODE NODELIST(REASON)\n     547841 chem      gN1_ccsd  yueliu96  R   1-23:14:00  10-12:46:00    28    245G     1 n2079  \n    ```\n- Note:\n  - `%.`: align rigt\n  - `%` withou dot: aligh left\n  - integer: length of occupied space\n  - different letters correspond to diffrent items, see [link](https://slurm.schedmd.com/squeue.html) for details\n\n","source":"_posts/Hyak-Tips.md","raw":"---\ntitle: Hyak Tips\ndate: 2018-12-31 13:41:04\ntags:\n- Hyak\ncategories:\n- Turecek Lab Tutorial\n---\n\nTips on: [file transfer](#scp) | [memory & disk space](#memdisk) | [python scripts](#pyscripts) | [squeue format](#squeue) | to be continue...\n\nHyak Mox Overview website: [click me](https://wiki.cac.washington.edu/display/hyakusers/Hyak+mox+Overview)\n\n# <jump id='scp'>File Transfer</jump>\n\n- from ikt to mox\n  \n  ```\n  hyakbbcp myfile mox1.hyak.uw.edu:mydirectory\n  hyakbbcp -r myfolder mox1.hyak.uw.edu:mydirectory\n  ```\n\n- from mox to ikt\n\n  ```\n  hyakbbcp myfile ikt1.hyak.uw.edu:mydirectory\n  hyakbbcp -r myfolder ikt1.hyak.uw.edu:mydirectory\n  ```\n- into hyak\n  \n  ```\n  scp myfile user@mox.hyak.uw.edu:path/of/destination\n  ```\n- out of hyak\n  \n  ```\n  scp user@ikt.hyak.uw.edu:path/of/your/file .\n  ```\n\n- into or out of hyak by sftp\n  \n  ```\n  sftp user@mox.hyak.uw.edu\n  get myfile   #move myfile from hyak to local direcotry\n  get -r myfolder \n  put myfile   #move myfile from local directory to hyak\n  put -r myfolder\n  ls           #list files and folders on hyak directory\n  lls          #list files and folders on local directory\n  ```\n\n# <jump id='memdisk'>Memory and Disk Space\n\n- Commonality\n  - Place to hold data\n  - Unit: bytes, kilobytes, megabytes, etc\n- Difference\n  - Memory is known as random access memory (RAM), which stores actively running programs on the computer. The more memory is, the more it is able to run complex programs and more programs at the same time.\n  - Disk space is a spindle of magnetic discs to store files you download, install or save.\n- Command\n  - mem: `free -g` (g:GB,m:MB,k:KB)\n  - disk space: `df -h`\n\n# <jump id='pyscripts'>Python Scripts</jump>\n\n- It's a good choice to store useful python scripts in user's home directory, whose quotas are set to 10 GB with a limit of 5,000 files. \n- Python scripts starting with `#!/usr/bin/env python`, can be executed by `directory/pyfile ...` besides `python pyfile ...`. \n- Use `chmod u+x pyfile` if it isn't executable\n- Batch operation of python scripts by bash command `for ...; do ...; done`\n  - example: \n   \n     If *xyz2gjf$.$py* (usage: `python xyz2gjf.py xyz-file` )is in a subdirecotry *myscripts* of home directory, run `chmod u+x ~/myscripts/xyz2gjf.py` first if it is not executable, move to a directory containing several xyz files and run `for i in *xyz; do ~/myscripts/xyz2gjf.py $i; done` to convert all *xyz files to gjf format.\n\n# <jump id='squeue'>Squeue Format</jump>\n\nadd `export SQUEUE_FORMAT=\"the-format-you-like\"` to /.bash_profile file and then run `source /.bash_profile`\n\n- My own version:\n  \n  ```\n  export SQUEUE_FORMAT=\"%.7i %9P %15j %.8u %.2t %.12M %.12L %.5C %.7m  %.4D %R\"\n  ```\n    what is like:\n\n    ```\n      JOBID PARTITION NAME          USER ST         TIME    TIME_LEFT  CPUS MIN_MEM  NODE NODELIST(REASON)\n     547841 chem      gN1_ccsd  yueliu96  R   1-23:14:00  10-12:46:00    28    245G     1 n2079  \n    ```\n- Note:\n  - `%.`: align rigt\n  - `%` withou dot: aligh left\n  - integer: length of occupied space\n  - different letters correspond to diffrent items, see [link](https://slurm.schedmd.com/squeue.html) for details\n\n","slug":"Hyak-Tips","published":1,"updated":"2019-01-04T21:40:09.311Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjqojihkq0000p45kydpwb5ub","content":"<p>Tips on: <a href=\"#scp\">file transfer</a> | <a href=\"#memdisk\">memory &amp; disk space</a> | <a href=\"#pyscripts\">python scripts</a> | <a href=\"#squeue\">squeue format</a> | to be continue</p>\n<p>Hyak Mox Overview website: <a href=\"https://wiki.cac.washington.edu/display/hyakusers/Hyak+mox+Overview\" target=\"_blank\" rel=\"noopener\">click me</a></p>\n<h1 id=\"File-Transfer\"><a href=\"#File-Transfer\" class=\"headerlink\" title=\"File Transfer\"></a><jump id=\"scp\">File Transfer</jump></h1><ul>\n<li><p>from ikt to mox</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hyakbbcp myfile mox1.hyak.uw.edu:mydirectory</span><br><span class=\"line\">hyakbbcp -r myfolder mox1.hyak.uw.edu:mydirectory</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>from mox to ikt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hyakbbcp myfile ikt1.hyak.uw.edu:mydirectory</span><br><span class=\"line\">hyakbbcp -r myfolder ikt1.hyak.uw.edu:mydirectory</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>into hyak</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp myfile user@mox.hyak.uw.edu:path/of/destination</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>out of hyak</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp user@ikt.hyak.uw.edu:path/of/your/file .</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>into or out of hyak by sftp</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sftp user@mox.hyak.uw.edu</span><br><span class=\"line\">get myfile   #move myfile from hyak to local direcotry</span><br><span class=\"line\">get -r myfolder </span><br><span class=\"line\">put myfile   #move myfile from local directory to hyak</span><br><span class=\"line\">put -r myfolder</span><br><span class=\"line\">ls           #list files and folders on hyak directory</span><br><span class=\"line\">lls          #list files and folders on local directory</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h1 id=\"Memory-and-Disk-Space\"><a href=\"#Memory-and-Disk-Space\" class=\"headerlink\" title=\"Memory and Disk Space\"></a><jump id=\"memdisk\">Memory and Disk Space</jump></h1><ul>\n<li>Commonality<ul>\n<li>Place to hold data</li>\n<li>Unit: bytes, kilobytes, megabytes, etc</li>\n</ul>\n</li>\n<li>Difference<ul>\n<li>Memory is known as random access memory (RAM), which stores actively running programs on the computer. The more memory is, the more it is able to run complex programs and more programs at the same time.</li>\n<li>Disk space is a spindle of magnetic discs to store files you download, install or save.</li>\n</ul>\n</li>\n<li>Command<ul>\n<li>mem: <code>free -g</code> (g:GB,m:MB,k:KB)</li>\n<li>disk space: <code>df -h</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Python-Scripts\"><a href=\"#Python-Scripts\" class=\"headerlink\" title=\"Python Scripts\"></a><jump id=\"pyscripts\">Python Scripts</jump></h1><ul>\n<li>Its a good choice to store useful python scripts in users home directory, whose quotas are set to 10 GB with a limit of 5,000 files. </li>\n<li>Python scripts starting with <code>#!/usr/bin/env python</code>, can be executed by <code>directory/pyfile ...</code> besides <code>python pyfile ...</code>. </li>\n<li>Use <code>chmod u+x pyfile</code> if it isnt executable</li>\n<li><p>Batch operation of python scripts by bash command <code>for ...; do ...; done</code></p>\n<ul>\n<li><p>example: </p>\n<p> If <em>xyz2gjf$.$py</em> (usage: <code>python xyz2gjf.py xyz-file</code> )is in a subdirecotry <em>myscripts</em> of home directory, run <code>chmod u+x ~/myscripts/xyz2gjf.py</code> first if it is not executable, move to a directory containing several xyz files and run <code>for i in *xyz; do ~/myscripts/xyz2gjf.py $i; done</code> to convert all *xyz files to gjf format.</p>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Squeue-Format\"><a href=\"#Squeue-Format\" class=\"headerlink\" title=\"Squeue Format\"></a><jump id=\"squeue\">Squeue Format</jump></h1><p>add <code>export SQUEUE_FORMAT=&quot;the-format-you-like&quot;</code> to /.bash_profile file and then run <code>source /.bash_profile</code></p>\n<ul>\n<li><p>My own version:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export SQUEUE_FORMAT=&quot;%.7i %9P %15j %.8u %.2t %.12M %.12L %.5C %.7m  %.4D %R&quot;</span><br></pre></td></tr></table></figure>\n<p>  what is like:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> JOBID PARTITION NAME          USER ST         TIME    TIME_LEFT  CPUS MIN_MEM  NODE NODELIST(REASON)</span><br><span class=\"line\">547841 chem      gN1_ccsd  yueliu96  R   1-23:14:00  10-12:46:00    28    245G     1 n2079</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Note:</p>\n<ul>\n<li><code>%.</code>: align rigt</li>\n<li><code>%</code> withou dot: aligh left</li>\n<li>integer: length of occupied space</li>\n<li>different letters correspond to diffrent items, see <a href=\"https://slurm.schedmd.com/squeue.html\" target=\"_blank\" rel=\"noopener\">link</a> for details</li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Tips on: <a href=\"#scp\">file transfer</a> | <a href=\"#memdisk\">memory &amp; disk space</a> | <a href=\"#pyscripts\">python scripts</a> | <a href=\"#squeue\">squeue format</a> | to be continue</p>\n<p>Hyak Mox Overview website: <a href=\"https://wiki.cac.washington.edu/display/hyakusers/Hyak+mox+Overview\" target=\"_blank\" rel=\"noopener\">click me</a></p>\n<h1 id=\"File-Transfer\"><a href=\"#File-Transfer\" class=\"headerlink\" title=\"File Transfer\"></a><jump id=\"scp\">File Transfer</jump></h1><ul>\n<li><p>from ikt to mox</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hyakbbcp myfile mox1.hyak.uw.edu:mydirectory</span><br><span class=\"line\">hyakbbcp -r myfolder mox1.hyak.uw.edu:mydirectory</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>from mox to ikt</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hyakbbcp myfile ikt1.hyak.uw.edu:mydirectory</span><br><span class=\"line\">hyakbbcp -r myfolder ikt1.hyak.uw.edu:mydirectory</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>into hyak</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp myfile user@mox.hyak.uw.edu:path/of/destination</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>out of hyak</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp user@ikt.hyak.uw.edu:path/of/your/file .</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>into or out of hyak by sftp</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sftp user@mox.hyak.uw.edu</span><br><span class=\"line\">get myfile   #move myfile from hyak to local direcotry</span><br><span class=\"line\">get -r myfolder </span><br><span class=\"line\">put myfile   #move myfile from local directory to hyak</span><br><span class=\"line\">put -r myfolder</span><br><span class=\"line\">ls           #list files and folders on hyak directory</span><br><span class=\"line\">lls          #list files and folders on local directory</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h1 id=\"Memory-and-Disk-Space\"><a href=\"#Memory-and-Disk-Space\" class=\"headerlink\" title=\"Memory and Disk Space\"></a><jump id=\"memdisk\">Memory and Disk Space</jump></h1><ul>\n<li>Commonality<ul>\n<li>Place to hold data</li>\n<li>Unit: bytes, kilobytes, megabytes, etc</li>\n</ul>\n</li>\n<li>Difference<ul>\n<li>Memory is known as random access memory (RAM), which stores actively running programs on the computer. The more memory is, the more it is able to run complex programs and more programs at the same time.</li>\n<li>Disk space is a spindle of magnetic discs to store files you download, install or save.</li>\n</ul>\n</li>\n<li>Command<ul>\n<li>mem: <code>free -g</code> (g:GB,m:MB,k:KB)</li>\n<li>disk space: <code>df -h</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Python-Scripts\"><a href=\"#Python-Scripts\" class=\"headerlink\" title=\"Python Scripts\"></a><jump id=\"pyscripts\">Python Scripts</jump></h1><ul>\n<li>Its a good choice to store useful python scripts in users home directory, whose quotas are set to 10 GB with a limit of 5,000 files. </li>\n<li>Python scripts starting with <code>#!/usr/bin/env python</code>, can be executed by <code>directory/pyfile ...</code> besides <code>python pyfile ...</code>. </li>\n<li>Use <code>chmod u+x pyfile</code> if it isnt executable</li>\n<li><p>Batch operation of python scripts by bash command <code>for ...; do ...; done</code></p>\n<ul>\n<li><p>example: </p>\n<p> If <em>xyz2gjf$.$py</em> (usage: <code>python xyz2gjf.py xyz-file</code> )is in a subdirecotry <em>myscripts</em> of home directory, run <code>chmod u+x ~/myscripts/xyz2gjf.py</code> first if it is not executable, move to a directory containing several xyz files and run <code>for i in *xyz; do ~/myscripts/xyz2gjf.py $i; done</code> to convert all *xyz files to gjf format.</p>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Squeue-Format\"><a href=\"#Squeue-Format\" class=\"headerlink\" title=\"Squeue Format\"></a><jump id=\"squeue\">Squeue Format</jump></h1><p>add <code>export SQUEUE_FORMAT=&quot;the-format-you-like&quot;</code> to /.bash_profile file and then run <code>source /.bash_profile</code></p>\n<ul>\n<li><p>My own version:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export SQUEUE_FORMAT=&quot;%.7i %9P %15j %.8u %.2t %.12M %.12L %.5C %.7m  %.4D %R&quot;</span><br></pre></td></tr></table></figure>\n<p>  what is like:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> JOBID PARTITION NAME          USER ST         TIME    TIME_LEFT  CPUS MIN_MEM  NODE NODELIST(REASON)</span><br><span class=\"line\">547841 chem      gN1_ccsd  yueliu96  R   1-23:14:00  10-12:46:00    28    245G     1 n2079</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Note:</p>\n<ul>\n<li><code>%.</code>: align rigt</li>\n<li><code>%</code> withou dot: aligh left</li>\n<li>integer: length of occupied space</li>\n<li>different letters correspond to diffrent items, see <a href=\"https://slurm.schedmd.com/squeue.html\" target=\"_blank\" rel=\"noopener\">link</a> for details</li>\n</ul>\n</li>\n</ul>\n"},{"title":"Newton-X on Hyak","date":"2018-12-31T04:30:09.000Z","_content":"\n*[Newton-X](http://www.newtonx.org) is a general-purpose program package for excited-state molecular dynamics, which is used to simulate absorption spectrum with GAUSSIAN09 in our group.*\n\n*Input-file setup and output analysis are introduced here or could be found on its website. A fast setup could be achieved by my python script. Scripts attached here can run both in python2 and in python3.*\n\n# Newton-X Setup\n\n## Procedures\n\n### 1. geometry and normal mode input\n\nIn the working directory prepare two files: one is the optimized geometry in gaussian input format and the other is the normal mode calculation output file (gaussian frequency log file, usually calcuated with b3lyp method):\n\n`opt.gjf  freq.log`\n\n### 2. load newton-x environment\n\nTo work in the newton-x environment on Hyak, run `module load contrib/newtonX` or `module load contrib/newton-x`. Their difference is that newton-x contains other package like gaussin09. \n\nWe can check if we load successfully by command `$NX`, which should produce an info `-bash: /sw/contrib/newtonX/NX-2-B17/bin: Is a directory`. Or run `module list` to see all packages availabe to use.\n\n### 3. convert optimized geometry into newton-x format\n\nConvert optimized geometry (opt.gjf) into xyz format first, could be achieved by script [gjfcom2xyz.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py): `python gjfcom2xyz.py opt.gjf`. opt.xyz could be produced.\n\n`$NX/xyz2nx < opt.xyz` generates newton-x geometry file named *geom*, whose second column is the atomic number, the following three columns are x, y and z coordinates in atomic units (*Bohr*) and the last one contains the atomic masses.\n\n### 4. newton-x working directory\n\nCreat a new directory *TDDFT_SPEC* in the working directory, copy/move *geom* to it, copy/move *freq.log* to it with a new name *freq.out*: \n\n```\nmkdir TDDFT_SPEC\nmv geom TDDFT_SPEC\ncp freq.log TDDFT_SPEC/freq.out\n```\n\n### 5. energy and transition moment input\n\nMove to the directory *TDDFT_SPEC* and create a new subdirectory called *JOB_AD*. Move into *JOB_AD* and prepare two files named, *basis* and *gaussian$.$com*. \n*basis* contains the basis set information, like `6-31+g(d,p)`. *gaussian$.$com* is same with the very first optimized geometry file *opt.gjf* but with different link command lines and route card, like (%rwf and %nosave could be deleted):\n\n```\n%mem=100gb\n%nprocshared=28\n%rwf=gaussian\n%nosave\n%chk=gaussian\n# TD(NStates=10) m062xd/6-31+g(d,p)  pop=none scf=(xqc,tight) Symmetry=None\n```\n\nNote that the subdirectory must be named with *JOB_AD* and the name of these two files must be *basis* and *gaussian$.$com* since Newton-X will search for them.\n\n### 6. newton-x input\n\nBack to the directory *TDDFT_SPEC*, use command `$NX/nxinp` and answer several quesitons by instructions to genetrate the newton-x input file *initqp_input*. Answers to the questions are `1; 2; numer of atoms; 300 (number of initial conditions); geom; 4; freq.out; 1; 310 (temperature); n; 1; 1 (ground state); number of states; 1; 100; 6.5; 0; 1; 7 (exit)`, respectively.\n\n### 7. splitting jobs\n\nThis step is to split the job among several computers (nodes), could be skipped and go directly to run the newton-x by `$NX/initcond.pl > initcond.log`.\n\n To split the job, run `NX/split_initcond.pl` in the directory *TDDFT_SPEC*. Two questions will be asked, the first one is the number of directories to split the job and the second one is if the job run in a batch system. This program produces one file named *split_initcond.log* and a directory called *INITIAL_CONDITIONS*. If the answer to the first quesiton is 10, 10 subdirectories called *I1,I2,...,I10* are inside *INITIAL_CONDITIONS*, each one containing a complete set of input files but with 30 (300 $\\div$ 10) initial conditions and iseed=-1 not 0.\n\n ### 8. submit newton-x job\n\nIn every directory containing a complete set of input files  (geom, freq.out, initqp_input and JOB_AD), create a sbatch file to submit the job to Hyak node.\n\n```\n#!/bin/bash\n#SBATCH --job-name=???\n#SBATCH --nodes=1\n#SBATCH --ntasks-per-node=28\n#SBATCH --time=??:00:00\n#SBATCH --mem=???G\n#SABTCH --workdir=???????\n#SBATCH --partition=???\n#SBATCH --account=???\n\necho 'This job will run on' $SLURM_JOB_NODELIST\n#set up time\nbegin=$(date +%s)\n\n#load newtonx and gauss09 environment\nmodule load contrib/newton-x\n\n$NX/initcond.pl > initcond.log\n\nend=$(date +%s)\necho 'Elapsed Time: '$(($end-$begin))'s'\n```\n\n## Scripts\n\n  python script [newtonx.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/newtonx.py) can do exactly what step 2 to step 8 do.\n\n- *Usage*\n  - `python newtonx.py geometry-gif-file freq-log`\n- *Descriptions*\n  - *TDDFT_SPEC* folder is created, which contains *geom*, *freq.log*, *initqp_input*, *split_initcond.log*, *newtonx$.$sh*, *JOB_AD*, *INITIAL_CONDITIONS*\n  - *I1 I2 ...* in *INITIAL_CONDITIONS*, each subfolder containing a complete set input -- *geom*, *freq.out*, *initqp_input* (iseed=1234,2468,...), *JOB_AD* and a sbatch file -- *nx_submit.sh*\n  - *nx_submit.sh* is the sbatch file same with what is listed in step 8, but with partition=ckpt, account=stf-ckpt.\n  - *newtonx$.$sh* contains a list of bash command like: `cd absolute-path-of-I1; sbatch -p ckpt -A stf-ckpt --time=20:00:00 nx_submit.sh`\n  - after satisfied with everything, run `bash newtonx.sh` to submit all jobs to hyak nodes; the final partition, account and time are decided by the setting in *newtonx$.$sh* even if *newtonx$.$sh* is different from *nx_submit.sh*\n- *Note*\n  - why ckpt?\n    - increasing the number of splitting jobs speeds up the task greatly\n    - [ckpt queue](https://wiki.cac.washington.edu/display/hyakusers/Mox_checkpoint) is a good choice to run short jobs that finish within 4 hours\n  - why iseed=1234,2468,...,1234*n?\n    - different iseed values guarantee no repeated jobs\n    - iseed=-1 may generate a super large number not suit for ckpt queue\n  \n# Newton-X Result\n\n## Procedures\n\n### merge splitting jobs\n\nAfter all sub-tasks finish, go to the directory *INITIAL_CONDITIONS* and run `$NX/merge_initcond.pl`. This program will ask the number of jobs to be merged and it will create a new directory called *I_merged* with merged results. All important data are in *final_optput.1.N* file, which contains transition information from state 1 to state *N*. \n\n### spectrum simulation\n\nMove to this directory and proceed with the spectrum simulation by command `$NX/nxinp`. The answers to the questions it will ask are `5 (spectra); 1 (spectra); 1 (initial state); 2-N (array of final states); F (Absorption); 0 (no restriction); -1; local; 1 (random seed); lorentz; 0.1 (delta); 310 (temperature); 1; 0.005; 3; 7 (exit)`, among which delta contronls the width of the curve.\n\nThe simulated cross section using a Lorentzian line shape with phenomenological broadening $\\delta=0.1eV$ is written to *cross-section.dat*, containing four columns of data -- DE/ev, lambda/nm, sigma/A^2 and +/-error/A^2.\n\n## Script\n\nAll the above steps can be achieved by script [nxplot.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/nxplot.py). \n\n- *Usage*\n  - `python nxplot.py`\n  -  run inside the directory *INITIAL_CONDITIONS*\n- *Descriptions*\n  - check if jobs completed\n  - merge splitting jobs\n  - spectrum simulation\n  - extract the lamda and sigma columns if lamda within 0-1200nm from *cross-section.dat* and written to *cross-section.tsv*\n  - plot *cross-section.tsv* if in python3 environment\n\n","source":"_posts/Newton-X-on-Hyak.md","raw":"---\ntitle: Newton-X on Hyak\ndate: 2018-12-30 20:30:09\ntags:\n- Hyak\n- ComputChem\n- software\ncategories:\n- Turecek Lab Tutorial\n---\n\n*[Newton-X](http://www.newtonx.org) is a general-purpose program package for excited-state molecular dynamics, which is used to simulate absorption spectrum with GAUSSIAN09 in our group.*\n\n*Input-file setup and output analysis are introduced here or could be found on its website. A fast setup could be achieved by my python script. Scripts attached here can run both in python2 and in python3.*\n\n# Newton-X Setup\n\n## Procedures\n\n### 1. geometry and normal mode input\n\nIn the working directory prepare two files: one is the optimized geometry in gaussian input format and the other is the normal mode calculation output file (gaussian frequency log file, usually calcuated with b3lyp method):\n\n`opt.gjf  freq.log`\n\n### 2. load newton-x environment\n\nTo work in the newton-x environment on Hyak, run `module load contrib/newtonX` or `module load contrib/newton-x`. Their difference is that newton-x contains other package like gaussin09. \n\nWe can check if we load successfully by command `$NX`, which should produce an info `-bash: /sw/contrib/newtonX/NX-2-B17/bin: Is a directory`. Or run `module list` to see all packages availabe to use.\n\n### 3. convert optimized geometry into newton-x format\n\nConvert optimized geometry (opt.gjf) into xyz format first, could be achieved by script [gjfcom2xyz.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py): `python gjfcom2xyz.py opt.gjf`. opt.xyz could be produced.\n\n`$NX/xyz2nx < opt.xyz` generates newton-x geometry file named *geom*, whose second column is the atomic number, the following three columns are x, y and z coordinates in atomic units (*Bohr*) and the last one contains the atomic masses.\n\n### 4. newton-x working directory\n\nCreat a new directory *TDDFT_SPEC* in the working directory, copy/move *geom* to it, copy/move *freq.log* to it with a new name *freq.out*: \n\n```\nmkdir TDDFT_SPEC\nmv geom TDDFT_SPEC\ncp freq.log TDDFT_SPEC/freq.out\n```\n\n### 5. energy and transition moment input\n\nMove to the directory *TDDFT_SPEC* and create a new subdirectory called *JOB_AD*. Move into *JOB_AD* and prepare two files named, *basis* and *gaussian$.$com*. \n*basis* contains the basis set information, like `6-31+g(d,p)`. *gaussian$.$com* is same with the very first optimized geometry file *opt.gjf* but with different link command lines and route card, like (%rwf and %nosave could be deleted):\n\n```\n%mem=100gb\n%nprocshared=28\n%rwf=gaussian\n%nosave\n%chk=gaussian\n# TD(NStates=10) m062xd/6-31+g(d,p)  pop=none scf=(xqc,tight) Symmetry=None\n```\n\nNote that the subdirectory must be named with *JOB_AD* and the name of these two files must be *basis* and *gaussian$.$com* since Newton-X will search for them.\n\n### 6. newton-x input\n\nBack to the directory *TDDFT_SPEC*, use command `$NX/nxinp` and answer several quesitons by instructions to genetrate the newton-x input file *initqp_input*. Answers to the questions are `1; 2; numer of atoms; 300 (number of initial conditions); geom; 4; freq.out; 1; 310 (temperature); n; 1; 1 (ground state); number of states; 1; 100; 6.5; 0; 1; 7 (exit)`, respectively.\n\n### 7. splitting jobs\n\nThis step is to split the job among several computers (nodes), could be skipped and go directly to run the newton-x by `$NX/initcond.pl > initcond.log`.\n\n To split the job, run `NX/split_initcond.pl` in the directory *TDDFT_SPEC*. Two questions will be asked, the first one is the number of directories to split the job and the second one is if the job run in a batch system. This program produces one file named *split_initcond.log* and a directory called *INITIAL_CONDITIONS*. If the answer to the first quesiton is 10, 10 subdirectories called *I1,I2,...,I10* are inside *INITIAL_CONDITIONS*, each one containing a complete set of input files but with 30 (300 $\\div$ 10) initial conditions and iseed=-1 not 0.\n\n ### 8. submit newton-x job\n\nIn every directory containing a complete set of input files  (geom, freq.out, initqp_input and JOB_AD), create a sbatch file to submit the job to Hyak node.\n\n```\n#!/bin/bash\n#SBATCH --job-name=???\n#SBATCH --nodes=1\n#SBATCH --ntasks-per-node=28\n#SBATCH --time=??:00:00\n#SBATCH --mem=???G\n#SABTCH --workdir=???????\n#SBATCH --partition=???\n#SBATCH --account=???\n\necho 'This job will run on' $SLURM_JOB_NODELIST\n#set up time\nbegin=$(date +%s)\n\n#load newtonx and gauss09 environment\nmodule load contrib/newton-x\n\n$NX/initcond.pl > initcond.log\n\nend=$(date +%s)\necho 'Elapsed Time: '$(($end-$begin))'s'\n```\n\n## Scripts\n\n  python script [newtonx.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/newtonx.py) can do exactly what step 2 to step 8 do.\n\n- *Usage*\n  - `python newtonx.py geometry-gif-file freq-log`\n- *Descriptions*\n  - *TDDFT_SPEC* folder is created, which contains *geom*, *freq.log*, *initqp_input*, *split_initcond.log*, *newtonx$.$sh*, *JOB_AD*, *INITIAL_CONDITIONS*\n  - *I1 I2 ...* in *INITIAL_CONDITIONS*, each subfolder containing a complete set input -- *geom*, *freq.out*, *initqp_input* (iseed=1234,2468,...), *JOB_AD* and a sbatch file -- *nx_submit.sh*\n  - *nx_submit.sh* is the sbatch file same with what is listed in step 8, but with partition=ckpt, account=stf-ckpt.\n  - *newtonx$.$sh* contains a list of bash command like: `cd absolute-path-of-I1; sbatch -p ckpt -A stf-ckpt --time=20:00:00 nx_submit.sh`\n  - after satisfied with everything, run `bash newtonx.sh` to submit all jobs to hyak nodes; the final partition, account and time are decided by the setting in *newtonx$.$sh* even if *newtonx$.$sh* is different from *nx_submit.sh*\n- *Note*\n  - why ckpt?\n    - increasing the number of splitting jobs speeds up the task greatly\n    - [ckpt queue](https://wiki.cac.washington.edu/display/hyakusers/Mox_checkpoint) is a good choice to run short jobs that finish within 4 hours\n  - why iseed=1234,2468,...,1234*n?\n    - different iseed values guarantee no repeated jobs\n    - iseed=-1 may generate a super large number not suit for ckpt queue\n  \n# Newton-X Result\n\n## Procedures\n\n### merge splitting jobs\n\nAfter all sub-tasks finish, go to the directory *INITIAL_CONDITIONS* and run `$NX/merge_initcond.pl`. This program will ask the number of jobs to be merged and it will create a new directory called *I_merged* with merged results. All important data are in *final_optput.1.N* file, which contains transition information from state 1 to state *N*. \n\n### spectrum simulation\n\nMove to this directory and proceed with the spectrum simulation by command `$NX/nxinp`. The answers to the questions it will ask are `5 (spectra); 1 (spectra); 1 (initial state); 2-N (array of final states); F (Absorption); 0 (no restriction); -1; local; 1 (random seed); lorentz; 0.1 (delta); 310 (temperature); 1; 0.005; 3; 7 (exit)`, among which delta contronls the width of the curve.\n\nThe simulated cross section using a Lorentzian line shape with phenomenological broadening $\\delta=0.1eV$ is written to *cross-section.dat*, containing four columns of data -- DE/ev, lambda/nm, sigma/A^2 and +/-error/A^2.\n\n## Script\n\nAll the above steps can be achieved by script [nxplot.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/nxplot.py). \n\n- *Usage*\n  - `python nxplot.py`\n  -  run inside the directory *INITIAL_CONDITIONS*\n- *Descriptions*\n  - check if jobs completed\n  - merge splitting jobs\n  - spectrum simulation\n  - extract the lamda and sigma columns if lamda within 0-1200nm from *cross-section.dat* and written to *cross-section.tsv*\n  - plot *cross-section.tsv* if in python3 environment\n\n","slug":"Newton-X-on-Hyak","published":1,"updated":"2019-01-04T21:40:09.310Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjqojihkw0002p45kvtn41oio","content":"<p><em><a href=\"http://www.newtonx.org\" target=\"_blank\" rel=\"noopener\">Newton-X</a> is a general-purpose program package for excited-state molecular dynamics, which is used to simulate absorption spectrum with GAUSSIAN09 in our group.</em></p>\n<p><em>Input-file setup and output analysis are introduced here or could be found on its website. A fast setup could be achieved by my python script. Scripts attached here can run both in python2 and in python3.</em></p>\n<h1 id=\"Newton-X-Setup\"><a href=\"#Newton-X-Setup\" class=\"headerlink\" title=\"Newton-X Setup\"></a>Newton-X Setup</h1><h2 id=\"Procedures\"><a href=\"#Procedures\" class=\"headerlink\" title=\"Procedures\"></a>Procedures</h2><h3 id=\"1-geometry-and-normal-mode-input\"><a href=\"#1-geometry-and-normal-mode-input\" class=\"headerlink\" title=\"1. geometry and normal mode input\"></a>1. geometry and normal mode input</h3><p>In the working directory prepare two files: one is the optimized geometry in gaussian input format and the other is the normal mode calculation output file (gaussian frequency log file, usually calcuated with b3lyp method):</p>\n<p><code>opt.gjf  freq.log</code></p>\n<h3 id=\"2-load-newton-x-environment\"><a href=\"#2-load-newton-x-environment\" class=\"headerlink\" title=\"2. load newton-x environment\"></a>2. load newton-x environment</h3><p>To work in the newton-x environment on Hyak, run <code>module load contrib/newtonX</code> or <code>module load contrib/newton-x</code>. Their difference is that newton-x contains other package like gaussin09. </p>\n<p>We can check if we load successfully by command <code>$NX</code>, which should produce an info <code>-bash: /sw/contrib/newtonX/NX-2-B17/bin: Is a directory</code>. Or run <code>module list</code> to see all packages availabe to use.</p>\n<h3 id=\"3-convert-optimized-geometry-into-newton-x-format\"><a href=\"#3-convert-optimized-geometry-into-newton-x-format\" class=\"headerlink\" title=\"3. convert optimized geometry into newton-x format\"></a>3. convert optimized geometry into newton-x format</h3><p>Convert optimized geometry (opt.gjf) into xyz format first, could be achieved by script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py\" target=\"_blank\" rel=\"noopener\">gjfcom2xyz.py</a>: <code>python gjfcom2xyz.py opt.gjf</code>. opt.xyz could be produced.</p>\n<p><code>$NX/xyz2nx &lt; opt.xyz</code> generates newton-x geometry file named <em>geom</em>, whose second column is the atomic number, the following three columns are x, y and z coordinates in atomic units (<em>Bohr</em>) and the last one contains the atomic masses.</p>\n<h3 id=\"4-newton-x-working-directory\"><a href=\"#4-newton-x-working-directory\" class=\"headerlink\" title=\"4. newton-x working directory\"></a>4. newton-x working directory</h3><p>Creat a new directory <em>TDDFT_SPEC</em> in the working directory, copy/move <em>geom</em> to it, copy/move <em>freq.log</em> to it with a new name <em>freq.out</em>: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir TDDFT_SPEC</span><br><span class=\"line\">mv geom TDDFT_SPEC</span><br><span class=\"line\">cp freq.log TDDFT_SPEC/freq.out</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-energy-and-transition-moment-input\"><a href=\"#5-energy-and-transition-moment-input\" class=\"headerlink\" title=\"5. energy and transition moment input\"></a>5. energy and transition moment input</h3><p>Move to the directory <em>TDDFT_SPEC</em> and create a new subdirectory called <em>JOB_AD</em>. Move into <em>JOB_AD</em> and prepare two files named, <em>basis</em> and <em>gaussian$.$com</em>.<br><em>basis</em> contains the basis set information, like <code>6-31+g(d,p)</code>. <em>gaussian$.$com</em> is same with the very first optimized geometry file <em>opt.gjf</em> but with different link command lines and route card, like (%rwf and %nosave could be deleted):</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%mem=100gb</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%rwf=gaussian</span><br><span class=\"line\">%nosave</span><br><span class=\"line\">%chk=gaussian</span><br><span class=\"line\"># TD(NStates=10) m062xd/6-31+g(d,p)  pop=none scf=(xqc,tight) Symmetry=None</span><br></pre></td></tr></table></figure>\n<p>Note that the subdirectory must be named with <em>JOB_AD</em> and the name of these two files must be <em>basis</em> and <em>gaussian$.$com</em> since Newton-X will search for them.</p>\n<h3 id=\"6-newton-x-input\"><a href=\"#6-newton-x-input\" class=\"headerlink\" title=\"6. newton-x input\"></a>6. newton-x input</h3><p>Back to the directory <em>TDDFT_SPEC</em>, use command <code>$NX/nxinp</code> and answer several quesitons by instructions to genetrate the newton-x input file <em>initqp_input</em>. Answers to the questions are <code>1; 2; numer of atoms; 300 (number of initial conditions); geom; 4; freq.out; 1; 310 (temperature); n; 1; 1 (ground state); number of states; 1; 100; 6.5; 0; 1; 7 (exit)</code>, respectively.</p>\n<h3 id=\"7-splitting-jobs\"><a href=\"#7-splitting-jobs\" class=\"headerlink\" title=\"7. splitting jobs\"></a>7. splitting jobs</h3><p>This step is to split the job among several computers (nodes), could be skipped and go directly to run the newton-x by <code>$NX/initcond.pl &gt; initcond.log</code>.</p>\n<p> To split the job, run <code>NX/split_initcond.pl</code> in the directory <em>TDDFT_SPEC</em>. Two questions will be asked, the first one is the number of directories to split the job and the second one is if the job run in a batch system. This program produces one file named <em>split_initcond.log</em> and a directory called <em>INITIAL_CONDITIONS</em>. If the answer to the first quesiton is 10, 10 subdirectories called <em>I1,I2,,I10</em> are inside <em>INITIAL_CONDITIONS</em>, each one containing a complete set of input files but with 30 (300 $\\div$ 10) initial conditions and iseed=-1 not 0.</p>\n<h3 id=\"8-submit-newton-x-job\"><a href=\"#8-submit-newton-x-job\" class=\"headerlink\" title=\"8. submit newton-x job\"></a>8. submit newton-x job</h3><p>In every directory containing a complete set of input files  (geom, freq.out, initqp_input and JOB_AD), create a sbatch file to submit the job to Hyak node.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=???</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --ntasks-per-node=28</span><br><span class=\"line\">#SBATCH --time=??:00:00</span><br><span class=\"line\">#SBATCH --mem=???G</span><br><span class=\"line\">#SABTCH --workdir=???????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">echo &apos;This job will run on&apos; $SLURM_JOB_NODELIST</span><br><span class=\"line\">#set up time</span><br><span class=\"line\">begin=$(date +%s)</span><br><span class=\"line\"></span><br><span class=\"line\">#load newtonx and gauss09 environment</span><br><span class=\"line\">module load contrib/newton-x</span><br><span class=\"line\"></span><br><span class=\"line\">$NX/initcond.pl &gt; initcond.log</span><br><span class=\"line\"></span><br><span class=\"line\">end=$(date +%s)</span><br><span class=\"line\">echo &apos;Elapsed Time: &apos;$(($end-$begin))&apos;s&apos;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Scripts\"><a href=\"#Scripts\" class=\"headerlink\" title=\"Scripts\"></a>Scripts</h2><p>  python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/newtonx.py\" target=\"_blank\" rel=\"noopener\">newtonx.py</a> can do exactly what step 2 to step 8 do.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python newtonx.py geometry-gif-file freq-log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li><em>TDDFT_SPEC</em> folder is created, which contains <em>geom</em>, <em>freq.log</em>, <em>initqp_input</em>, <em>split_initcond.log</em>, <em>newtonx$.$sh</em>, <em>JOB_AD</em>, <em>INITIAL_CONDITIONS</em></li>\n<li><em>I1 I2 </em> in <em>INITIAL_CONDITIONS</em>, each subfolder containing a complete set input  <em>geom</em>, <em>freq.out</em>, <em>initqp_input</em> (iseed=1234,2468,), <em>JOB_AD</em> and a sbatch file  <em>nx_submit.sh</em></li>\n<li><em>nx_submit.sh</em> is the sbatch file same with what is listed in step 8, but with partition=ckpt, account=stf-ckpt.</li>\n<li><em>newtonx$.$sh</em> contains a list of bash command like: <code>cd absolute-path-of-I1; sbatch -p ckpt -A stf-ckpt --time=20:00:00 nx_submit.sh</code></li>\n<li>after satisfied with everything, run <code>bash newtonx.sh</code> to submit all jobs to hyak nodes; the final partition, account and time are decided by the setting in <em>newtonx$.$sh</em> even if <em>newtonx$.$sh</em> is different from <em>nx_submit.sh</em></li>\n</ul>\n</li>\n<li><em>Note</em><ul>\n<li>why ckpt?<ul>\n<li>increasing the number of splitting jobs speeds up the task greatly</li>\n<li><a href=\"https://wiki.cac.washington.edu/display/hyakusers/Mox_checkpoint\" target=\"_blank\" rel=\"noopener\">ckpt queue</a> is a good choice to run short jobs that finish within 4 hours</li>\n</ul>\n</li>\n<li>why iseed=1234,2468,,1234*n?<ul>\n<li>different iseed values guarantee no repeated jobs</li>\n<li>iseed=-1 may generate a super large number not suit for ckpt queue</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Newton-X-Result\"><a href=\"#Newton-X-Result\" class=\"headerlink\" title=\"Newton-X Result\"></a>Newton-X Result</h1><h2 id=\"Procedures-1\"><a href=\"#Procedures-1\" class=\"headerlink\" title=\"Procedures\"></a>Procedures</h2><h3 id=\"merge-splitting-jobs\"><a href=\"#merge-splitting-jobs\" class=\"headerlink\" title=\"merge splitting jobs\"></a>merge splitting jobs</h3><p>After all sub-tasks finish, go to the directory <em>INITIAL_CONDITIONS</em> and run <code>$NX/merge_initcond.pl</code>. This program will ask the number of jobs to be merged and it will create a new directory called <em>I_merged</em> with merged results. All important data are in <em>final_optput.1.N</em> file, which contains transition information from state 1 to state <em>N</em>. </p>\n<h3 id=\"spectrum-simulation\"><a href=\"#spectrum-simulation\" class=\"headerlink\" title=\"spectrum simulation\"></a>spectrum simulation</h3><p>Move to this directory and proceed with the spectrum simulation by command <code>$NX/nxinp</code>. The answers to the questions it will ask are <code>5 (spectra); 1 (spectra); 1 (initial state); 2-N (array of final states); F (Absorption); 0 (no restriction); -1; local; 1 (random seed); lorentz; 0.1 (delta); 310 (temperature); 1; 0.005; 3; 7 (exit)</code>, among which delta contronls the width of the curve.</p>\n<p>The simulated cross section using a Lorentzian line shape with phenomenological broadening $\\delta=0.1eV$ is written to <em>cross-section.dat</em>, containing four columns of data  DE/ev, lambda/nm, sigma/A^2 and +/-error/A^2.</p>\n<h2 id=\"Script\"><a href=\"#Script\" class=\"headerlink\" title=\"Script\"></a>Script</h2><p>All the above steps can be achieved by script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/nxplot.py\" target=\"_blank\" rel=\"noopener\">nxplot.py</a>. </p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python nxplot.py</code></li>\n<li>run inside the directory <em>INITIAL_CONDITIONS</em></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>check if jobs completed</li>\n<li>merge splitting jobs</li>\n<li>spectrum simulation</li>\n<li>extract the lamda and sigma columns if lamda within 0-1200nm from <em>cross-section.dat</em> and written to <em>cross-section.tsv</em></li>\n<li>plot <em>cross-section.tsv</em> if in python3 environment</li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><em><a href=\"http://www.newtonx.org\" target=\"_blank\" rel=\"noopener\">Newton-X</a> is a general-purpose program package for excited-state molecular dynamics, which is used to simulate absorption spectrum with GAUSSIAN09 in our group.</em></p>\n<p><em>Input-file setup and output analysis are introduced here or could be found on its website. A fast setup could be achieved by my python script. Scripts attached here can run both in python2 and in python3.</em></p>\n<h1 id=\"Newton-X-Setup\"><a href=\"#Newton-X-Setup\" class=\"headerlink\" title=\"Newton-X Setup\"></a>Newton-X Setup</h1><h2 id=\"Procedures\"><a href=\"#Procedures\" class=\"headerlink\" title=\"Procedures\"></a>Procedures</h2><h3 id=\"1-geometry-and-normal-mode-input\"><a href=\"#1-geometry-and-normal-mode-input\" class=\"headerlink\" title=\"1. geometry and normal mode input\"></a>1. geometry and normal mode input</h3><p>In the working directory prepare two files: one is the optimized geometry in gaussian input format and the other is the normal mode calculation output file (gaussian frequency log file, usually calcuated with b3lyp method):</p>\n<p><code>opt.gjf  freq.log</code></p>\n<h3 id=\"2-load-newton-x-environment\"><a href=\"#2-load-newton-x-environment\" class=\"headerlink\" title=\"2. load newton-x environment\"></a>2. load newton-x environment</h3><p>To work in the newton-x environment on Hyak, run <code>module load contrib/newtonX</code> or <code>module load contrib/newton-x</code>. Their difference is that newton-x contains other package like gaussin09. </p>\n<p>We can check if we load successfully by command <code>$NX</code>, which should produce an info <code>-bash: /sw/contrib/newtonX/NX-2-B17/bin: Is a directory</code>. Or run <code>module list</code> to see all packages availabe to use.</p>\n<h3 id=\"3-convert-optimized-geometry-into-newton-x-format\"><a href=\"#3-convert-optimized-geometry-into-newton-x-format\" class=\"headerlink\" title=\"3. convert optimized geometry into newton-x format\"></a>3. convert optimized geometry into newton-x format</h3><p>Convert optimized geometry (opt.gjf) into xyz format first, could be achieved by script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py\" target=\"_blank\" rel=\"noopener\">gjfcom2xyz.py</a>: <code>python gjfcom2xyz.py opt.gjf</code>. opt.xyz could be produced.</p>\n<p><code>$NX/xyz2nx &lt; opt.xyz</code> generates newton-x geometry file named <em>geom</em>, whose second column is the atomic number, the following three columns are x, y and z coordinates in atomic units (<em>Bohr</em>) and the last one contains the atomic masses.</p>\n<h3 id=\"4-newton-x-working-directory\"><a href=\"#4-newton-x-working-directory\" class=\"headerlink\" title=\"4. newton-x working directory\"></a>4. newton-x working directory</h3><p>Creat a new directory <em>TDDFT_SPEC</em> in the working directory, copy/move <em>geom</em> to it, copy/move <em>freq.log</em> to it with a new name <em>freq.out</em>: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir TDDFT_SPEC</span><br><span class=\"line\">mv geom TDDFT_SPEC</span><br><span class=\"line\">cp freq.log TDDFT_SPEC/freq.out</span><br></pre></td></tr></table></figure>\n<h3 id=\"5-energy-and-transition-moment-input\"><a href=\"#5-energy-and-transition-moment-input\" class=\"headerlink\" title=\"5. energy and transition moment input\"></a>5. energy and transition moment input</h3><p>Move to the directory <em>TDDFT_SPEC</em> and create a new subdirectory called <em>JOB_AD</em>. Move into <em>JOB_AD</em> and prepare two files named, <em>basis</em> and <em>gaussian$.$com</em>.<br><em>basis</em> contains the basis set information, like <code>6-31+g(d,p)</code>. <em>gaussian$.$com</em> is same with the very first optimized geometry file <em>opt.gjf</em> but with different link command lines and route card, like (%rwf and %nosave could be deleted):</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%mem=100gb</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%rwf=gaussian</span><br><span class=\"line\">%nosave</span><br><span class=\"line\">%chk=gaussian</span><br><span class=\"line\"># TD(NStates=10) m062xd/6-31+g(d,p)  pop=none scf=(xqc,tight) Symmetry=None</span><br></pre></td></tr></table></figure>\n<p>Note that the subdirectory must be named with <em>JOB_AD</em> and the name of these two files must be <em>basis</em> and <em>gaussian$.$com</em> since Newton-X will search for them.</p>\n<h3 id=\"6-newton-x-input\"><a href=\"#6-newton-x-input\" class=\"headerlink\" title=\"6. newton-x input\"></a>6. newton-x input</h3><p>Back to the directory <em>TDDFT_SPEC</em>, use command <code>$NX/nxinp</code> and answer several quesitons by instructions to genetrate the newton-x input file <em>initqp_input</em>. Answers to the questions are <code>1; 2; numer of atoms; 300 (number of initial conditions); geom; 4; freq.out; 1; 310 (temperature); n; 1; 1 (ground state); number of states; 1; 100; 6.5; 0; 1; 7 (exit)</code>, respectively.</p>\n<h3 id=\"7-splitting-jobs\"><a href=\"#7-splitting-jobs\" class=\"headerlink\" title=\"7. splitting jobs\"></a>7. splitting jobs</h3><p>This step is to split the job among several computers (nodes), could be skipped and go directly to run the newton-x by <code>$NX/initcond.pl &gt; initcond.log</code>.</p>\n<p> To split the job, run <code>NX/split_initcond.pl</code> in the directory <em>TDDFT_SPEC</em>. Two questions will be asked, the first one is the number of directories to split the job and the second one is if the job run in a batch system. This program produces one file named <em>split_initcond.log</em> and a directory called <em>INITIAL_CONDITIONS</em>. If the answer to the first quesiton is 10, 10 subdirectories called <em>I1,I2,,I10</em> are inside <em>INITIAL_CONDITIONS</em>, each one containing a complete set of input files but with 30 (300 $\\div$ 10) initial conditions and iseed=-1 not 0.</p>\n<h3 id=\"8-submit-newton-x-job\"><a href=\"#8-submit-newton-x-job\" class=\"headerlink\" title=\"8. submit newton-x job\"></a>8. submit newton-x job</h3><p>In every directory containing a complete set of input files  (geom, freq.out, initqp_input and JOB_AD), create a sbatch file to submit the job to Hyak node.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=???</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --ntasks-per-node=28</span><br><span class=\"line\">#SBATCH --time=??:00:00</span><br><span class=\"line\">#SBATCH --mem=???G</span><br><span class=\"line\">#SABTCH --workdir=???????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">echo &apos;This job will run on&apos; $SLURM_JOB_NODELIST</span><br><span class=\"line\">#set up time</span><br><span class=\"line\">begin=$(date +%s)</span><br><span class=\"line\"></span><br><span class=\"line\">#load newtonx and gauss09 environment</span><br><span class=\"line\">module load contrib/newton-x</span><br><span class=\"line\"></span><br><span class=\"line\">$NX/initcond.pl &gt; initcond.log</span><br><span class=\"line\"></span><br><span class=\"line\">end=$(date +%s)</span><br><span class=\"line\">echo &apos;Elapsed Time: &apos;$(($end-$begin))&apos;s&apos;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Scripts\"><a href=\"#Scripts\" class=\"headerlink\" title=\"Scripts\"></a>Scripts</h2><p>  python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/newtonx.py\" target=\"_blank\" rel=\"noopener\">newtonx.py</a> can do exactly what step 2 to step 8 do.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python newtonx.py geometry-gif-file freq-log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li><em>TDDFT_SPEC</em> folder is created, which contains <em>geom</em>, <em>freq.log</em>, <em>initqp_input</em>, <em>split_initcond.log</em>, <em>newtonx$.$sh</em>, <em>JOB_AD</em>, <em>INITIAL_CONDITIONS</em></li>\n<li><em>I1 I2 </em> in <em>INITIAL_CONDITIONS</em>, each subfolder containing a complete set input  <em>geom</em>, <em>freq.out</em>, <em>initqp_input</em> (iseed=1234,2468,), <em>JOB_AD</em> and a sbatch file  <em>nx_submit.sh</em></li>\n<li><em>nx_submit.sh</em> is the sbatch file same with what is listed in step 8, but with partition=ckpt, account=stf-ckpt.</li>\n<li><em>newtonx$.$sh</em> contains a list of bash command like: <code>cd absolute-path-of-I1; sbatch -p ckpt -A stf-ckpt --time=20:00:00 nx_submit.sh</code></li>\n<li>after satisfied with everything, run <code>bash newtonx.sh</code> to submit all jobs to hyak nodes; the final partition, account and time are decided by the setting in <em>newtonx$.$sh</em> even if <em>newtonx$.$sh</em> is different from <em>nx_submit.sh</em></li>\n</ul>\n</li>\n<li><em>Note</em><ul>\n<li>why ckpt?<ul>\n<li>increasing the number of splitting jobs speeds up the task greatly</li>\n<li><a href=\"https://wiki.cac.washington.edu/display/hyakusers/Mox_checkpoint\" target=\"_blank\" rel=\"noopener\">ckpt queue</a> is a good choice to run short jobs that finish within 4 hours</li>\n</ul>\n</li>\n<li>why iseed=1234,2468,,1234*n?<ul>\n<li>different iseed values guarantee no repeated jobs</li>\n<li>iseed=-1 may generate a super large number not suit for ckpt queue</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Newton-X-Result\"><a href=\"#Newton-X-Result\" class=\"headerlink\" title=\"Newton-X Result\"></a>Newton-X Result</h1><h2 id=\"Procedures-1\"><a href=\"#Procedures-1\" class=\"headerlink\" title=\"Procedures\"></a>Procedures</h2><h3 id=\"merge-splitting-jobs\"><a href=\"#merge-splitting-jobs\" class=\"headerlink\" title=\"merge splitting jobs\"></a>merge splitting jobs</h3><p>After all sub-tasks finish, go to the directory <em>INITIAL_CONDITIONS</em> and run <code>$NX/merge_initcond.pl</code>. This program will ask the number of jobs to be merged and it will create a new directory called <em>I_merged</em> with merged results. All important data are in <em>final_optput.1.N</em> file, which contains transition information from state 1 to state <em>N</em>. </p>\n<h3 id=\"spectrum-simulation\"><a href=\"#spectrum-simulation\" class=\"headerlink\" title=\"spectrum simulation\"></a>spectrum simulation</h3><p>Move to this directory and proceed with the spectrum simulation by command <code>$NX/nxinp</code>. The answers to the questions it will ask are <code>5 (spectra); 1 (spectra); 1 (initial state); 2-N (array of final states); F (Absorption); 0 (no restriction); -1; local; 1 (random seed); lorentz; 0.1 (delta); 310 (temperature); 1; 0.005; 3; 7 (exit)</code>, among which delta contronls the width of the curve.</p>\n<p>The simulated cross section using a Lorentzian line shape with phenomenological broadening $\\delta=0.1eV$ is written to <em>cross-section.dat</em>, containing four columns of data  DE/ev, lambda/nm, sigma/A^2 and +/-error/A^2.</p>\n<h2 id=\"Script\"><a href=\"#Script\" class=\"headerlink\" title=\"Script\"></a>Script</h2><p>All the above steps can be achieved by script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/nxplot.py\" target=\"_blank\" rel=\"noopener\">nxplot.py</a>. </p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python nxplot.py</code></li>\n<li>run inside the directory <em>INITIAL_CONDITIONS</em></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>check if jobs completed</li>\n<li>merge splitting jobs</li>\n<li>spectrum simulation</li>\n<li>extract the lamda and sigma columns if lamda within 0-1200nm from <em>cross-section.dat</em> and written to <em>cross-section.tsv</em></li>\n<li>plot <em>cross-section.tsv</em> if in python3 environment</li>\n</ul>\n</li>\n</ul>\n"},{"title":"Mopac with Cuby4","date":"2018-12-29T06:03:11.000Z","_content":"\n*Two types of jobs, optimization and dynamics with pm6 method, are introduced here. Linked python scripts should be useful to setup input and analyze result, which can run both in python2 and in python3.*\n\n*[Mopac](http://openmopac.net/Manual/index.html) is a general-purpose semiempirical molecular orbital package for the study of solid state and molecular structures and reactions. Several semiempirical methods are used to calculate electronic part, among which we usually choose PM6 method to run geometry optimization and molecular dynamics. Just like other computational software packages, Mopac works in 3 steps: create a data file which describes molecular system and specifies job types; command Mopac to carry out the calcualtion with that data-file (on Hyak node); extract the desired result from the output-file.*\n\n# Input Setup\n\n[Cuby](http://cuby4.molecular.cz) provides an unified access to various computational methods available in different software packages, including gaussian, mopac, turbomole, etc. It is a computational chemistry framework written in ruby, which does very little for itself, but calls external softwares to do the calculations and works with their results. To work with cuby, two input files are needed: xyz file and yaml file. \n\n## xyz-file\n\nxyz file contains the geometry of the molecule system -- the first line is the number of atoms, the second line is the comment line (could be blank) and the remaining lines are atoms Cartesian coordinates. Take $H_2O$ as an example:\n\n  ```\n  3\n\n  O                 -0.54954964    0.83729475    0.01780404\n  H                 -0.87000423    1.74223058    0.01780404\n  H                  0.41045036    0.83729475    0.01780404\n  ```\n\n Common input files we use are gaussian input files. The script, [gjfcom2xyz.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py) can convert the input file from gaussian input format to xyz format. \n\n- *Usage*\n  - `python gjfcom2xyz.py input-file`\n- *Descriptions*\n  - use charge and multiplicity (chg&mp) as a key to locate the start of coordinates\n  - every lines containing 4 elements after chg&mp is considered as coordinate line.\n\npython script [xyz2gjf.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/xyz2gjf.py) can convert xyz format back to gaussian input format.\n\n- *Usage*\n  - `python xyz2gjf.py xyz-file`\n- *Descriptions*\n  - every line after the second line contains 4 elements and the last three elements are float is considered as coordinate line\n  - route card, charge and multiplicity are defined by default, could be changed later or modified in the scripts.\n\n## yaml-file\n\nyaml file is a list of keywords, which is the bridge to connect cuby with computational softwares.\n\n### optimize-yaml\n\n*Example--inp.yaml*:\n\n```\njob: optimize\ngeometry: test.xyz\ncharge: 2\nmultiplicity: 1\ninterface: mopac\nmethod: pm6\nspin_restricted: auto_uhf\nmaxcycles: 2000\nprint: timing\nmopac_precise: yes\nmopac_peptide_bond_fix: yes\nmodifiers: dispersion3, h_bonds4\nmodifier_h_bonds:\n  h_bonds4_scale_charged: no\n  h_bonds4_extra_scaling: {}\n```\n\n*Explanations*:\n- job: optimize\n  - simple geometry optimization of molecule specified in test.xyz file\n  - the calculation produces these additional files:\n    - optimized.xyz - the optimized geometry\n    - history_inp.xyz - record of all the steps\n- spin_restricted: auto_uhf\n  - uhf for any open-shell systems, rhf is used for closed shells\n- maxcycles: 2000\n  - maximum number of cycles of optimization or molecular dynamics\n- print: timing\n  - print time spent in the program\n- [mopac_precise](http://openmopac.net/manual/precise.html): yes\n  - use tight thresholds, needed for accurate gradient\n- [mopac_peptide_bond_fix](http://openmopac.net/manual/mmok.html): yes\n  - controls the corerction for peptide bond torsion\n- modifiers\n  - a list of interfaces applied as a modifiers to this calculations.\n\n### dynamics-yaml\n\n*Example--anneal.yaml*:\n\n```\njob: dynamics\ngeometry: test.xyz\ncharge: 2\nmultiplicity: 1\nspin_restricted: auto_uhf\ninterface: mopac\nmethod: pm6\nmopac_precise: yes\nmopac_peptide_bond_fix: yes\nmodifiers: dispersion3, h_bonds4\nmodifier_h_bonds:\n  h_bonds4_scale_charged: no\n  h_bonds4_extra_scaling: {}\nmaxcycles: 20000\ntimestep: 0.001\ninit_temp: 310\ntemperature: 310\nthermostat: berendsen\nthermostat_tc: 0.05\n```\n\n*Explanations*:\n- job: dynamics\n  - molecular dynamics simulation of molecule specified in test.xyz file\n  - the calculation produces these additional files:\n    - last.xyz - the last geometry\n    - trajectory_test.xyz - record of all the cycles (20000 here)\n    - LOG - standard output and error information for every cycle\n- maxcycles: 20000\n  - 20 ps of MD simulation (the default step is 1 fs)\n- init_temp: 310\n  - temperature (K) used to generate initial random velocities\n- temperature: 310\n  - temperature (K) to be maintained by the thermostat\n- thermostat: berendsen\n  - selection of thermostat algorithm\n- thermostat_tc: 0.05\n  - Thermostat time constant (ps) setting strength of the coupling to the thermostat. The exact mening of the value is different in different algorithms.\n\n*Note*:\n- add `scf_cycles: 1000` for open-shell system to define the maximum number of SCF iterations\n\n### Other Keywords\n- `job_cleanup: yes | no`\n  - delete directories with external calculations when job finishes successfuly, default is yes\n- `mopac_keywords: \"\"`\n  - extra keywords (in the MOPAC format) added into the input\n- `scf_convergence: 7`\n  - change SCF convergence threshold (energy): set to $10^{-7}$ a.u.\n- click [here](http://cuby4.molecular.cz/keywords.html) to see more\n\n# Submit to Hyak\n\nBesides xyz and yaml (test.yaml) files, sbatch file (test.sh) also needed:\n\n```\n#!/bin/bash\n#SBATCH --job-name=???\n#SBATCH --nodes=1\n#SBATCH --time=??:00:00\n#SBATCH --mem=???GB\n#SBATCH --workdir=????????????\n#SBATCH --partition=???\n#SBATCH --account=???\n\nmodule load contrib/mopac16\nsource /usr/lusers/yueliu96/.rvm/scripts/rvm\nldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so > ldd.log\ncuby4 test.yaml &>LOG    \n## results and error information will be written to file LOG\n## cuby4 test.yaml: same information will be written to slurm file\n```\nrun `sbatch test.sh` to submit it.\n\n## Parallel-Run\n\nMost nodes on hyak.mox have 28 processors, however, the code in MOPAC only allows a single processor to be used for a single calculation. If several calculations to be run, each calculation could be started on a different processor in one node.\n\n```\n#!/bin/bash\n#SBATCH --job-name=??????\n#SBATCH --nodes=1\n#SBATCH --time=??:00:00\n#SBATCH --mem=???G\n#SBATCH --workdir=??????\n#SBATCH --partition=???\n#SBATCH --account=???\n\nmodule load parallel-20170722\nmodule load contrib/mopac16\nsource /usr/lusers/yueliu96/.rvm/scripts/rvm\nldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so > ldd.log\ncat tasklists.sh | parallel -j 28\n```\nwhere, tasklists$.$sh is :\n\n```\ncd absolute-directory-1; cuby4 test.yaml &>LOG\ncd absolute-directory-2; cuby4 test.yaml &>LOG\n......\n```\n\nthere should exist xyz and yaml files in every absolute directory.\n\n## Scripts for Parallel-Run\n- [pm6opt_parallel.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/pm6opt_parallel.py)\n- [pm6traj_parallel.py](https://github.com/yueliu96/scripts_for_lab/blob/master/pm6traj_parallel.py)\n  \nTo run pm6-optimize or pm6-dynamics for several different modecules, create their xyz files in the working directory:\n\n```\ntest1.xyz test2.xyz test3.xyz\n```\n\nand then run `python pm6opt_parallel.py optimize` or `python pm6traj_parallel.py`. tasklists$.$sh file, parallel_run$.$sh file and sub-directories for every xyz file will be created, in where xyz and yaml files are created correspondingly:\n\n```\ndtest1  dtest2 dtest3 taskslists.sh parallel_run.sh\n```\n\nin `dtest1`: `test1.xyz inp.yaml` if it is opt job; `test1.xyz anneal.yaml` if it is dynamics job.\n\n# Output Analysis\n\n## opt output\n\nOptimization job produces optimized.xyz and histotry_xxx.xyz (xxx depends on the name of yaml file). The optimized.xyz is the optimized geometry in xyz formatted, where energy value is on the second line.\n\nIn the parallel-run case, one directory has several subdirectories containing finished optimized job (optimized.xyz), python script [extract_pm6opt.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/extract_pm6opt.py) can be used to extract optimized geometry and energy.\n\n- *Usage*:\n  - `python extract_pm6opt.py`\n  - run in the directory containing these subdirectories\n- *Descriptions*:\n  - read optimized.xyz in all subdirectories whose name starts with 'd', change their format from xyz to gaussian input and extract energies from these xyz files\n  - all new files are written to a new directory optresult\n  - the name of the structures and the gaussian input files depends on these subdirectories -- *test* if *dtest*\n\n## dynamics output \n\nDynamics job creates additional file trajectory_*.xyz containing geometry information of all steps, which can be visualized by [VMD](https://www.ks.uiuc.edu/Research/vmd/) software. The user can extract specific snapshots from the trajcetroy according to the stepsize set by VMD. Or use the python script [traj2xyz.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/traj2xyzs.py) to achieve the same goal as VMD extractor.\n\n- *Usage*:\n  - `python traj2xyz.py stride`\n  - stride must be an integer\n  - stride=100: 200 snapshots out of 200000 will be extracted from trajectory\n  - run in the directory containing child-directory where trajectory_*.xyz locates\n- *Descriptions*:\n  - go through all subdirectories to locate trajectory_*.xyz, extract an exact number of geometries from trajectory and wirtten them to new subdirectories correspondingly\n  - the name of new subdirectories and snapshots are based on the name of subdirectories\n  - if originally `dtesta dtestb`, then after run this script: `dtesta dtesta_snapshots dtestb dtestb_snapshots`; in `dtesta_snapshots`: `testa_snap1.xyz testa_snap2.xyz ...`\n","source":"_posts/Mopac-with-Cuby4.md","raw":"---\ntitle: Mopac with Cuby4\ndate: 2018-12-28 22:03:11\ntags:\n- Hyak\n- ComputChem\n- software\ncategories:\n- Turecek Lab Tutorial\n---\n\n*Two types of jobs, optimization and dynamics with pm6 method, are introduced here. Linked python scripts should be useful to setup input and analyze result, which can run both in python2 and in python3.*\n\n*[Mopac](http://openmopac.net/Manual/index.html) is a general-purpose semiempirical molecular orbital package for the study of solid state and molecular structures and reactions. Several semiempirical methods are used to calculate electronic part, among which we usually choose PM6 method to run geometry optimization and molecular dynamics. Just like other computational software packages, Mopac works in 3 steps: create a data file which describes molecular system and specifies job types; command Mopac to carry out the calcualtion with that data-file (on Hyak node); extract the desired result from the output-file.*\n\n# Input Setup\n\n[Cuby](http://cuby4.molecular.cz) provides an unified access to various computational methods available in different software packages, including gaussian, mopac, turbomole, etc. It is a computational chemistry framework written in ruby, which does very little for itself, but calls external softwares to do the calculations and works with their results. To work with cuby, two input files are needed: xyz file and yaml file. \n\n## xyz-file\n\nxyz file contains the geometry of the molecule system -- the first line is the number of atoms, the second line is the comment line (could be blank) and the remaining lines are atoms Cartesian coordinates. Take $H_2O$ as an example:\n\n  ```\n  3\n\n  O                 -0.54954964    0.83729475    0.01780404\n  H                 -0.87000423    1.74223058    0.01780404\n  H                  0.41045036    0.83729475    0.01780404\n  ```\n\n Common input files we use are gaussian input files. The script, [gjfcom2xyz.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py) can convert the input file from gaussian input format to xyz format. \n\n- *Usage*\n  - `python gjfcom2xyz.py input-file`\n- *Descriptions*\n  - use charge and multiplicity (chg&mp) as a key to locate the start of coordinates\n  - every lines containing 4 elements after chg&mp is considered as coordinate line.\n\npython script [xyz2gjf.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/xyz2gjf.py) can convert xyz format back to gaussian input format.\n\n- *Usage*\n  - `python xyz2gjf.py xyz-file`\n- *Descriptions*\n  - every line after the second line contains 4 elements and the last three elements are float is considered as coordinate line\n  - route card, charge and multiplicity are defined by default, could be changed later or modified in the scripts.\n\n## yaml-file\n\nyaml file is a list of keywords, which is the bridge to connect cuby with computational softwares.\n\n### optimize-yaml\n\n*Example--inp.yaml*:\n\n```\njob: optimize\ngeometry: test.xyz\ncharge: 2\nmultiplicity: 1\ninterface: mopac\nmethod: pm6\nspin_restricted: auto_uhf\nmaxcycles: 2000\nprint: timing\nmopac_precise: yes\nmopac_peptide_bond_fix: yes\nmodifiers: dispersion3, h_bonds4\nmodifier_h_bonds:\n  h_bonds4_scale_charged: no\n  h_bonds4_extra_scaling: {}\n```\n\n*Explanations*:\n- job: optimize\n  - simple geometry optimization of molecule specified in test.xyz file\n  - the calculation produces these additional files:\n    - optimized.xyz - the optimized geometry\n    - history_inp.xyz - record of all the steps\n- spin_restricted: auto_uhf\n  - uhf for any open-shell systems, rhf is used for closed shells\n- maxcycles: 2000\n  - maximum number of cycles of optimization or molecular dynamics\n- print: timing\n  - print time spent in the program\n- [mopac_precise](http://openmopac.net/manual/precise.html): yes\n  - use tight thresholds, needed for accurate gradient\n- [mopac_peptide_bond_fix](http://openmopac.net/manual/mmok.html): yes\n  - controls the corerction for peptide bond torsion\n- modifiers\n  - a list of interfaces applied as a modifiers to this calculations.\n\n### dynamics-yaml\n\n*Example--anneal.yaml*:\n\n```\njob: dynamics\ngeometry: test.xyz\ncharge: 2\nmultiplicity: 1\nspin_restricted: auto_uhf\ninterface: mopac\nmethod: pm6\nmopac_precise: yes\nmopac_peptide_bond_fix: yes\nmodifiers: dispersion3, h_bonds4\nmodifier_h_bonds:\n  h_bonds4_scale_charged: no\n  h_bonds4_extra_scaling: {}\nmaxcycles: 20000\ntimestep: 0.001\ninit_temp: 310\ntemperature: 310\nthermostat: berendsen\nthermostat_tc: 0.05\n```\n\n*Explanations*:\n- job: dynamics\n  - molecular dynamics simulation of molecule specified in test.xyz file\n  - the calculation produces these additional files:\n    - last.xyz - the last geometry\n    - trajectory_test.xyz - record of all the cycles (20000 here)\n    - LOG - standard output and error information for every cycle\n- maxcycles: 20000\n  - 20 ps of MD simulation (the default step is 1 fs)\n- init_temp: 310\n  - temperature (K) used to generate initial random velocities\n- temperature: 310\n  - temperature (K) to be maintained by the thermostat\n- thermostat: berendsen\n  - selection of thermostat algorithm\n- thermostat_tc: 0.05\n  - Thermostat time constant (ps) setting strength of the coupling to the thermostat. The exact mening of the value is different in different algorithms.\n\n*Note*:\n- add `scf_cycles: 1000` for open-shell system to define the maximum number of SCF iterations\n\n### Other Keywords\n- `job_cleanup: yes | no`\n  - delete directories with external calculations when job finishes successfuly, default is yes\n- `mopac_keywords: \"\"`\n  - extra keywords (in the MOPAC format) added into the input\n- `scf_convergence: 7`\n  - change SCF convergence threshold (energy): set to $10^{-7}$ a.u.\n- click [here](http://cuby4.molecular.cz/keywords.html) to see more\n\n# Submit to Hyak\n\nBesides xyz and yaml (test.yaml) files, sbatch file (test.sh) also needed:\n\n```\n#!/bin/bash\n#SBATCH --job-name=???\n#SBATCH --nodes=1\n#SBATCH --time=??:00:00\n#SBATCH --mem=???GB\n#SBATCH --workdir=????????????\n#SBATCH --partition=???\n#SBATCH --account=???\n\nmodule load contrib/mopac16\nsource /usr/lusers/yueliu96/.rvm/scripts/rvm\nldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so > ldd.log\ncuby4 test.yaml &>LOG    \n## results and error information will be written to file LOG\n## cuby4 test.yaml: same information will be written to slurm file\n```\nrun `sbatch test.sh` to submit it.\n\n## Parallel-Run\n\nMost nodes on hyak.mox have 28 processors, however, the code in MOPAC only allows a single processor to be used for a single calculation. If several calculations to be run, each calculation could be started on a different processor in one node.\n\n```\n#!/bin/bash\n#SBATCH --job-name=??????\n#SBATCH --nodes=1\n#SBATCH --time=??:00:00\n#SBATCH --mem=???G\n#SBATCH --workdir=??????\n#SBATCH --partition=???\n#SBATCH --account=???\n\nmodule load parallel-20170722\nmodule load contrib/mopac16\nsource /usr/lusers/yueliu96/.rvm/scripts/rvm\nldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so > ldd.log\ncat tasklists.sh | parallel -j 28\n```\nwhere, tasklists$.$sh is :\n\n```\ncd absolute-directory-1; cuby4 test.yaml &>LOG\ncd absolute-directory-2; cuby4 test.yaml &>LOG\n......\n```\n\nthere should exist xyz and yaml files in every absolute directory.\n\n## Scripts for Parallel-Run\n- [pm6opt_parallel.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/pm6opt_parallel.py)\n- [pm6traj_parallel.py](https://github.com/yueliu96/scripts_for_lab/blob/master/pm6traj_parallel.py)\n  \nTo run pm6-optimize or pm6-dynamics for several different modecules, create their xyz files in the working directory:\n\n```\ntest1.xyz test2.xyz test3.xyz\n```\n\nand then run `python pm6opt_parallel.py optimize` or `python pm6traj_parallel.py`. tasklists$.$sh file, parallel_run$.$sh file and sub-directories for every xyz file will be created, in where xyz and yaml files are created correspondingly:\n\n```\ndtest1  dtest2 dtest3 taskslists.sh parallel_run.sh\n```\n\nin `dtest1`: `test1.xyz inp.yaml` if it is opt job; `test1.xyz anneal.yaml` if it is dynamics job.\n\n# Output Analysis\n\n## opt output\n\nOptimization job produces optimized.xyz and histotry_xxx.xyz (xxx depends on the name of yaml file). The optimized.xyz is the optimized geometry in xyz formatted, where energy value is on the second line.\n\nIn the parallel-run case, one directory has several subdirectories containing finished optimized job (optimized.xyz), python script [extract_pm6opt.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/extract_pm6opt.py) can be used to extract optimized geometry and energy.\n\n- *Usage*:\n  - `python extract_pm6opt.py`\n  - run in the directory containing these subdirectories\n- *Descriptions*:\n  - read optimized.xyz in all subdirectories whose name starts with 'd', change their format from xyz to gaussian input and extract energies from these xyz files\n  - all new files are written to a new directory optresult\n  - the name of the structures and the gaussian input files depends on these subdirectories -- *test* if *dtest*\n\n## dynamics output \n\nDynamics job creates additional file trajectory_*.xyz containing geometry information of all steps, which can be visualized by [VMD](https://www.ks.uiuc.edu/Research/vmd/) software. The user can extract specific snapshots from the trajcetroy according to the stepsize set by VMD. Or use the python script [traj2xyz.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/traj2xyzs.py) to achieve the same goal as VMD extractor.\n\n- *Usage*:\n  - `python traj2xyz.py stride`\n  - stride must be an integer\n  - stride=100: 200 snapshots out of 200000 will be extracted from trajectory\n  - run in the directory containing child-directory where trajectory_*.xyz locates\n- *Descriptions*:\n  - go through all subdirectories to locate trajectory_*.xyz, extract an exact number of geometries from trajectory and wirtten them to new subdirectories correspondingly\n  - the name of new subdirectories and snapshots are based on the name of subdirectories\n  - if originally `dtesta dtestb`, then after run this script: `dtesta dtesta_snapshots dtestb dtestb_snapshots`; in `dtesta_snapshots`: `testa_snap1.xyz testa_snap2.xyz ...`\n","slug":"Mopac-with-Cuby4","published":1,"updated":"2019-01-04T21:40:09.309Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjqojihq3000gp45k1fl8i9n3","content":"<p><em>Two types of jobs, optimization and dynamics with pm6 method, are introduced here. Linked python scripts should be useful to setup input and analyze result, which can run both in python2 and in python3.</em></p>\n<p><em><a href=\"http://openmopac.net/Manual/index.html\" target=\"_blank\" rel=\"noopener\">Mopac</a> is a general-purpose semiempirical molecular orbital package for the study of solid state and molecular structures and reactions. Several semiempirical methods are used to calculate electronic part, among which we usually choose PM6 method to run geometry optimization and molecular dynamics. Just like other computational software packages, Mopac works in 3 steps: create a data file which describes molecular system and specifies job types; command Mopac to carry out the calcualtion with that data-file (on Hyak node); extract the desired result from the output-file.</em></p>\n<h1 id=\"Input-Setup\"><a href=\"#Input-Setup\" class=\"headerlink\" title=\"Input Setup\"></a>Input Setup</h1><p><a href=\"http://cuby4.molecular.cz\" target=\"_blank\" rel=\"noopener\">Cuby</a> provides an unified access to various computational methods available in different software packages, including gaussian, mopac, turbomole, etc. It is a computational chemistry framework written in ruby, which does very little for itself, but calls external softwares to do the calculations and works with their results. To work with cuby, two input files are needed: xyz file and yaml file. </p>\n<h2 id=\"xyz-file\"><a href=\"#xyz-file\" class=\"headerlink\" title=\"xyz-file\"></a>xyz-file</h2><p>xyz file contains the geometry of the molecule system  the first line is the number of atoms, the second line is the comment line (could be blank) and the remaining lines are atoms Cartesian coordinates. Take $H_2O$ as an example:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3</span><br><span class=\"line\"></span><br><span class=\"line\">O                 -0.54954964    0.83729475    0.01780404</span><br><span class=\"line\">H                 -0.87000423    1.74223058    0.01780404</span><br><span class=\"line\">H                  0.41045036    0.83729475    0.01780404</span><br></pre></td></tr></table></figure>\n<p> Common input files we use are gaussian input files. The script, <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py\" target=\"_blank\" rel=\"noopener\">gjfcom2xyz.py</a> can convert the input file from gaussian input format to xyz format. </p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python gjfcom2xyz.py input-file</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>use charge and multiplicity (chg&amp;mp) as a key to locate the start of coordinates</li>\n<li>every lines containing 4 elements after chg&amp;mp is considered as coordinate line.</li>\n</ul>\n</li>\n</ul>\n<p>python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/xyz2gjf.py\" target=\"_blank\" rel=\"noopener\">xyz2gjf.py</a> can convert xyz format back to gaussian input format.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python xyz2gjf.py xyz-file</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>every line after the second line contains 4 elements and the last three elements are float is considered as coordinate line</li>\n<li>route card, charge and multiplicity are defined by default, could be changed later or modified in the scripts.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"yaml-file\"><a href=\"#yaml-file\" class=\"headerlink\" title=\"yaml-file\"></a>yaml-file</h2><p>yaml file is a list of keywords, which is the bridge to connect cuby with computational softwares.</p>\n<h3 id=\"optimize-yaml\"><a href=\"#optimize-yaml\" class=\"headerlink\" title=\"optimize-yaml\"></a>optimize-yaml</h3><p><em>Exampleinp.yaml</em>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">job: optimize</span><br><span class=\"line\">geometry: test.xyz</span><br><span class=\"line\">charge: 2</span><br><span class=\"line\">multiplicity: 1</span><br><span class=\"line\">interface: mopac</span><br><span class=\"line\">method: pm6</span><br><span class=\"line\">spin_restricted: auto_uhf</span><br><span class=\"line\">maxcycles: 2000</span><br><span class=\"line\">print: timing</span><br><span class=\"line\">mopac_precise: yes</span><br><span class=\"line\">mopac_peptide_bond_fix: yes</span><br><span class=\"line\">modifiers: dispersion3, h_bonds4</span><br><span class=\"line\">modifier_h_bonds:</span><br><span class=\"line\">  h_bonds4_scale_charged: no</span><br><span class=\"line\">  h_bonds4_extra_scaling: &#123;&#125;</span><br></pre></td></tr></table></figure>\n<p><em>Explanations</em>:</p>\n<ul>\n<li>job: optimize<ul>\n<li>simple geometry optimization of molecule specified in test.xyz file</li>\n<li>the calculation produces these additional files:<ul>\n<li>optimized.xyz - the optimized geometry</li>\n<li>history_inp.xyz - record of all the steps</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>spin_restricted: auto_uhf<ul>\n<li>uhf for any open-shell systems, rhf is used for closed shells</li>\n</ul>\n</li>\n<li>maxcycles: 2000<ul>\n<li>maximum number of cycles of optimization or molecular dynamics</li>\n</ul>\n</li>\n<li>print: timing<ul>\n<li>print time spent in the program</li>\n</ul>\n</li>\n<li><a href=\"http://openmopac.net/manual/precise.html\" target=\"_blank\" rel=\"noopener\">mopac_precise</a>: yes<ul>\n<li>use tight thresholds, needed for accurate gradient</li>\n</ul>\n</li>\n<li><a href=\"http://openmopac.net/manual/mmok.html\" target=\"_blank\" rel=\"noopener\">mopac_peptide_bond_fix</a>: yes<ul>\n<li>controls the corerction for peptide bond torsion</li>\n</ul>\n</li>\n<li>modifiers<ul>\n<li>a list of interfaces applied as a modifiers to this calculations.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"dynamics-yaml\"><a href=\"#dynamics-yaml\" class=\"headerlink\" title=\"dynamics-yaml\"></a>dynamics-yaml</h3><p><em>Exampleanneal.yaml</em>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">job: dynamics</span><br><span class=\"line\">geometry: test.xyz</span><br><span class=\"line\">charge: 2</span><br><span class=\"line\">multiplicity: 1</span><br><span class=\"line\">spin_restricted: auto_uhf</span><br><span class=\"line\">interface: mopac</span><br><span class=\"line\">method: pm6</span><br><span class=\"line\">mopac_precise: yes</span><br><span class=\"line\">mopac_peptide_bond_fix: yes</span><br><span class=\"line\">modifiers: dispersion3, h_bonds4</span><br><span class=\"line\">modifier_h_bonds:</span><br><span class=\"line\">  h_bonds4_scale_charged: no</span><br><span class=\"line\">  h_bonds4_extra_scaling: &#123;&#125;</span><br><span class=\"line\">maxcycles: 20000</span><br><span class=\"line\">timestep: 0.001</span><br><span class=\"line\">init_temp: 310</span><br><span class=\"line\">temperature: 310</span><br><span class=\"line\">thermostat: berendsen</span><br><span class=\"line\">thermostat_tc: 0.05</span><br></pre></td></tr></table></figure>\n<p><em>Explanations</em>:</p>\n<ul>\n<li>job: dynamics<ul>\n<li>molecular dynamics simulation of molecule specified in test.xyz file</li>\n<li>the calculation produces these additional files:<ul>\n<li>last.xyz - the last geometry</li>\n<li>trajectory_test.xyz - record of all the cycles (20000 here)</li>\n<li>LOG - standard output and error information for every cycle</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>maxcycles: 20000<ul>\n<li>20 ps of MD simulation (the default step is 1 fs)</li>\n</ul>\n</li>\n<li>init_temp: 310<ul>\n<li>temperature (K) used to generate initial random velocities</li>\n</ul>\n</li>\n<li>temperature: 310<ul>\n<li>temperature (K) to be maintained by the thermostat</li>\n</ul>\n</li>\n<li>thermostat: berendsen<ul>\n<li>selection of thermostat algorithm</li>\n</ul>\n</li>\n<li>thermostat_tc: 0.05<ul>\n<li>Thermostat time constant (ps) setting strength of the coupling to the thermostat. The exact mening of the value is different in different algorithms.</li>\n</ul>\n</li>\n</ul>\n<p><em>Note</em>:</p>\n<ul>\n<li>add <code>scf_cycles: 1000</code> for open-shell system to define the maximum number of SCF iterations</li>\n</ul>\n<h3 id=\"Other-Keywords\"><a href=\"#Other-Keywords\" class=\"headerlink\" title=\"Other Keywords\"></a>Other Keywords</h3><ul>\n<li><code>job_cleanup: yes | no</code><ul>\n<li>delete directories with external calculations when job finishes successfuly, default is yes</li>\n</ul>\n</li>\n<li><code>mopac_keywords: &quot;&quot;</code><ul>\n<li>extra keywords (in the MOPAC format) added into the input</li>\n</ul>\n</li>\n<li><code>scf_convergence: 7</code><ul>\n<li>change SCF convergence threshold (energy): set to $10^{-7}$ a.u.</li>\n</ul>\n</li>\n<li>click <a href=\"http://cuby4.molecular.cz/keywords.html\" target=\"_blank\" rel=\"noopener\">here</a> to see more</li>\n</ul>\n<h1 id=\"Submit-to-Hyak\"><a href=\"#Submit-to-Hyak\" class=\"headerlink\" title=\"Submit to Hyak\"></a>Submit to Hyak</h1><p>Besides xyz and yaml (test.yaml) files, sbatch file (test.sh) also needed:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=???</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --time=??:00:00</span><br><span class=\"line\">#SBATCH --mem=???GB</span><br><span class=\"line\">#SBATCH --workdir=????????????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">module load contrib/mopac16</span><br><span class=\"line\">source /usr/lusers/yueliu96/.rvm/scripts/rvm</span><br><span class=\"line\">ldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so &gt; ldd.log</span><br><span class=\"line\">cuby4 test.yaml &amp;&gt;LOG    </span><br><span class=\"line\">## results and error information will be written to file LOG</span><br><span class=\"line\">## cuby4 test.yaml: same information will be written to slurm file</span><br></pre></td></tr></table></figure>\n<p>run <code>sbatch test.sh</code> to submit it.</p>\n<h2 id=\"Parallel-Run\"><a href=\"#Parallel-Run\" class=\"headerlink\" title=\"Parallel-Run\"></a>Parallel-Run</h2><p>Most nodes on hyak.mox have 28 processors, however, the code in MOPAC only allows a single processor to be used for a single calculation. If several calculations to be run, each calculation could be started on a different processor in one node.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=??????</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --time=??:00:00</span><br><span class=\"line\">#SBATCH --mem=???G</span><br><span class=\"line\">#SBATCH --workdir=??????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">module load parallel-20170722</span><br><span class=\"line\">module load contrib/mopac16</span><br><span class=\"line\">source /usr/lusers/yueliu96/.rvm/scripts/rvm</span><br><span class=\"line\">ldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so &gt; ldd.log</span><br><span class=\"line\">cat tasklists.sh | parallel -j 28</span><br></pre></td></tr></table></figure>\n<p>where, tasklists$.$sh is :</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd absolute-directory-1; cuby4 test.yaml &amp;&gt;LOG</span><br><span class=\"line\">cd absolute-directory-2; cuby4 test.yaml &amp;&gt;LOG</span><br><span class=\"line\">......</span><br></pre></td></tr></table></figure>\n<p>there should exist xyz and yaml files in every absolute directory.</p>\n<h2 id=\"Scripts-for-Parallel-Run\"><a href=\"#Scripts-for-Parallel-Run\" class=\"headerlink\" title=\"Scripts for Parallel-Run\"></a>Scripts for Parallel-Run</h2><ul>\n<li><a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/pm6opt_parallel.py\" target=\"_blank\" rel=\"noopener\">pm6opt_parallel.py</a></li>\n<li><a href=\"https://github.com/yueliu96/scripts_for_lab/blob/master/pm6traj_parallel.py\" target=\"_blank\" rel=\"noopener\">pm6traj_parallel.py</a></li>\n</ul>\n<p>To run pm6-optimize or pm6-dynamics for several different modecules, create their xyz files in the working directory:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test1.xyz test2.xyz test3.xyz</span><br></pre></td></tr></table></figure>\n<p>and then run <code>python pm6opt_parallel.py optimize</code> or <code>python pm6traj_parallel.py</code>. tasklists$.$sh file, parallel_run$.$sh file and sub-directories for every xyz file will be created, in where xyz and yaml files are created correspondingly:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dtest1  dtest2 dtest3 taskslists.sh parallel_run.sh</span><br></pre></td></tr></table></figure>\n<p>in <code>dtest1</code>: <code>test1.xyz inp.yaml</code> if it is opt job; <code>test1.xyz anneal.yaml</code> if it is dynamics job.</p>\n<h1 id=\"Output-Analysis\"><a href=\"#Output-Analysis\" class=\"headerlink\" title=\"Output Analysis\"></a>Output Analysis</h1><h2 id=\"opt-output\"><a href=\"#opt-output\" class=\"headerlink\" title=\"opt output\"></a>opt output</h2><p>Optimization job produces optimized.xyz and histotry_xxx.xyz (xxx depends on the name of yaml file). The optimized.xyz is the optimized geometry in xyz formatted, where energy value is on the second line.</p>\n<p>In the parallel-run case, one directory has several subdirectories containing finished optimized job (optimized.xyz), python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/extract_pm6opt.py\" target=\"_blank\" rel=\"noopener\">extract_pm6opt.py</a> can be used to extract optimized geometry and energy.</p>\n<ul>\n<li><em>Usage</em>:<ul>\n<li><code>python extract_pm6opt.py</code></li>\n<li>run in the directory containing these subdirectories</li>\n</ul>\n</li>\n<li><em>Descriptions</em>:<ul>\n<li>read optimized.xyz in all subdirectories whose name starts with d, change their format from xyz to gaussian input and extract energies from these xyz files</li>\n<li>all new files are written to a new directory optresult</li>\n<li>the name of the structures and the gaussian input files depends on these subdirectories  <em>test</em> if <em>dtest</em></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"dynamics-output\"><a href=\"#dynamics-output\" class=\"headerlink\" title=\"dynamics output\"></a>dynamics output</h2><p>Dynamics job creates additional file trajectory_*.xyz containing geometry information of all steps, which can be visualized by <a href=\"https://www.ks.uiuc.edu/Research/vmd/\" target=\"_blank\" rel=\"noopener\">VMD</a> software. The user can extract specific snapshots from the trajcetroy according to the stepsize set by VMD. Or use the python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/traj2xyzs.py\" target=\"_blank\" rel=\"noopener\">traj2xyz.py</a> to achieve the same goal as VMD extractor.</p>\n<ul>\n<li><em>Usage</em>:<ul>\n<li><code>python traj2xyz.py stride</code></li>\n<li>stride must be an integer</li>\n<li>stride=100: 200 snapshots out of 200000 will be extracted from trajectory</li>\n<li>run in the directory containing child-directory where trajectory_*.xyz locates</li>\n</ul>\n</li>\n<li><em>Descriptions</em>:<ul>\n<li>go through all subdirectories to locate trajectory_*.xyz, extract an exact number of geometries from trajectory and wirtten them to new subdirectories correspondingly</li>\n<li>the name of new subdirectories and snapshots are based on the name of subdirectories</li>\n<li>if originally <code>dtesta dtestb</code>, then after run this script: <code>dtesta dtesta_snapshots dtestb dtestb_snapshots</code>; in <code>dtesta_snapshots</code>: <code>testa_snap1.xyz testa_snap2.xyz ...</code></li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><em>Two types of jobs, optimization and dynamics with pm6 method, are introduced here. Linked python scripts should be useful to setup input and analyze result, which can run both in python2 and in python3.</em></p>\n<p><em><a href=\"http://openmopac.net/Manual/index.html\" target=\"_blank\" rel=\"noopener\">Mopac</a> is a general-purpose semiempirical molecular orbital package for the study of solid state and molecular structures and reactions. Several semiempirical methods are used to calculate electronic part, among which we usually choose PM6 method to run geometry optimization and molecular dynamics. Just like other computational software packages, Mopac works in 3 steps: create a data file which describes molecular system and specifies job types; command Mopac to carry out the calcualtion with that data-file (on Hyak node); extract the desired result from the output-file.</em></p>\n<h1 id=\"Input-Setup\"><a href=\"#Input-Setup\" class=\"headerlink\" title=\"Input Setup\"></a>Input Setup</h1><p><a href=\"http://cuby4.molecular.cz\" target=\"_blank\" rel=\"noopener\">Cuby</a> provides an unified access to various computational methods available in different software packages, including gaussian, mopac, turbomole, etc. It is a computational chemistry framework written in ruby, which does very little for itself, but calls external softwares to do the calculations and works with their results. To work with cuby, two input files are needed: xyz file and yaml file. </p>\n<h2 id=\"xyz-file\"><a href=\"#xyz-file\" class=\"headerlink\" title=\"xyz-file\"></a>xyz-file</h2><p>xyz file contains the geometry of the molecule system  the first line is the number of atoms, the second line is the comment line (could be blank) and the remaining lines are atoms Cartesian coordinates. Take $H_2O$ as an example:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3</span><br><span class=\"line\"></span><br><span class=\"line\">O                 -0.54954964    0.83729475    0.01780404</span><br><span class=\"line\">H                 -0.87000423    1.74223058    0.01780404</span><br><span class=\"line\">H                  0.41045036    0.83729475    0.01780404</span><br></pre></td></tr></table></figure>\n<p> Common input files we use are gaussian input files. The script, <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/gjfcom2xyz.py\" target=\"_blank\" rel=\"noopener\">gjfcom2xyz.py</a> can convert the input file from gaussian input format to xyz format. </p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python gjfcom2xyz.py input-file</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>use charge and multiplicity (chg&amp;mp) as a key to locate the start of coordinates</li>\n<li>every lines containing 4 elements after chg&amp;mp is considered as coordinate line.</li>\n</ul>\n</li>\n</ul>\n<p>python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/xyz2gjf.py\" target=\"_blank\" rel=\"noopener\">xyz2gjf.py</a> can convert xyz format back to gaussian input format.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python xyz2gjf.py xyz-file</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>every line after the second line contains 4 elements and the last three elements are float is considered as coordinate line</li>\n<li>route card, charge and multiplicity are defined by default, could be changed later or modified in the scripts.</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"yaml-file\"><a href=\"#yaml-file\" class=\"headerlink\" title=\"yaml-file\"></a>yaml-file</h2><p>yaml file is a list of keywords, which is the bridge to connect cuby with computational softwares.</p>\n<h3 id=\"optimize-yaml\"><a href=\"#optimize-yaml\" class=\"headerlink\" title=\"optimize-yaml\"></a>optimize-yaml</h3><p><em>Exampleinp.yaml</em>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">job: optimize</span><br><span class=\"line\">geometry: test.xyz</span><br><span class=\"line\">charge: 2</span><br><span class=\"line\">multiplicity: 1</span><br><span class=\"line\">interface: mopac</span><br><span class=\"line\">method: pm6</span><br><span class=\"line\">spin_restricted: auto_uhf</span><br><span class=\"line\">maxcycles: 2000</span><br><span class=\"line\">print: timing</span><br><span class=\"line\">mopac_precise: yes</span><br><span class=\"line\">mopac_peptide_bond_fix: yes</span><br><span class=\"line\">modifiers: dispersion3, h_bonds4</span><br><span class=\"line\">modifier_h_bonds:</span><br><span class=\"line\">  h_bonds4_scale_charged: no</span><br><span class=\"line\">  h_bonds4_extra_scaling: &#123;&#125;</span><br></pre></td></tr></table></figure>\n<p><em>Explanations</em>:</p>\n<ul>\n<li>job: optimize<ul>\n<li>simple geometry optimization of molecule specified in test.xyz file</li>\n<li>the calculation produces these additional files:<ul>\n<li>optimized.xyz - the optimized geometry</li>\n<li>history_inp.xyz - record of all the steps</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>spin_restricted: auto_uhf<ul>\n<li>uhf for any open-shell systems, rhf is used for closed shells</li>\n</ul>\n</li>\n<li>maxcycles: 2000<ul>\n<li>maximum number of cycles of optimization or molecular dynamics</li>\n</ul>\n</li>\n<li>print: timing<ul>\n<li>print time spent in the program</li>\n</ul>\n</li>\n<li><a href=\"http://openmopac.net/manual/precise.html\" target=\"_blank\" rel=\"noopener\">mopac_precise</a>: yes<ul>\n<li>use tight thresholds, needed for accurate gradient</li>\n</ul>\n</li>\n<li><a href=\"http://openmopac.net/manual/mmok.html\" target=\"_blank\" rel=\"noopener\">mopac_peptide_bond_fix</a>: yes<ul>\n<li>controls the corerction for peptide bond torsion</li>\n</ul>\n</li>\n<li>modifiers<ul>\n<li>a list of interfaces applied as a modifiers to this calculations.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"dynamics-yaml\"><a href=\"#dynamics-yaml\" class=\"headerlink\" title=\"dynamics-yaml\"></a>dynamics-yaml</h3><p><em>Exampleanneal.yaml</em>:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">job: dynamics</span><br><span class=\"line\">geometry: test.xyz</span><br><span class=\"line\">charge: 2</span><br><span class=\"line\">multiplicity: 1</span><br><span class=\"line\">spin_restricted: auto_uhf</span><br><span class=\"line\">interface: mopac</span><br><span class=\"line\">method: pm6</span><br><span class=\"line\">mopac_precise: yes</span><br><span class=\"line\">mopac_peptide_bond_fix: yes</span><br><span class=\"line\">modifiers: dispersion3, h_bonds4</span><br><span class=\"line\">modifier_h_bonds:</span><br><span class=\"line\">  h_bonds4_scale_charged: no</span><br><span class=\"line\">  h_bonds4_extra_scaling: &#123;&#125;</span><br><span class=\"line\">maxcycles: 20000</span><br><span class=\"line\">timestep: 0.001</span><br><span class=\"line\">init_temp: 310</span><br><span class=\"line\">temperature: 310</span><br><span class=\"line\">thermostat: berendsen</span><br><span class=\"line\">thermostat_tc: 0.05</span><br></pre></td></tr></table></figure>\n<p><em>Explanations</em>:</p>\n<ul>\n<li>job: dynamics<ul>\n<li>molecular dynamics simulation of molecule specified in test.xyz file</li>\n<li>the calculation produces these additional files:<ul>\n<li>last.xyz - the last geometry</li>\n<li>trajectory_test.xyz - record of all the cycles (20000 here)</li>\n<li>LOG - standard output and error information for every cycle</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>maxcycles: 20000<ul>\n<li>20 ps of MD simulation (the default step is 1 fs)</li>\n</ul>\n</li>\n<li>init_temp: 310<ul>\n<li>temperature (K) used to generate initial random velocities</li>\n</ul>\n</li>\n<li>temperature: 310<ul>\n<li>temperature (K) to be maintained by the thermostat</li>\n</ul>\n</li>\n<li>thermostat: berendsen<ul>\n<li>selection of thermostat algorithm</li>\n</ul>\n</li>\n<li>thermostat_tc: 0.05<ul>\n<li>Thermostat time constant (ps) setting strength of the coupling to the thermostat. The exact mening of the value is different in different algorithms.</li>\n</ul>\n</li>\n</ul>\n<p><em>Note</em>:</p>\n<ul>\n<li>add <code>scf_cycles: 1000</code> for open-shell system to define the maximum number of SCF iterations</li>\n</ul>\n<h3 id=\"Other-Keywords\"><a href=\"#Other-Keywords\" class=\"headerlink\" title=\"Other Keywords\"></a>Other Keywords</h3><ul>\n<li><code>job_cleanup: yes | no</code><ul>\n<li>delete directories with external calculations when job finishes successfuly, default is yes</li>\n</ul>\n</li>\n<li><code>mopac_keywords: &quot;&quot;</code><ul>\n<li>extra keywords (in the MOPAC format) added into the input</li>\n</ul>\n</li>\n<li><code>scf_convergence: 7</code><ul>\n<li>change SCF convergence threshold (energy): set to $10^{-7}$ a.u.</li>\n</ul>\n</li>\n<li>click <a href=\"http://cuby4.molecular.cz/keywords.html\" target=\"_blank\" rel=\"noopener\">here</a> to see more</li>\n</ul>\n<h1 id=\"Submit-to-Hyak\"><a href=\"#Submit-to-Hyak\" class=\"headerlink\" title=\"Submit to Hyak\"></a>Submit to Hyak</h1><p>Besides xyz and yaml (test.yaml) files, sbatch file (test.sh) also needed:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=???</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --time=??:00:00</span><br><span class=\"line\">#SBATCH --mem=???GB</span><br><span class=\"line\">#SBATCH --workdir=????????????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">module load contrib/mopac16</span><br><span class=\"line\">source /usr/lusers/yueliu96/.rvm/scripts/rvm</span><br><span class=\"line\">ldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so &gt; ldd.log</span><br><span class=\"line\">cuby4 test.yaml &amp;&gt;LOG    </span><br><span class=\"line\">## results and error information will be written to file LOG</span><br><span class=\"line\">## cuby4 test.yaml: same information will be written to slurm file</span><br></pre></td></tr></table></figure>\n<p>run <code>sbatch test.sh</code> to submit it.</p>\n<h2 id=\"Parallel-Run\"><a href=\"#Parallel-Run\" class=\"headerlink\" title=\"Parallel-Run\"></a>Parallel-Run</h2><p>Most nodes on hyak.mox have 28 processors, however, the code in MOPAC only allows a single processor to be used for a single calculation. If several calculations to be run, each calculation could be started on a different processor in one node.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=??????</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --time=??:00:00</span><br><span class=\"line\">#SBATCH --mem=???G</span><br><span class=\"line\">#SBATCH --workdir=??????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">module load parallel-20170722</span><br><span class=\"line\">module load contrib/mopac16</span><br><span class=\"line\">source /usr/lusers/yueliu96/.rvm/scripts/rvm</span><br><span class=\"line\">ldd /sw/contrib/cuby4/cuby4/classes/algebra/algebra_c.so &gt; ldd.log</span><br><span class=\"line\">cat tasklists.sh | parallel -j 28</span><br></pre></td></tr></table></figure>\n<p>where, tasklists$.$sh is :</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd absolute-directory-1; cuby4 test.yaml &amp;&gt;LOG</span><br><span class=\"line\">cd absolute-directory-2; cuby4 test.yaml &amp;&gt;LOG</span><br><span class=\"line\">......</span><br></pre></td></tr></table></figure>\n<p>there should exist xyz and yaml files in every absolute directory.</p>\n<h2 id=\"Scripts-for-Parallel-Run\"><a href=\"#Scripts-for-Parallel-Run\" class=\"headerlink\" title=\"Scripts for Parallel-Run\"></a>Scripts for Parallel-Run</h2><ul>\n<li><a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/pm6opt_parallel.py\" target=\"_blank\" rel=\"noopener\">pm6opt_parallel.py</a></li>\n<li><a href=\"https://github.com/yueliu96/scripts_for_lab/blob/master/pm6traj_parallel.py\" target=\"_blank\" rel=\"noopener\">pm6traj_parallel.py</a></li>\n</ul>\n<p>To run pm6-optimize or pm6-dynamics for several different modecules, create their xyz files in the working directory:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">test1.xyz test2.xyz test3.xyz</span><br></pre></td></tr></table></figure>\n<p>and then run <code>python pm6opt_parallel.py optimize</code> or <code>python pm6traj_parallel.py</code>. tasklists$.$sh file, parallel_run$.$sh file and sub-directories for every xyz file will be created, in where xyz and yaml files are created correspondingly:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dtest1  dtest2 dtest3 taskslists.sh parallel_run.sh</span><br></pre></td></tr></table></figure>\n<p>in <code>dtest1</code>: <code>test1.xyz inp.yaml</code> if it is opt job; <code>test1.xyz anneal.yaml</code> if it is dynamics job.</p>\n<h1 id=\"Output-Analysis\"><a href=\"#Output-Analysis\" class=\"headerlink\" title=\"Output Analysis\"></a>Output Analysis</h1><h2 id=\"opt-output\"><a href=\"#opt-output\" class=\"headerlink\" title=\"opt output\"></a>opt output</h2><p>Optimization job produces optimized.xyz and histotry_xxx.xyz (xxx depends on the name of yaml file). The optimized.xyz is the optimized geometry in xyz formatted, where energy value is on the second line.</p>\n<p>In the parallel-run case, one directory has several subdirectories containing finished optimized job (optimized.xyz), python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/extract_pm6opt.py\" target=\"_blank\" rel=\"noopener\">extract_pm6opt.py</a> can be used to extract optimized geometry and energy.</p>\n<ul>\n<li><em>Usage</em>:<ul>\n<li><code>python extract_pm6opt.py</code></li>\n<li>run in the directory containing these subdirectories</li>\n</ul>\n</li>\n<li><em>Descriptions</em>:<ul>\n<li>read optimized.xyz in all subdirectories whose name starts with d, change their format from xyz to gaussian input and extract energies from these xyz files</li>\n<li>all new files are written to a new directory optresult</li>\n<li>the name of the structures and the gaussian input files depends on these subdirectories  <em>test</em> if <em>dtest</em></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"dynamics-output\"><a href=\"#dynamics-output\" class=\"headerlink\" title=\"dynamics output\"></a>dynamics output</h2><p>Dynamics job creates additional file trajectory_*.xyz containing geometry information of all steps, which can be visualized by <a href=\"https://www.ks.uiuc.edu/Research/vmd/\" target=\"_blank\" rel=\"noopener\">VMD</a> software. The user can extract specific snapshots from the trajcetroy according to the stepsize set by VMD. Or use the python script <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/traj2xyzs.py\" target=\"_blank\" rel=\"noopener\">traj2xyz.py</a> to achieve the same goal as VMD extractor.</p>\n<ul>\n<li><em>Usage</em>:<ul>\n<li><code>python traj2xyz.py stride</code></li>\n<li>stride must be an integer</li>\n<li>stride=100: 200 snapshots out of 200000 will be extracted from trajectory</li>\n<li>run in the directory containing child-directory where trajectory_*.xyz locates</li>\n</ul>\n</li>\n<li><em>Descriptions</em>:<ul>\n<li>go through all subdirectories to locate trajectory_*.xyz, extract an exact number of geometries from trajectory and wirtten them to new subdirectories correspondingly</li>\n<li>the name of new subdirectories and snapshots are based on the name of subdirectories</li>\n<li>if originally <code>dtesta dtestb</code>, then after run this script: <code>dtesta dtesta_snapshots dtestb dtestb_snapshots</code>; in <code>dtesta_snapshots</code>: <code>testa_snap1.xyz testa_snap2.xyz ...</code></li>\n</ul>\n</li>\n</ul>\n"},{"title":"Nucleotide Papers","date":"2019-01-02T23:30:51.000Z","_content":"\n ***Keyword***\n  \n adenine |  cation radical |  cytosine | electron attachment | guanine | nucleotide | proton transfer | spectra | thymine |\n\n\n# [UVVis Action Spectroscopy Reveals a Conformational Collapse in Hydrogen-Rich Dinucleotide Cation Radicals](https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01856)\n\n- Why\n  - DNA cation radicals are intermediates during the interaction of DNA with high energy particles\n  - electron defect initially located in a nucleobase, migrates along the DNA backbone to reside on guanine\n  - DNA behavior at atomic-level needed\n- Goal\n  - proton and electron transfer along a single strand in DNA and related cation radicals\n  - use deoxyriboadenosine dinucleotide (dAA) and riboadenosine chimeras (pseudo-dAA)\n- Intro\n  - dication$\\rightarrow$catrad: conformation collapse\n  - dAA\n    - intra proton migrations btw nucleobases\n  - pseudo-dAA-catrad\n    - zwitterionic structures\n    - Coulomb stablization\n  \n## 1. Gaseous Protonated A\n\n- N-1, N-3, N- 7, N-9, and NH2 (N-10) positions: potential protonation sites\n- dA: N-3\n  - H bond stablization\n- dAA: N-1, N-1''\n- psedo-dAA: N-3, N-3''\n  - H bond stablization\n\n## 2. Form Cation Radicals\n\n- ETD dAA+2$H^+$: $[M-H]^+(m/z\\ 565)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$, $w^+(m/z\\  332)$\n- M+CE/DBCE$\\rightarrow$ESI$\\rightarrow$ETD: $M^{+\\cdot}$\n- CE favors N-1 position\n\n## 3. UV-Vis Action Spectrum \n\n- vis: broad band at 465nm; uv: 340nm, 260nm \n- channel: $w^+(m/z\\ 332)$, $[w+H]^{+\\cdot}(m/z\\ 333)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$\n- 260nm is same with [pccp_adenine1](#ap1) and [pccp_adenine2](#ap2)\n\n## 4. Dinucleotide Cation Radical Structures\n\n- if exothermic, isomerization driven by proton migrations will occur sponstaneously and driven by exotherimic energy provided by the electron attachment reaction. \n- electron not attach N-1\n- hydrogen migration might face substantial energy barrier. [[A+H1](#l1) | [A+H2](#l2)]\n- proton transfer (move radical position)$\\rightarrow$optimize$\\rightarrow$ more stable structures\n- theoritical uvvis spectra and molecular orbital analysis $\\rightarrow$ possible tautomers & spectra contributions $\\pi_z \\rightarrow \\pi_z^*$\n\n## 5. Adenine Ribonucleotide Chimeras\n\n- uv-vis analysis: similiar band position to dAA \n- aromatic diesters\n  - opt: zwitterionic dication-anion radicals $\\longleftrightarrow$ folded structure (exothermic conformation collapse)\n  - Coulomb stablization of zwitterionic structures is analogous to the solvent effects governing DNA ionization ([DNAion1](#ion1) | [DNAion2](#ion2))\n- cyclohexane diester: \n  - adenine cation and radical moieties are located on the opposite sides of the cyclohexane ring \n  - attractive iondipole and ion-induced dipole interactions\n\n# [Hydrogen-Rich Cation Radicals of DNA Dinucleotides: Generation and Structure Elucidation by UVVis Action Spectroscopy](https://pubs.acs.org/doi/abs/10.1021/acs.jpcb.8b07925)\n\n- Why\n  - DNA ionization causes chemical changes leading to complex process of DNA damage; intermediates: DNA cation radicals\n  - the intrinsic electronic properties of the reactive cation radical intermediates just are elucidated recently\n  - without solvent and counterions, gas-phase studies can focus on the intrinsic electronic and chemical properties of the radical species ([ref](#ref))\n- Goal\n  - purine and pyrimidine nucleobases in dinucleotide cation radicals exhibit different properties: \n    - nucleobase stacking\n    - hydrogen bonds\n    - propensity for undergoing intramolecular proton transfer\n- Intro\n  - cation radical\n    - $(dGG+2H)^{+\\cdot}$: conform collapse, 3'-G C-8-H radical\n    - $(dCG+2H)^{+\\cdot}$: collapse, a mixture of 5'-C and 3'-G radicals\n    - $(dGC+2H)^{+\\cdot}$: retain structure, a 3'-C radical\n  -  basicity ($pK_a$) in water $\\Leftrightarrow$ ability of proton-transfer reactions in solution\n     -  $(G+H)^\\cdot$: 20.0\n     -  $(C+H)^\\cdot$: 4.6\n  \n## 1. Dinucleotide Cation Radical Generationf\n\n- larger oligos form stable cation radicals\n- smaller one needs DBCE\n\n## 2. Dinucleotide Cation Radical Collision-Induced Dis- sociation and Photodissociation Spectra\n\n- CID of cation radicals\n  - $(dGG+2H)^{+\\cdot}$: $[M-G]^{+\\cdot}$, $[M-G-H]^{+}$, $[d_1/w_1]^+$, $[d_1/w_1+H]^{+\\cdot}$\n  - $(dGC+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C]^{+\\cdot}$, $[M-G-H]^{+}$, $d^+$, $[w+2H]^+$, $[z_1+H]^{+\\cdot}$\n  - $(dCG+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C-H]^{+}$, $[M-C]^{+\\cdot}$, $w_1^+$\n- how nucleobase nature and position affect\n  - C at 3'-end $\\rightarrow$ elimination of water\n  - C at 5'-end $\\rightarrow$ lost as $[C+H]^\\cdot$\n  - loss of C > loss of G\n  - 5'-C suppresses 3'-G loss\n- UVPD similiar to CID\n- close shell systems have similiar absorption $\\rightarrow$ not only associated with radical moieties\n  \n## 3. $[dGG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\n\n- action spectra: 450-470nm, 330, 310 and 270nm\n- structure:\n  - H positon\n    - most basic: N-7\n    - 2nd basic: 6-OHN-3H\n  - CE at 5'-terminal stable than that at 3'\n  - H transfer\n    - exthothermic \n    - cation and radical at 5'-G most stable\n    - cation at 3'-G, radical at 5'-G relatively stable and match spectra\n- 450-460nm: SOMO, 156$\\alpha (\\pi)\\rightarrow$ combined $\\pi^*$ at 3'-G radical\n- $(G+H)^\\cdot$ estimates thermal shift and broadening\n- 215kJ/mol ($\\lambda$<550nm) enough to drive dissociation\n\n## 4. $[dCG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\n\n- action spectra: weak 450-480nm, strong 350 and 280nm\n- structure:\n  - cytosine: O-2 and N-3 basic positions\n  - CE at 5'-C ring and 3'-G ring\n  - H posiitons: dC3G7\n  - H transfer\n    - transition state high, but exthothermic finally (kinetic hampered)\n    - major: radical at C; minor at G\n    - RRKM calculation: 310kJ/mol internal energy needed for conversion\n    - $E_{int}=E_{thermal}+E_{exc}$, where $E_{exc}$ is part (calculated by heat capacity) of exthothermic reaction energy \n- dissociation of C or (C+H)$^\\cdot$ are less endothermic than G or (G+H)$^\\cdot$\n\n## 5. $[dGC+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\n\n- action spectra: extremely weak broad 620nm, 420-500nm and 360nm, strong 285nm\n- structure\n  - CE at 3'-C ring\n  - radical at C\n  - proton transfer exthothermic but not fit spectra \n  \n## 6. Discussion\n\n- site of electron attachment to the dications depends on\n  - nucleobase nature\n     C>G: *RE*$_{adiab}$*(C)*=5.17eV; *RE*$_{adiab}$*(G)*=4.46eV\n  - nucleobase position\n    dGG: 5'-G>3'-G\n- ring stacking and proton transfer\n  - dGG: nucleobase stacking, faciles proton transfer\n  - dGC and dCG: nucleobases perpenticular, kinetically hampered\n- $(G+H)^{+} (aq,pK_a=3.3)+(G+H)^\\cdot (aq) \\overset{\\Delta G=-95 kJ/mol}{\\longrightarrow} G(aq)+(G+2H)^{+\\cdot}(aq,pK_a\\approx20.0)$\n- $(C+H)^{+} (aq,pK_a=4.6)+(C+H)^\\cdot(aq) \\overset{\\Delta G=-0.1 kJ/mol}{\\rightleftharpoons} C(aq)+(C+2H)^{+\\cdot}(aq,pK_a\\approx4.6)$\n\n# [Watson-Crick Base Pair Radical Cation as a Model for Oxidative Damage in DNA](https://pubs.acs.org/doi/10.1021/acs.jpclett.7b01251)\n\n## Background\n- mechanisms of DNA damage poorly understood\n  - oxidation $\\rightarrow$ deprotonation at G $\\rightarrow$ H abstraction from sugar $\\rightarrow$ DNA strand breaks $\\rightarrow$ mutagenesis and cancer\n  - probing initially formed radical cation challengeing\n- proton-coupled electron and hole transfer is an important\nfeature in radiation damage process\n\n## Notes\n- gas-phase acidity data may be more appropriate to characterize the equilibrium position of the proton in oxidized GC base pairs ([ref](#gasbetter))\n- Guanine\n  1. the lowest ionization energy among GATC, both in solution and gas $\\Rightarrow$\n  2. electtron loss during ionization of DNA mostly occurs form G $\\rightarrow$\n  3. G radical cations enhaces acidities than G $\\Rightarrow$ \n  - dG$^{+\\cdot}$-dC pair: H transfer from G to C (G3$\\rightarrow$C3) $\\Rightarrow$ relocation of radical site to sugar\n- homolytic bond dissociation enthaloy of 401kJ/mol for [dG+H(N$_7$)]$^+$ is comparable to that for a typical C-H bond $\\Rightarrow$ other radicals via intra- or intermolecular H-abstraction reactions\n- CID\n  1. $[dGdC]^{+\\cdot}-CH_2O$: occurs on the sugar of G\n  2. further loss $C_2H_3O_2$\n  3. $[dGdC]^{+\\cdot}-C_5H_8O_3$ not nucleobase specific \n\n# [Gas-Phase Fragmentation of Oligonucleotide Ions](https://www.sciencedirect.com/science/article/pii/S1387380604003264?via%3Dihub)\n\n- The preferred dissociation channels for a given ion are a function of the ion type, the structure o fth emolecule, the internal energy distribution of the ion and the time-frame over which the fragmentation reactions can evolve\n- McLuckey's nomenclature for backbone cleavages (a/w,b/x,c/y,d/z, 5'-frag:a,b,c,d; 3'-frag: w,x,y,z)\n\n\n# <jump id=\"ap1\">[The Electronic Spectrum of Protonated Adenine: Theory and Experiment](https://pubs.rsc.org/en/content/articlelanding/2005/cp/b507422c/unauth#!divAbstract)</jump>\n\n\n# <jump id='ap2'>[Gas-phase spectroscopy of protonated adenine, adenosine 5-monophosphate and monohydrated ions](https://pubs.rsc.org/en/content/articlelanding/2013/cp/c3cp53742k/unauth#!divAbstract)</jump>\n\n# [Combining UV photodissociation action spectroscopy with electron transfer dissociation for structure analysis of gasphase peptide cationradicals](https://onlinelibrary.wiley.com/doi/full/10.1002/jms.3717)\n\n# <jump id='l1'>[Distonic Isomers and Tautomers of Adenine Cation Radical in the Gas Phase and Aqueous Solution](https://pubs.acs.org/doi/10.1021/jp046575q)</jump>\n\n# <jump id='l2'>[Adenine Radicals in the Gas Phase. An Experimental and Computational Study of Hydrogen Atom Adducts to Adenine](https://pubs.acs.org/doi/abs/10.1021/jp0529725)</jump>\n\n# [Dependence of Spurious Charge- Transfer Excited States on Orbital Exchange in TDDFT: Large Molecules and Clusters](https://pubs.acs.org/doi/10.1021/ct600282k)\n\n# <jump id='ion1'>[Electron Detachment Energies and Isomerism in Purinic Deoxyribonucleotides](https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.21330)</jump>\n\n# <jump id='ion2'>[Ab Initio Electron Propagator Methods: Applications to Nucleic Acids Fragments and Metallophthalocyanines.](https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.22836)</jump>\n\n# [Ion/Ion Reactions: New Chemistry for Analytical MS](https://pubs.acs.org/doi/abs/10.1021/ac9014935)\n\n# [Base Pair Radical Cation as a Model for Oxidative Damage in DNA](https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01251)\n\n# [One-Electron Oxidation of DNA Oligomers That Lack Guanine: Reaction and Strand Cleavage at Remote Thymines by Long-Distance Radical Cation Hopping](https://pubs.acs.org/doi/abs/10.1021/ja058758b)\n\n# <jump id=\"ref\">[Transient Intermediates of Chemical Reactions by NeutralizationReionization Mass Spectrometry](https://link.springer.com/chapter/10.1007/3-540-36113-8_3)</jump>\n\n# [Irreversible Electron Attachment - A Key to DNA Damage by Solvated Electrons in Aqueous Solution](https://pubs.rsc.org/en/content/articlelanding/2015/ob/c5ob01542a#!divAbstract)\n\n# [What Hinders Electron Transfer Dissociation (ETD) of DNA Cations?](https://link.springer.com/article/10.1007%2Fs13361-017-1791-z)\n\n# [Proton and hydrogen atom adducts to cytosine. An experimental and computational study](https://www.sciencedirect.com/science/article/pii/S1387380607000279)\n\n# [Toward True DNA Base-Stacking Energies: MP2, CCSD(T), and Complete Basis Set Calculations](https://pubs.acs.org/doi/10.1021/ja026759n)\n\n# [Purine bases, nucleosides, and nucleotides: aqueous solution redox chemistry and transformation reactions of their radical cations and e- and OH adducts](https://pubs.acs.org/doi/10.1021/cr00093a003)\n\n# [Proton-coupled Electron Transfer in DNA on Formation of Radiation-produced Ion Radicals](http://pubs.acs.org/doi/abs/10.1021/cr100023g)\n\n# [Induction of Strand Breaks in Single-stranded Polyribonucleotides and DNA by Photoionization: One Electron Oxidized Nucleobase Radicals as Precursors](https://pubs.acs.org/doi/abs/10.1021/ja961722m)\n\n# [How Easily Oxidizable is DNA? One-electron Reduction Potentials of Adenosine and Guanosine Radicals in Aqueous Solution](https://pubs.acs.org/doi/10.1021/ja962255b)\n\n# <jump id='gasbetter'>[Structure and Acid-base Properties of One-electron-oxidized Deoxyguanosine, Guanosine, and 1-Methylguanosine](https://pubs.acs.org/doi/10.1021/ja00185a046)</jump>","source":"_posts/Nucleotide-Papers.md","raw":"---\ntitle: Nucleotide Papers\ndate: 2019-01-02 15:30:51\ntags:\n- nucleotide\n- pubNote\ncategories:\n- NoteBook\n---\n\n ***Keyword***\n  \n adenine |  cation radical |  cytosine | electron attachment | guanine | nucleotide | proton transfer | spectra | thymine |\n\n\n# [UVVis Action Spectroscopy Reveals a Conformational Collapse in Hydrogen-Rich Dinucleotide Cation Radicals](https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01856)\n\n- Why\n  - DNA cation radicals are intermediates during the interaction of DNA with high energy particles\n  - electron defect initially located in a nucleobase, migrates along the DNA backbone to reside on guanine\n  - DNA behavior at atomic-level needed\n- Goal\n  - proton and electron transfer along a single strand in DNA and related cation radicals\n  - use deoxyriboadenosine dinucleotide (dAA) and riboadenosine chimeras (pseudo-dAA)\n- Intro\n  - dication$\\rightarrow$catrad: conformation collapse\n  - dAA\n    - intra proton migrations btw nucleobases\n  - pseudo-dAA-catrad\n    - zwitterionic structures\n    - Coulomb stablization\n  \n## 1. Gaseous Protonated A\n\n- N-1, N-3, N- 7, N-9, and NH2 (N-10) positions: potential protonation sites\n- dA: N-3\n  - H bond stablization\n- dAA: N-1, N-1''\n- psedo-dAA: N-3, N-3''\n  - H bond stablization\n\n## 2. Form Cation Radicals\n\n- ETD dAA+2$H^+$: $[M-H]^+(m/z\\ 565)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$, $w^+(m/z\\  332)$\n- M+CE/DBCE$\\rightarrow$ESI$\\rightarrow$ETD: $M^{+\\cdot}$\n- CE favors N-1 position\n\n## 3. UV-Vis Action Spectrum \n\n- vis: broad band at 465nm; uv: 340nm, 260nm \n- channel: $w^+(m/z\\ 332)$, $[w+H]^{+\\cdot}(m/z\\ 333)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$\n- 260nm is same with [pccp_adenine1](#ap1) and [pccp_adenine2](#ap2)\n\n## 4. Dinucleotide Cation Radical Structures\n\n- if exothermic, isomerization driven by proton migrations will occur sponstaneously and driven by exotherimic energy provided by the electron attachment reaction. \n- electron not attach N-1\n- hydrogen migration might face substantial energy barrier. [[A+H1](#l1) | [A+H2](#l2)]\n- proton transfer (move radical position)$\\rightarrow$optimize$\\rightarrow$ more stable structures\n- theoritical uvvis spectra and molecular orbital analysis $\\rightarrow$ possible tautomers & spectra contributions $\\pi_z \\rightarrow \\pi_z^*$\n\n## 5. Adenine Ribonucleotide Chimeras\n\n- uv-vis analysis: similiar band position to dAA \n- aromatic diesters\n  - opt: zwitterionic dication-anion radicals $\\longleftrightarrow$ folded structure (exothermic conformation collapse)\n  - Coulomb stablization of zwitterionic structures is analogous to the solvent effects governing DNA ionization ([DNAion1](#ion1) | [DNAion2](#ion2))\n- cyclohexane diester: \n  - adenine cation and radical moieties are located on the opposite sides of the cyclohexane ring \n  - attractive iondipole and ion-induced dipole interactions\n\n# [Hydrogen-Rich Cation Radicals of DNA Dinucleotides: Generation and Structure Elucidation by UVVis Action Spectroscopy](https://pubs.acs.org/doi/abs/10.1021/acs.jpcb.8b07925)\n\n- Why\n  - DNA ionization causes chemical changes leading to complex process of DNA damage; intermediates: DNA cation radicals\n  - the intrinsic electronic properties of the reactive cation radical intermediates just are elucidated recently\n  - without solvent and counterions, gas-phase studies can focus on the intrinsic electronic and chemical properties of the radical species ([ref](#ref))\n- Goal\n  - purine and pyrimidine nucleobases in dinucleotide cation radicals exhibit different properties: \n    - nucleobase stacking\n    - hydrogen bonds\n    - propensity for undergoing intramolecular proton transfer\n- Intro\n  - cation radical\n    - $(dGG+2H)^{+\\cdot}$: conform collapse, 3'-G C-8-H radical\n    - $(dCG+2H)^{+\\cdot}$: collapse, a mixture of 5'-C and 3'-G radicals\n    - $(dGC+2H)^{+\\cdot}$: retain structure, a 3'-C radical\n  -  basicity ($pK_a$) in water $\\Leftrightarrow$ ability of proton-transfer reactions in solution\n     -  $(G+H)^\\cdot$: 20.0\n     -  $(C+H)^\\cdot$: 4.6\n  \n## 1. Dinucleotide Cation Radical Generationf\n\n- larger oligos form stable cation radicals\n- smaller one needs DBCE\n\n## 2. Dinucleotide Cation Radical Collision-Induced Dis- sociation and Photodissociation Spectra\n\n- CID of cation radicals\n  - $(dGG+2H)^{+\\cdot}$: $[M-G]^{+\\cdot}$, $[M-G-H]^{+}$, $[d_1/w_1]^+$, $[d_1/w_1+H]^{+\\cdot}$\n  - $(dGC+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C]^{+\\cdot}$, $[M-G-H]^{+}$, $d^+$, $[w+2H]^+$, $[z_1+H]^{+\\cdot}$\n  - $(dCG+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C-H]^{+}$, $[M-C]^{+\\cdot}$, $w_1^+$\n- how nucleobase nature and position affect\n  - C at 3'-end $\\rightarrow$ elimination of water\n  - C at 5'-end $\\rightarrow$ lost as $[C+H]^\\cdot$\n  - loss of C > loss of G\n  - 5'-C suppresses 3'-G loss\n- UVPD similiar to CID\n- close shell systems have similiar absorption $\\rightarrow$ not only associated with radical moieties\n  \n## 3. $[dGG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\n\n- action spectra: 450-470nm, 330, 310 and 270nm\n- structure:\n  - H positon\n    - most basic: N-7\n    - 2nd basic: 6-OHN-3H\n  - CE at 5'-terminal stable than that at 3'\n  - H transfer\n    - exthothermic \n    - cation and radical at 5'-G most stable\n    - cation at 3'-G, radical at 5'-G relatively stable and match spectra\n- 450-460nm: SOMO, 156$\\alpha (\\pi)\\rightarrow$ combined $\\pi^*$ at 3'-G radical\n- $(G+H)^\\cdot$ estimates thermal shift and broadening\n- 215kJ/mol ($\\lambda$<550nm) enough to drive dissociation\n\n## 4. $[dCG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\n\n- action spectra: weak 450-480nm, strong 350 and 280nm\n- structure:\n  - cytosine: O-2 and N-3 basic positions\n  - CE at 5'-C ring and 3'-G ring\n  - H posiitons: dC3G7\n  - H transfer\n    - transition state high, but exthothermic finally (kinetic hampered)\n    - major: radical at C; minor at G\n    - RRKM calculation: 310kJ/mol internal energy needed for conversion\n    - $E_{int}=E_{thermal}+E_{exc}$, where $E_{exc}$ is part (calculated by heat capacity) of exthothermic reaction energy \n- dissociation of C or (C+H)$^\\cdot$ are less endothermic than G or (G+H)$^\\cdot$\n\n## 5. $[dGC+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\n\n- action spectra: extremely weak broad 620nm, 420-500nm and 360nm, strong 285nm\n- structure\n  - CE at 3'-C ring\n  - radical at C\n  - proton transfer exthothermic but not fit spectra \n  \n## 6. Discussion\n\n- site of electron attachment to the dications depends on\n  - nucleobase nature\n     C>G: *RE*$_{adiab}$*(C)*=5.17eV; *RE*$_{adiab}$*(G)*=4.46eV\n  - nucleobase position\n    dGG: 5'-G>3'-G\n- ring stacking and proton transfer\n  - dGG: nucleobase stacking, faciles proton transfer\n  - dGC and dCG: nucleobases perpenticular, kinetically hampered\n- $(G+H)^{+} (aq,pK_a=3.3)+(G+H)^\\cdot (aq) \\overset{\\Delta G=-95 kJ/mol}{\\longrightarrow} G(aq)+(G+2H)^{+\\cdot}(aq,pK_a\\approx20.0)$\n- $(C+H)^{+} (aq,pK_a=4.6)+(C+H)^\\cdot(aq) \\overset{\\Delta G=-0.1 kJ/mol}{\\rightleftharpoons} C(aq)+(C+2H)^{+\\cdot}(aq,pK_a\\approx4.6)$\n\n# [Watson-Crick Base Pair Radical Cation as a Model for Oxidative Damage in DNA](https://pubs.acs.org/doi/10.1021/acs.jpclett.7b01251)\n\n## Background\n- mechanisms of DNA damage poorly understood\n  - oxidation $\\rightarrow$ deprotonation at G $\\rightarrow$ H abstraction from sugar $\\rightarrow$ DNA strand breaks $\\rightarrow$ mutagenesis and cancer\n  - probing initially formed radical cation challengeing\n- proton-coupled electron and hole transfer is an important\nfeature in radiation damage process\n\n## Notes\n- gas-phase acidity data may be more appropriate to characterize the equilibrium position of the proton in oxidized GC base pairs ([ref](#gasbetter))\n- Guanine\n  1. the lowest ionization energy among GATC, both in solution and gas $\\Rightarrow$\n  2. electtron loss during ionization of DNA mostly occurs form G $\\rightarrow$\n  3. G radical cations enhaces acidities than G $\\Rightarrow$ \n  - dG$^{+\\cdot}$-dC pair: H transfer from G to C (G3$\\rightarrow$C3) $\\Rightarrow$ relocation of radical site to sugar\n- homolytic bond dissociation enthaloy of 401kJ/mol for [dG+H(N$_7$)]$^+$ is comparable to that for a typical C-H bond $\\Rightarrow$ other radicals via intra- or intermolecular H-abstraction reactions\n- CID\n  1. $[dGdC]^{+\\cdot}-CH_2O$: occurs on the sugar of G\n  2. further loss $C_2H_3O_2$\n  3. $[dGdC]^{+\\cdot}-C_5H_8O_3$ not nucleobase specific \n\n# [Gas-Phase Fragmentation of Oligonucleotide Ions](https://www.sciencedirect.com/science/article/pii/S1387380604003264?via%3Dihub)\n\n- The preferred dissociation channels for a given ion are a function of the ion type, the structure o fth emolecule, the internal energy distribution of the ion and the time-frame over which the fragmentation reactions can evolve\n- McLuckey's nomenclature for backbone cleavages (a/w,b/x,c/y,d/z, 5'-frag:a,b,c,d; 3'-frag: w,x,y,z)\n\n\n# <jump id=\"ap1\">[The Electronic Spectrum of Protonated Adenine: Theory and Experiment](https://pubs.rsc.org/en/content/articlelanding/2005/cp/b507422c/unauth#!divAbstract)</jump>\n\n\n# <jump id='ap2'>[Gas-phase spectroscopy of protonated adenine, adenosine 5-monophosphate and monohydrated ions](https://pubs.rsc.org/en/content/articlelanding/2013/cp/c3cp53742k/unauth#!divAbstract)</jump>\n\n# [Combining UV photodissociation action spectroscopy with electron transfer dissociation for structure analysis of gasphase peptide cationradicals](https://onlinelibrary.wiley.com/doi/full/10.1002/jms.3717)\n\n# <jump id='l1'>[Distonic Isomers and Tautomers of Adenine Cation Radical in the Gas Phase and Aqueous Solution](https://pubs.acs.org/doi/10.1021/jp046575q)</jump>\n\n# <jump id='l2'>[Adenine Radicals in the Gas Phase. An Experimental and Computational Study of Hydrogen Atom Adducts to Adenine](https://pubs.acs.org/doi/abs/10.1021/jp0529725)</jump>\n\n# [Dependence of Spurious Charge- Transfer Excited States on Orbital Exchange in TDDFT: Large Molecules and Clusters](https://pubs.acs.org/doi/10.1021/ct600282k)\n\n# <jump id='ion1'>[Electron Detachment Energies and Isomerism in Purinic Deoxyribonucleotides](https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.21330)</jump>\n\n# <jump id='ion2'>[Ab Initio Electron Propagator Methods: Applications to Nucleic Acids Fragments and Metallophthalocyanines.](https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.22836)</jump>\n\n# [Ion/Ion Reactions: New Chemistry for Analytical MS](https://pubs.acs.org/doi/abs/10.1021/ac9014935)\n\n# [Base Pair Radical Cation as a Model for Oxidative Damage in DNA](https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01251)\n\n# [One-Electron Oxidation of DNA Oligomers That Lack Guanine: Reaction and Strand Cleavage at Remote Thymines by Long-Distance Radical Cation Hopping](https://pubs.acs.org/doi/abs/10.1021/ja058758b)\n\n# <jump id=\"ref\">[Transient Intermediates of Chemical Reactions by NeutralizationReionization Mass Spectrometry](https://link.springer.com/chapter/10.1007/3-540-36113-8_3)</jump>\n\n# [Irreversible Electron Attachment - A Key to DNA Damage by Solvated Electrons in Aqueous Solution](https://pubs.rsc.org/en/content/articlelanding/2015/ob/c5ob01542a#!divAbstract)\n\n# [What Hinders Electron Transfer Dissociation (ETD) of DNA Cations?](https://link.springer.com/article/10.1007%2Fs13361-017-1791-z)\n\n# [Proton and hydrogen atom adducts to cytosine. An experimental and computational study](https://www.sciencedirect.com/science/article/pii/S1387380607000279)\n\n# [Toward True DNA Base-Stacking Energies: MP2, CCSD(T), and Complete Basis Set Calculations](https://pubs.acs.org/doi/10.1021/ja026759n)\n\n# [Purine bases, nucleosides, and nucleotides: aqueous solution redox chemistry and transformation reactions of their radical cations and e- and OH adducts](https://pubs.acs.org/doi/10.1021/cr00093a003)\n\n# [Proton-coupled Electron Transfer in DNA on Formation of Radiation-produced Ion Radicals](http://pubs.acs.org/doi/abs/10.1021/cr100023g)\n\n# [Induction of Strand Breaks in Single-stranded Polyribonucleotides and DNA by Photoionization: One Electron Oxidized Nucleobase Radicals as Precursors](https://pubs.acs.org/doi/abs/10.1021/ja961722m)\n\n# [How Easily Oxidizable is DNA? One-electron Reduction Potentials of Adenosine and Guanosine Radicals in Aqueous Solution](https://pubs.acs.org/doi/10.1021/ja962255b)\n\n# <jump id='gasbetter'>[Structure and Acid-base Properties of One-electron-oxidized Deoxyguanosine, Guanosine, and 1-Methylguanosine](https://pubs.acs.org/doi/10.1021/ja00185a046)</jump>","slug":"Nucleotide-Papers","published":1,"updated":"2019-01-09T00:24:34.831Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjqojihq4000hp45kvwepg5u7","content":"<p> <strong><em>Keyword</em></strong></p>\n<p> adenine |  cation radical |  cytosine | electron attachment | guanine | nucleotide | proton transfer | spectra | thymine |</p>\n<h1 id=\"UVVis-Action-Spectroscopy-Reveals-a-Conformational-Collapse-in-Hydrogen-Rich-Dinucleotide-Cation-Radicals\"><a href=\"#UVVis-Action-Spectroscopy-Reveals-a-Conformational-Collapse-in-Hydrogen-Rich-Dinucleotide-Cation-Radicals\" class=\"headerlink\" title=\"UVVis Action Spectroscopy Reveals a Conformational Collapse in Hydrogen-Rich Dinucleotide Cation Radicals\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01856\" target=\"_blank\" rel=\"noopener\">UVVis Action Spectroscopy Reveals a Conformational Collapse in Hydrogen-Rich Dinucleotide Cation Radicals</a></h1><ul>\n<li>Why<ul>\n<li>DNA cation radicals are intermediates during the interaction of DNA with high energy particles</li>\n<li>electron defect initially located in a nucleobase, migrates along the DNA backbone to reside on guanine</li>\n<li>DNA behavior at atomic-level needed</li>\n</ul>\n</li>\n<li>Goal<ul>\n<li>proton and electron transfer along a single strand in DNA and related cation radicals</li>\n<li>use deoxyriboadenosine dinucleotide (dAA) and riboadenosine chimeras (pseudo-dAA)</li>\n</ul>\n</li>\n<li>Intro<ul>\n<li>dication$\\rightarrow$catrad: conformation collapse</li>\n<li>dAA<ul>\n<li>intra proton migrations btw nucleobases</li>\n</ul>\n</li>\n<li>pseudo-dAA-catrad<ul>\n<li>zwitterionic structures</li>\n<li>Coulomb stablization</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-Gaseous-Protonated-A\"><a href=\"#1-Gaseous-Protonated-A\" class=\"headerlink\" title=\"1. Gaseous Protonated A\"></a>1. Gaseous Protonated A</h2><ul>\n<li>N-1, N-3, N- 7, N-9, and NH2 (N-10) positions: potential protonation sites</li>\n<li>dA: N-3<ul>\n<li>H bond stablization</li>\n</ul>\n</li>\n<li>dAA: N-1, N-1</li>\n<li>psedo-dAA: N-3, N-3<ul>\n<li>H bond stablization</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-Form-Cation-Radicals\"><a href=\"#2-Form-Cation-Radicals\" class=\"headerlink\" title=\"2. Form Cation Radicals\"></a>2. Form Cation Radicals</h2><ul>\n<li>ETD dAA+2$H^+$: $[M-H]^+(m/z\\ 565)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$, $w^+(m/z\\  332)$</li>\n<li>M+CE/DBCE$\\rightarrow$ESI$\\rightarrow$ETD: $M^{+\\cdot}$</li>\n<li>CE favors N-1 position</li>\n</ul>\n<h2 id=\"3-UV-Vis-Action-Spectrum\"><a href=\"#3-UV-Vis-Action-Spectrum\" class=\"headerlink\" title=\"3. UV-Vis Action Spectrum\"></a>3. UV-Vis Action Spectrum</h2><ul>\n<li>vis: broad band at 465nm; uv: 340nm, 260nm </li>\n<li>channel: $w^+(m/z\\ 332)$, $[w+H]^{+\\cdot}(m/z\\ 333)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$</li>\n<li>260nm is same with <a href=\"#ap1\">pccp_adenine1</a> and <a href=\"#ap2\">pccp_adenine2</a></li>\n</ul>\n<h2 id=\"4-Dinucleotide-Cation-Radical-Structures\"><a href=\"#4-Dinucleotide-Cation-Radical-Structures\" class=\"headerlink\" title=\"4. Dinucleotide Cation Radical Structures\"></a>4. Dinucleotide Cation Radical Structures</h2><ul>\n<li>if exothermic, isomerization driven by proton migrations will occur sponstaneously and driven by exotherimic energy provided by the electron attachment reaction. </li>\n<li>electron not attach N-1</li>\n<li>hydrogen migration might face substantial energy barrier. [<a href=\"#l1\">A+H1</a> | <a href=\"#l2\">A+H2</a>]</li>\n<li>proton transfer (move radical position)$\\rightarrow$optimize$\\rightarrow$ more stable structures</li>\n<li>theoritical uvvis spectra and molecular orbital analysis $\\rightarrow$ possible tautomers &amp; spectra contributions $\\pi_z \\rightarrow \\pi_z^*$</li>\n</ul>\n<h2 id=\"5-Adenine-Ribonucleotide-Chimeras\"><a href=\"#5-Adenine-Ribonucleotide-Chimeras\" class=\"headerlink\" title=\"5. Adenine Ribonucleotide Chimeras\"></a>5. Adenine Ribonucleotide Chimeras</h2><ul>\n<li>uv-vis analysis: similiar band position to dAA </li>\n<li>aromatic diesters<ul>\n<li>opt: zwitterionic dication-anion radicals $\\longleftrightarrow$ folded structure (exothermic conformation collapse)</li>\n<li>Coulomb stablization of zwitterionic structures is analogous to the solvent effects governing DNA ionization (<a href=\"#ion1\">DNAion1</a> | <a href=\"#ion2\">DNAion2</a>)</li>\n</ul>\n</li>\n<li>cyclohexane diester: <ul>\n<li>adenine cation and radical moieties are located on the opposite sides of the cyclohexane ring </li>\n<li>attractive iondipole and ion-induced dipole interactions</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Hydrogen-Rich-Cation-Radicals-of-DNA-Dinucleotides-Generation-and-Structure-Elucidation-by-UVVis-Action-Spectroscopy\"><a href=\"#Hydrogen-Rich-Cation-Radicals-of-DNA-Dinucleotides-Generation-and-Structure-Elucidation-by-UVVis-Action-Spectroscopy\" class=\"headerlink\" title=\"Hydrogen-Rich Cation Radicals of DNA Dinucleotides: Generation and Structure Elucidation by UVVis Action Spectroscopy\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/acs.jpcb.8b07925\" target=\"_blank\" rel=\"noopener\">Hydrogen-Rich Cation Radicals of DNA Dinucleotides: Generation and Structure Elucidation by UVVis Action Spectroscopy</a></h1><ul>\n<li>Why<ul>\n<li>DNA ionization causes chemical changes leading to complex process of DNA damage; intermediates: DNA cation radicals</li>\n<li>the intrinsic electronic properties of the reactive cation radical intermediates just are elucidated recently</li>\n<li>without solvent and counterions, gas-phase studies can focus on the intrinsic electronic and chemical properties of the radical species (<a href=\"#ref\">ref</a>)</li>\n</ul>\n</li>\n<li>Goal<ul>\n<li>purine and pyrimidine nucleobases in dinucleotide cation radicals exhibit different properties: <ul>\n<li>nucleobase stacking</li>\n<li>hydrogen bonds</li>\n<li>propensity for undergoing intramolecular proton transfer</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Intro<ul>\n<li>cation radical<ul>\n<li>$(dGG+2H)^{+\\cdot}$: conform collapse, 3-G C-8-H radical</li>\n<li>$(dCG+2H)^{+\\cdot}$: collapse, a mixture of 5-C and 3-G radicals</li>\n<li>$(dGC+2H)^{+\\cdot}$: retain structure, a 3-C radical</li>\n</ul>\n</li>\n<li>basicity ($pK_a$) in water $\\Leftrightarrow$ ability of proton-transfer reactions in solution<ul>\n<li>$(G+H)^\\cdot$: 20.0</li>\n<li>$(C+H)^\\cdot$: 4.6</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-Dinucleotide-Cation-Radical-Generationf\"><a href=\"#1-Dinucleotide-Cation-Radical-Generationf\" class=\"headerlink\" title=\"1. Dinucleotide Cation Radical Generationf\"></a>1. Dinucleotide Cation Radical Generationf</h2><ul>\n<li>larger oligos form stable cation radicals</li>\n<li>smaller one needs DBCE</li>\n</ul>\n<h2 id=\"2-Dinucleotide-Cation-Radical-Collision-Induced-Dis-sociation-and-Photodissociation-Spectra\"><a href=\"#2-Dinucleotide-Cation-Radical-Collision-Induced-Dis-sociation-and-Photodissociation-Spectra\" class=\"headerlink\" title=\"2. Dinucleotide Cation Radical Collision-Induced Dis- sociation and Photodissociation Spectra\"></a>2. Dinucleotide Cation Radical Collision-Induced Dis- sociation and Photodissociation Spectra</h2><ul>\n<li>CID of cation radicals<ul>\n<li>$(dGG+2H)^{+\\cdot}$: $[M-G]^{+\\cdot}$, $[M-G-H]^{+}$, $[d_1/w_1]^+$, $[d_1/w_1+H]^{+\\cdot}$</li>\n<li>$(dGC+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C]^{+\\cdot}$, $[M-G-H]^{+}$, $d^+$, $[w+2H]^+$, $[z_1+H]^{+\\cdot}$</li>\n<li>$(dCG+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C-H]^{+}$, $[M-C]^{+\\cdot}$, $w_1^+$</li>\n</ul>\n</li>\n<li>how nucleobase nature and position affect<ul>\n<li>C at 3-end $\\rightarrow$ elimination of water</li>\n<li>C at 5-end $\\rightarrow$ lost as $[C+H]^\\cdot$</li>\n<li>loss of C &gt; loss of G</li>\n<li>5-C suppresses 3-G loss</li>\n</ul>\n</li>\n<li>UVPD similiar to CID</li>\n<li>close shell systems have similiar absorption $\\rightarrow$ not only associated with radical moieties</li>\n</ul>\n<h2 id=\"3-dGG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\"><a href=\"#3-dGG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\" class=\"headerlink\" title=\"3. $[dGG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\"></a>3. $[dGG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures</h2><ul>\n<li>action spectra: 450-470nm, 330, 310 and 270nm</li>\n<li>structure:<ul>\n<li>H positon<ul>\n<li>most basic: N-7</li>\n<li>2nd basic: 6-OHN-3H</li>\n</ul>\n</li>\n<li>CE at 5-terminal stable than that at 3</li>\n<li>H transfer<ul>\n<li>exthothermic </li>\n<li>cation and radical at 5-G most stable</li>\n<li>cation at 3-G, radical at 5-G relatively stable and match spectra</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>450-460nm: SOMO, 156$\\alpha (\\pi)\\rightarrow$ combined $\\pi^*$ at 3-G radical</li>\n<li>$(G+H)^\\cdot$ estimates thermal shift and broadening</li>\n<li>215kJ/mol ($\\lambda$&lt;550nm) enough to drive dissociation</li>\n</ul>\n<h2 id=\"4-dCG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\"><a href=\"#4-dCG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\" class=\"headerlink\" title=\"4. $[dCG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\"></a>4. $[dCG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures</h2><ul>\n<li>action spectra: weak 450-480nm, strong 350 and 280nm</li>\n<li>structure:<ul>\n<li>cytosine: O-2 and N-3 basic positions</li>\n<li>CE at 5-C ring and 3-G ring</li>\n<li>H posiitons: dC3G7</li>\n<li>H transfer<ul>\n<li>transition state high, but exthothermic finally (kinetic hampered)</li>\n<li>major: radical at C; minor at G</li>\n<li>RRKM calculation: 310kJ/mol internal energy needed for conversion</li>\n<li>$E_{int}=E_{thermal}+E_{exc}$, where $E_{exc}$ is part (calculated by heat capacity) of exthothermic reaction energy </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>dissociation of C or (C+H)$^\\cdot$ are less endothermic than G or (G+H)$^\\cdot$</li>\n</ul>\n<h2 id=\"5-dGC-2H-cdot-Action-Spectroscopy-and-Ion-Structures\"><a href=\"#5-dGC-2H-cdot-Action-Spectroscopy-and-Ion-Structures\" class=\"headerlink\" title=\"5. $[dGC+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\"></a>5. $[dGC+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures</h2><ul>\n<li>action spectra: extremely weak broad 620nm, 420-500nm and 360nm, strong 285nm</li>\n<li>structure<ul>\n<li>CE at 3-C ring</li>\n<li>radical at C</li>\n<li>proton transfer exthothermic but not fit spectra </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"6-Discussion\"><a href=\"#6-Discussion\" class=\"headerlink\" title=\"6. Discussion\"></a>6. Discussion</h2><ul>\n<li>site of electron attachment to the dications depends on<ul>\n<li>nucleobase nature<br> C&gt;G: <em>RE</em>$<em>{adiab}$<em>(C)</em>=5.17eV; <em>RE</em>$</em>{adiab}$<em>(G)</em>=4.46eV</li>\n<li>nucleobase position<br>dGG: 5-G&gt;3-G</li>\n</ul>\n</li>\n<li>ring stacking and proton transfer<ul>\n<li>dGG: nucleobase stacking, faciles proton transfer</li>\n<li>dGC and dCG: nucleobases perpenticular, kinetically hampered</li>\n</ul>\n</li>\n<li>$(G+H)^{+} (aq,pK_a=3.3)+(G+H)^\\cdot (aq) \\overset{\\Delta G=-95 kJ/mol}{\\longrightarrow} G(aq)+(G+2H)^{+\\cdot}(aq,pK_a\\approx20.0)$</li>\n<li>$(C+H)^{+} (aq,pK_a=4.6)+(C+H)^\\cdot(aq) \\overset{\\Delta G=-0.1 kJ/mol}{\\rightleftharpoons} C(aq)+(C+2H)^{+\\cdot}(aq,pK_a\\approx4.6)$</li>\n</ul>\n<h1 id=\"Watson-Crick-Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\"><a href=\"#Watson-Crick-Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\" class=\"headerlink\" title=\"Watson-Crick Base Pair Radical Cation as a Model for Oxidative Damage in DNA\"></a><a href=\"https://pubs.acs.org/doi/10.1021/acs.jpclett.7b01251\" target=\"_blank\" rel=\"noopener\">Watson-Crick Base Pair Radical Cation as a Model for Oxidative Damage in DNA</a></h1><h2 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h2><ul>\n<li>mechanisms of DNA damage poorly understood<ul>\n<li>oxidation $\\rightarrow$ deprotonation at G $\\rightarrow$ H abstraction from sugar $\\rightarrow$ DNA strand breaks $\\rightarrow$ mutagenesis and cancer</li>\n<li>probing initially formed radical cation challengeing</li>\n</ul>\n</li>\n<li>proton-coupled electron and hole transfer is an important<br>feature in radiation damage process</li>\n</ul>\n<h2 id=\"Notes\"><a href=\"#Notes\" class=\"headerlink\" title=\"Notes\"></a>Notes</h2><ul>\n<li>gas-phase acidity data may be more appropriate to characterize the equilibrium position of the proton in oxidized GC base pairs (<a href=\"#gasbetter\">ref</a>)</li>\n<li>Guanine<ol>\n<li>the lowest ionization energy among GATC, both in solution and gas $\\Rightarrow$</li>\n<li>electtron loss during ionization of DNA mostly occurs form G $\\rightarrow$</li>\n<li>G radical cations enhaces acidities than G $\\Rightarrow$ </li>\n</ol>\n<ul>\n<li>dG$^{+\\cdot}$-dC pair: H transfer from G to C (G3$\\rightarrow$C3) $\\Rightarrow$ relocation of radical site to sugar</li>\n</ul>\n</li>\n<li>homolytic bond dissociation enthaloy of 401kJ/mol for [dG+H(N$_7$)]$^+$ is comparable to that for a typical C-H bond $\\Rightarrow$ other radicals via intra- or intermolecular H-abstraction reactions</li>\n<li>CID<ol>\n<li>$[dGdC]^{+\\cdot}-CH_2O$: occurs on the sugar of G</li>\n<li>further loss $C_2H_3O_2$</li>\n<li>$[dGdC]^{+\\cdot}-C_5H_8O_3$ not nucleobase specific </li>\n</ol>\n</li>\n</ul>\n<h1 id=\"Gas-Phase-Fragmentation-of-Oligonucleotide-Ions\"><a href=\"#Gas-Phase-Fragmentation-of-Oligonucleotide-Ions\" class=\"headerlink\" title=\"Gas-Phase Fragmentation of Oligonucleotide Ions\"></a><a href=\"https://www.sciencedirect.com/science/article/pii/S1387380604003264?via%3Dihub\" target=\"_blank\" rel=\"noopener\">Gas-Phase Fragmentation of Oligonucleotide Ions</a></h1><ul>\n<li>The preferred dissociation channels for a given ion are a function of the ion type, the structure o fth emolecule, the internal energy distribution of the ion and the time-frame over which the fragmentation reactions can evolve</li>\n<li>McLuckeys nomenclature for backbone cleavages (a/w,b/x,c/y,d/z, 5-frag:a,b,c,d; 3-frag: w,x,y,z)</li>\n</ul>\n<h1 id=\"The-Electronic-Spectrum-of-Protonated-Adenine-Theory-and-Experiment\"><a href=\"#The-Electronic-Spectrum-of-Protonated-Adenine-Theory-and-Experiment\" class=\"headerlink\" title=\"The Electronic Spectrum of Protonated Adenine: Theory and Experiment\"></a><jump id=\"ap1\"><a href=\"https://pubs.rsc.org/en/content/articlelanding/2005/cp/b507422c/unauth#!divAbstract\" target=\"_blank\" rel=\"noopener\">The Electronic Spectrum of Protonated Adenine: Theory and Experiment</a></jump></h1><h1 id=\"Gas-phase-spectroscopy-of-protonated-adenine-adenosine-5-monophosphate-and-monohydrated-ions\"><a href=\"#Gas-phase-spectroscopy-of-protonated-adenine-adenosine-5-monophosphate-and-monohydrated-ions\" class=\"headerlink\" title=\"Gas-phase spectroscopy of protonated adenine, adenosine 5-monophosphate and monohydrated ions\"></a><jump id=\"ap2\"><a href=\"https://pubs.rsc.org/en/content/articlelanding/2013/cp/c3cp53742k/unauth#!divAbstract\" target=\"_blank\" rel=\"noopener\">Gas-phase spectroscopy of protonated adenine, adenosine 5-monophosphate and monohydrated ions</a></jump></h1><h1 id=\"Combining-UV-photodissociation-action-spectroscopy-with-electron-transfer-dissociation-for-structure-analysis-of-gasphase-peptide-cationradicals\"><a href=\"#Combining-UV-photodissociation-action-spectroscopy-with-electron-transfer-dissociation-for-structure-analysis-of-gasphase-peptide-cationradicals\" class=\"headerlink\" title=\"Combining UV photodissociation action spectroscopy with electron transfer dissociation for structure analysis of gasphase peptide cationradicals\"></a><a href=\"https://onlinelibrary.wiley.com/doi/full/10.1002/jms.3717\" target=\"_blank\" rel=\"noopener\">Combining UV photodissociation action spectroscopy with electron transfer dissociation for structure analysis of gasphase peptide cationradicals</a></h1><h1 id=\"Distonic-Isomers-and-Tautomers-of-Adenine-Cation-Radical-in-the-Gas-Phase-and-Aqueous-Solution\"><a href=\"#Distonic-Isomers-and-Tautomers-of-Adenine-Cation-Radical-in-the-Gas-Phase-and-Aqueous-Solution\" class=\"headerlink\" title=\"Distonic Isomers and Tautomers of Adenine Cation Radical in the Gas Phase and Aqueous Solution\"></a><jump id=\"l1\"><a href=\"https://pubs.acs.org/doi/10.1021/jp046575q\" target=\"_blank\" rel=\"noopener\">Distonic Isomers and Tautomers of Adenine Cation Radical in the Gas Phase and Aqueous Solution</a></jump></h1><h1 id=\"Adenine-Radicals-in-the-Gas-Phase-An-Experimental-and-Computational-Study-of-Hydrogen-Atom-Adducts-to-Adenine\"><a href=\"#Adenine-Radicals-in-the-Gas-Phase-An-Experimental-and-Computational-Study-of-Hydrogen-Atom-Adducts-to-Adenine\" class=\"headerlink\" title=\"Adenine Radicals in the Gas Phase. An Experimental and Computational Study of Hydrogen Atom Adducts to Adenine\"></a><jump id=\"l2\"><a href=\"https://pubs.acs.org/doi/abs/10.1021/jp0529725\" target=\"_blank\" rel=\"noopener\">Adenine Radicals in the Gas Phase. An Experimental and Computational Study of Hydrogen Atom Adducts to Adenine</a></jump></h1><h1 id=\"Dependence-of-Spurious-Charge-Transfer-Excited-States-on-Orbital-Exchange-in-TDDFT-Large-Molecules-and-Clusters\"><a href=\"#Dependence-of-Spurious-Charge-Transfer-Excited-States-on-Orbital-Exchange-in-TDDFT-Large-Molecules-and-Clusters\" class=\"headerlink\" title=\"Dependence of Spurious Charge- Transfer Excited States on Orbital Exchange in TDDFT: Large Molecules and Clusters\"></a><a href=\"https://pubs.acs.org/doi/10.1021/ct600282k\" target=\"_blank\" rel=\"noopener\">Dependence of Spurious Charge- Transfer Excited States on Orbital Exchange in TDDFT: Large Molecules and Clusters</a></h1><h1 id=\"Electron-Detachment-Energies-and-Isomerism-in-Purinic-Deoxyribonucleotides\"><a href=\"#Electron-Detachment-Energies-and-Isomerism-in-Purinic-Deoxyribonucleotides\" class=\"headerlink\" title=\"Electron Detachment Energies and Isomerism in Purinic Deoxyribonucleotides\"></a><jump id=\"ion1\"><a href=\"https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.21330\" target=\"_blank\" rel=\"noopener\">Electron Detachment Energies and Isomerism in Purinic Deoxyribonucleotides</a></jump></h1><h1 id=\"Ab-Initio-Electron-Propagator-Methods-Applications-to-Nucleic-Acids-Fragments-and-Metallophthalocyanines\"><a href=\"#Ab-Initio-Electron-Propagator-Methods-Applications-to-Nucleic-Acids-Fragments-and-Metallophthalocyanines\" class=\"headerlink\" title=\"Ab Initio Electron Propagator Methods: Applications to Nucleic Acids Fragments and Metallophthalocyanines.\"></a><jump id=\"ion2\"><a href=\"https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.22836\" target=\"_blank\" rel=\"noopener\">Ab Initio Electron Propagator Methods: Applications to Nucleic Acids Fragments and Metallophthalocyanines.</a></jump></h1><h1 id=\"Ion-Ion-Reactions-New-Chemistry-for-Analytical-MS\"><a href=\"#Ion-Ion-Reactions-New-Chemistry-for-Analytical-MS\" class=\"headerlink\" title=\"Ion/Ion Reactions: New Chemistry for Analytical MS\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/ac9014935\" target=\"_blank\" rel=\"noopener\">Ion/Ion Reactions: New Chemistry for Analytical MS</a></h1><h1 id=\"Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\"><a href=\"#Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\" class=\"headerlink\" title=\"Base Pair Radical Cation as a Model for Oxidative Damage in DNA\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01251\" target=\"_blank\" rel=\"noopener\">Base Pair Radical Cation as a Model for Oxidative Damage in DNA</a></h1><h1 id=\"One-Electron-Oxidation-of-DNA-Oligomers-That-Lack-Guanine-Reaction-and-Strand-Cleavage-at-Remote-Thymines-by-Long-Distance-Radical-Cation-Hopping\"><a href=\"#One-Electron-Oxidation-of-DNA-Oligomers-That-Lack-Guanine-Reaction-and-Strand-Cleavage-at-Remote-Thymines-by-Long-Distance-Radical-Cation-Hopping\" class=\"headerlink\" title=\"One-Electron Oxidation of DNA Oligomers That Lack Guanine: Reaction and Strand Cleavage at Remote Thymines by Long-Distance Radical Cation Hopping\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/ja058758b\" target=\"_blank\" rel=\"noopener\">One-Electron Oxidation of DNA Oligomers That Lack Guanine: Reaction and Strand Cleavage at Remote Thymines by Long-Distance Radical Cation Hopping</a></h1><h1 id=\"Transient-Intermediates-of-Chemical-Reactions-by-NeutralizationReionization-Mass-Spectrometry\"><a href=\"#Transient-Intermediates-of-Chemical-Reactions-by-NeutralizationReionization-Mass-Spectrometry\" class=\"headerlink\" title=\"Transient Intermediates of Chemical Reactions by NeutralizationReionization Mass Spectrometry\"></a><jump id=\"ref\"><a href=\"https://link.springer.com/chapter/10.1007/3-540-36113-8_3\" target=\"_blank\" rel=\"noopener\">Transient Intermediates of Chemical Reactions by NeutralizationReionization Mass Spectrometry</a></jump></h1><h1 id=\"Irreversible-Electron-Attachment-A-Key-to-DNA-Damage-by-Solvated-Electrons-in-Aqueous-Solution\"><a href=\"#Irreversible-Electron-Attachment-A-Key-to-DNA-Damage-by-Solvated-Electrons-in-Aqueous-Solution\" class=\"headerlink\" title=\"Irreversible Electron Attachment - A Key to DNA Damage by Solvated Electrons in Aqueous Solution\"></a><a href=\"https://pubs.rsc.org/en/content/articlelanding/2015/ob/c5ob01542a#!divAbstract\" target=\"_blank\" rel=\"noopener\">Irreversible Electron Attachment - A Key to DNA Damage by Solvated Electrons in Aqueous Solution</a></h1><h1 id=\"What-Hinders-Electron-Transfer-Dissociation-ETD-of-DNA-Cations\"><a href=\"#What-Hinders-Electron-Transfer-Dissociation-ETD-of-DNA-Cations\" class=\"headerlink\" title=\"What Hinders Electron Transfer Dissociation (ETD) of DNA Cations?\"></a><a href=\"https://link.springer.com/article/10.1007%2Fs13361-017-1791-z\" target=\"_blank\" rel=\"noopener\">What Hinders Electron Transfer Dissociation (ETD) of DNA Cations?</a></h1><h1 id=\"Proton-and-hydrogen-atom-adducts-to-cytosine-An-experimental-and-computational-study\"><a href=\"#Proton-and-hydrogen-atom-adducts-to-cytosine-An-experimental-and-computational-study\" class=\"headerlink\" title=\"Proton and hydrogen atom adducts to cytosine. An experimental and computational study\"></a><a href=\"https://www.sciencedirect.com/science/article/pii/S1387380607000279\" target=\"_blank\" rel=\"noopener\">Proton and hydrogen atom adducts to cytosine. An experimental and computational study</a></h1><h1 id=\"Toward-True-DNA-Base-Stacking-Energies-MP2-CCSD-T-and-Complete-Basis-Set-Calculations\"><a href=\"#Toward-True-DNA-Base-Stacking-Energies-MP2-CCSD-T-and-Complete-Basis-Set-Calculations\" class=\"headerlink\" title=\"Toward True DNA Base-Stacking Energies: MP2, CCSD(T), and Complete Basis Set Calculations\"></a><a href=\"https://pubs.acs.org/doi/10.1021/ja026759n\" target=\"_blank\" rel=\"noopener\">Toward True DNA Base-Stacking Energies: MP2, CCSD(T), and Complete Basis Set Calculations</a></h1><h1 id=\"Purine-bases-nucleosides-and-nucleotides-aqueous-solution-redox-chemistry-and-transformation-reactions-of-their-radical-cations-and-e-and-OH-adducts\"><a href=\"#Purine-bases-nucleosides-and-nucleotides-aqueous-solution-redox-chemistry-and-transformation-reactions-of-their-radical-cations-and-e-and-OH-adducts\" class=\"headerlink\" title=\"Purine bases, nucleosides, and nucleotides: aqueous solution redox chemistry and transformation reactions of their radical cations and e- and OH adducts\"></a><a href=\"https://pubs.acs.org/doi/10.1021/cr00093a003\" target=\"_blank\" rel=\"noopener\">Purine bases, nucleosides, and nucleotides: aqueous solution redox chemistry and transformation reactions of their radical cations and e- and OH adducts</a></h1><h1 id=\"Proton-coupled-Electron-Transfer-in-DNA-on-Formation-of-Radiation-produced-Ion-Radicals\"><a href=\"#Proton-coupled-Electron-Transfer-in-DNA-on-Formation-of-Radiation-produced-Ion-Radicals\" class=\"headerlink\" title=\"Proton-coupled Electron Transfer in DNA on Formation of Radiation-produced Ion Radicals\"></a><a href=\"http://pubs.acs.org/doi/abs/10.1021/cr100023g\" target=\"_blank\" rel=\"noopener\">Proton-coupled Electron Transfer in DNA on Formation of Radiation-produced Ion Radicals</a></h1><h1 id=\"Induction-of-Strand-Breaks-in-Single-stranded-Polyribonucleotides-and-DNA-by-Photoionization-One-Electron-Oxidized-Nucleobase-Radicals-as-Precursors\"><a href=\"#Induction-of-Strand-Breaks-in-Single-stranded-Polyribonucleotides-and-DNA-by-Photoionization-One-Electron-Oxidized-Nucleobase-Radicals-as-Precursors\" class=\"headerlink\" title=\"Induction of Strand Breaks in Single-stranded Polyribonucleotides and DNA by Photoionization: One Electron Oxidized Nucleobase Radicals as Precursors\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/ja961722m\" target=\"_blank\" rel=\"noopener\">Induction of Strand Breaks in Single-stranded Polyribonucleotides and DNA by Photoionization: One Electron Oxidized Nucleobase Radicals as Precursors</a></h1><h1 id=\"How-Easily-Oxidizable-is-DNA-One-electron-Reduction-Potentials-of-Adenosine-and-Guanosine-Radicals-in-Aqueous-Solution\"><a href=\"#How-Easily-Oxidizable-is-DNA-One-electron-Reduction-Potentials-of-Adenosine-and-Guanosine-Radicals-in-Aqueous-Solution\" class=\"headerlink\" title=\"How Easily Oxidizable is DNA? One-electron Reduction Potentials of Adenosine and Guanosine Radicals in Aqueous Solution\"></a><a href=\"https://pubs.acs.org/doi/10.1021/ja962255b\" target=\"_blank\" rel=\"noopener\">How Easily Oxidizable is DNA? One-electron Reduction Potentials of Adenosine and Guanosine Radicals in Aqueous Solution</a></h1><h1 id=\"Structure-and-Acid-base-Properties-of-One-electron-oxidized-Deoxyguanosine-Guanosine-and-1-Methylguanosine\"><a href=\"#Structure-and-Acid-base-Properties-of-One-electron-oxidized-Deoxyguanosine-Guanosine-and-1-Methylguanosine\" class=\"headerlink\" title=\"Structure and Acid-base Properties of One-electron-oxidized Deoxyguanosine, Guanosine, and 1-Methylguanosine\"></a><jump id=\"gasbetter\"><a href=\"https://pubs.acs.org/doi/10.1021/ja00185a046\" target=\"_blank\" rel=\"noopener\">Structure and Acid-base Properties of One-electron-oxidized Deoxyguanosine, Guanosine, and 1-Methylguanosine</a></jump></h1>","site":{"data":{}},"excerpt":"","more":"<p> <strong><em>Keyword</em></strong></p>\n<p> adenine |  cation radical |  cytosine | electron attachment | guanine | nucleotide | proton transfer | spectra | thymine |</p>\n<h1 id=\"UVVis-Action-Spectroscopy-Reveals-a-Conformational-Collapse-in-Hydrogen-Rich-Dinucleotide-Cation-Radicals\"><a href=\"#UVVis-Action-Spectroscopy-Reveals-a-Conformational-Collapse-in-Hydrogen-Rich-Dinucleotide-Cation-Radicals\" class=\"headerlink\" title=\"UVVis Action Spectroscopy Reveals a Conformational Collapse in Hydrogen-Rich Dinucleotide Cation Radicals\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01856\" target=\"_blank\" rel=\"noopener\">UVVis Action Spectroscopy Reveals a Conformational Collapse in Hydrogen-Rich Dinucleotide Cation Radicals</a></h1><ul>\n<li>Why<ul>\n<li>DNA cation radicals are intermediates during the interaction of DNA with high energy particles</li>\n<li>electron defect initially located in a nucleobase, migrates along the DNA backbone to reside on guanine</li>\n<li>DNA behavior at atomic-level needed</li>\n</ul>\n</li>\n<li>Goal<ul>\n<li>proton and electron transfer along a single strand in DNA and related cation radicals</li>\n<li>use deoxyriboadenosine dinucleotide (dAA) and riboadenosine chimeras (pseudo-dAA)</li>\n</ul>\n</li>\n<li>Intro<ul>\n<li>dication$\\rightarrow$catrad: conformation collapse</li>\n<li>dAA<ul>\n<li>intra proton migrations btw nucleobases</li>\n</ul>\n</li>\n<li>pseudo-dAA-catrad<ul>\n<li>zwitterionic structures</li>\n<li>Coulomb stablization</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-Gaseous-Protonated-A\"><a href=\"#1-Gaseous-Protonated-A\" class=\"headerlink\" title=\"1. Gaseous Protonated A\"></a>1. Gaseous Protonated A</h2><ul>\n<li>N-1, N-3, N- 7, N-9, and NH2 (N-10) positions: potential protonation sites</li>\n<li>dA: N-3<ul>\n<li>H bond stablization</li>\n</ul>\n</li>\n<li>dAA: N-1, N-1</li>\n<li>psedo-dAA: N-3, N-3<ul>\n<li>H bond stablization</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-Form-Cation-Radicals\"><a href=\"#2-Form-Cation-Radicals\" class=\"headerlink\" title=\"2. Form Cation Radicals\"></a>2. Form Cation Radicals</h2><ul>\n<li>ETD dAA+2$H^+$: $[M-H]^+(m/z\\ 565)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$, $w^+(m/z\\  332)$</li>\n<li>M+CE/DBCE$\\rightarrow$ESI$\\rightarrow$ETD: $M^{+\\cdot}$</li>\n<li>CE favors N-1 position</li>\n</ul>\n<h2 id=\"3-UV-Vis-Action-Spectrum\"><a href=\"#3-UV-Vis-Action-Spectrum\" class=\"headerlink\" title=\"3. UV-Vis Action Spectrum\"></a>3. UV-Vis Action Spectrum</h2><ul>\n<li>vis: broad band at 465nm; uv: 340nm, 260nm </li>\n<li>channel: $w^+(m/z\\ 332)$, $[w+H]^{+\\cdot}(m/z\\ 333)$, $[M-H-A]^{+\\cdot}(m/z\\ 431)$</li>\n<li>260nm is same with <a href=\"#ap1\">pccp_adenine1</a> and <a href=\"#ap2\">pccp_adenine2</a></li>\n</ul>\n<h2 id=\"4-Dinucleotide-Cation-Radical-Structures\"><a href=\"#4-Dinucleotide-Cation-Radical-Structures\" class=\"headerlink\" title=\"4. Dinucleotide Cation Radical Structures\"></a>4. Dinucleotide Cation Radical Structures</h2><ul>\n<li>if exothermic, isomerization driven by proton migrations will occur sponstaneously and driven by exotherimic energy provided by the electron attachment reaction. </li>\n<li>electron not attach N-1</li>\n<li>hydrogen migration might face substantial energy barrier. [<a href=\"#l1\">A+H1</a> | <a href=\"#l2\">A+H2</a>]</li>\n<li>proton transfer (move radical position)$\\rightarrow$optimize$\\rightarrow$ more stable structures</li>\n<li>theoritical uvvis spectra and molecular orbital analysis $\\rightarrow$ possible tautomers &amp; spectra contributions $\\pi_z \\rightarrow \\pi_z^*$</li>\n</ul>\n<h2 id=\"5-Adenine-Ribonucleotide-Chimeras\"><a href=\"#5-Adenine-Ribonucleotide-Chimeras\" class=\"headerlink\" title=\"5. Adenine Ribonucleotide Chimeras\"></a>5. Adenine Ribonucleotide Chimeras</h2><ul>\n<li>uv-vis analysis: similiar band position to dAA </li>\n<li>aromatic diesters<ul>\n<li>opt: zwitterionic dication-anion radicals $\\longleftrightarrow$ folded structure (exothermic conformation collapse)</li>\n<li>Coulomb stablization of zwitterionic structures is analogous to the solvent effects governing DNA ionization (<a href=\"#ion1\">DNAion1</a> | <a href=\"#ion2\">DNAion2</a>)</li>\n</ul>\n</li>\n<li>cyclohexane diester: <ul>\n<li>adenine cation and radical moieties are located on the opposite sides of the cyclohexane ring </li>\n<li>attractive iondipole and ion-induced dipole interactions</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Hydrogen-Rich-Cation-Radicals-of-DNA-Dinucleotides-Generation-and-Structure-Elucidation-by-UVVis-Action-Spectroscopy\"><a href=\"#Hydrogen-Rich-Cation-Radicals-of-DNA-Dinucleotides-Generation-and-Structure-Elucidation-by-UVVis-Action-Spectroscopy\" class=\"headerlink\" title=\"Hydrogen-Rich Cation Radicals of DNA Dinucleotides: Generation and Structure Elucidation by UVVis Action Spectroscopy\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/acs.jpcb.8b07925\" target=\"_blank\" rel=\"noopener\">Hydrogen-Rich Cation Radicals of DNA Dinucleotides: Generation and Structure Elucidation by UVVis Action Spectroscopy</a></h1><ul>\n<li>Why<ul>\n<li>DNA ionization causes chemical changes leading to complex process of DNA damage; intermediates: DNA cation radicals</li>\n<li>the intrinsic electronic properties of the reactive cation radical intermediates just are elucidated recently</li>\n<li>without solvent and counterions, gas-phase studies can focus on the intrinsic electronic and chemical properties of the radical species (<a href=\"#ref\">ref</a>)</li>\n</ul>\n</li>\n<li>Goal<ul>\n<li>purine and pyrimidine nucleobases in dinucleotide cation radicals exhibit different properties: <ul>\n<li>nucleobase stacking</li>\n<li>hydrogen bonds</li>\n<li>propensity for undergoing intramolecular proton transfer</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Intro<ul>\n<li>cation radical<ul>\n<li>$(dGG+2H)^{+\\cdot}$: conform collapse, 3-G C-8-H radical</li>\n<li>$(dCG+2H)^{+\\cdot}$: collapse, a mixture of 5-C and 3-G radicals</li>\n<li>$(dGC+2H)^{+\\cdot}$: retain structure, a 3-C radical</li>\n</ul>\n</li>\n<li>basicity ($pK_a$) in water $\\Leftrightarrow$ ability of proton-transfer reactions in solution<ul>\n<li>$(G+H)^\\cdot$: 20.0</li>\n<li>$(C+H)^\\cdot$: 4.6</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"1-Dinucleotide-Cation-Radical-Generationf\"><a href=\"#1-Dinucleotide-Cation-Radical-Generationf\" class=\"headerlink\" title=\"1. Dinucleotide Cation Radical Generationf\"></a>1. Dinucleotide Cation Radical Generationf</h2><ul>\n<li>larger oligos form stable cation radicals</li>\n<li>smaller one needs DBCE</li>\n</ul>\n<h2 id=\"2-Dinucleotide-Cation-Radical-Collision-Induced-Dis-sociation-and-Photodissociation-Spectra\"><a href=\"#2-Dinucleotide-Cation-Radical-Collision-Induced-Dis-sociation-and-Photodissociation-Spectra\" class=\"headerlink\" title=\"2. Dinucleotide Cation Radical Collision-Induced Dis- sociation and Photodissociation Spectra\"></a>2. Dinucleotide Cation Radical Collision-Induced Dis- sociation and Photodissociation Spectra</h2><ul>\n<li>CID of cation radicals<ul>\n<li>$(dGG+2H)^{+\\cdot}$: $[M-G]^{+\\cdot}$, $[M-G-H]^{+}$, $[d_1/w_1]^+$, $[d_1/w_1+H]^{+\\cdot}$</li>\n<li>$(dGC+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C]^{+\\cdot}$, $[M-G-H]^{+}$, $d^+$, $[w+2H]^+$, $[z_1+H]^{+\\cdot}$</li>\n<li>$(dCG+2H)^{+\\cdot}$: $[M-H_2O]^{+\\cdot}$, $[M-C-H]^{+}$, $[M-C]^{+\\cdot}$, $w_1^+$</li>\n</ul>\n</li>\n<li>how nucleobase nature and position affect<ul>\n<li>C at 3-end $\\rightarrow$ elimination of water</li>\n<li>C at 5-end $\\rightarrow$ lost as $[C+H]^\\cdot$</li>\n<li>loss of C &gt; loss of G</li>\n<li>5-C suppresses 3-G loss</li>\n</ul>\n</li>\n<li>UVPD similiar to CID</li>\n<li>close shell systems have similiar absorption $\\rightarrow$ not only associated with radical moieties</li>\n</ul>\n<h2 id=\"3-dGG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\"><a href=\"#3-dGG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\" class=\"headerlink\" title=\"3. $[dGG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\"></a>3. $[dGG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures</h2><ul>\n<li>action spectra: 450-470nm, 330, 310 and 270nm</li>\n<li>structure:<ul>\n<li>H positon<ul>\n<li>most basic: N-7</li>\n<li>2nd basic: 6-OHN-3H</li>\n</ul>\n</li>\n<li>CE at 5-terminal stable than that at 3</li>\n<li>H transfer<ul>\n<li>exthothermic </li>\n<li>cation and radical at 5-G most stable</li>\n<li>cation at 3-G, radical at 5-G relatively stable and match spectra</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>450-460nm: SOMO, 156$\\alpha (\\pi)\\rightarrow$ combined $\\pi^*$ at 3-G radical</li>\n<li>$(G+H)^\\cdot$ estimates thermal shift and broadening</li>\n<li>215kJ/mol ($\\lambda$&lt;550nm) enough to drive dissociation</li>\n</ul>\n<h2 id=\"4-dCG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\"><a href=\"#4-dCG-2H-cdot-Action-Spectroscopy-and-Ion-Structures\" class=\"headerlink\" title=\"4. $[dCG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\"></a>4. $[dCG+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures</h2><ul>\n<li>action spectra: weak 450-480nm, strong 350 and 280nm</li>\n<li>structure:<ul>\n<li>cytosine: O-2 and N-3 basic positions</li>\n<li>CE at 5-C ring and 3-G ring</li>\n<li>H posiitons: dC3G7</li>\n<li>H transfer<ul>\n<li>transition state high, but exthothermic finally (kinetic hampered)</li>\n<li>major: radical at C; minor at G</li>\n<li>RRKM calculation: 310kJ/mol internal energy needed for conversion</li>\n<li>$E_{int}=E_{thermal}+E_{exc}$, where $E_{exc}$ is part (calculated by heat capacity) of exthothermic reaction energy </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>dissociation of C or (C+H)$^\\cdot$ are less endothermic than G or (G+H)$^\\cdot$</li>\n</ul>\n<h2 id=\"5-dGC-2H-cdot-Action-Spectroscopy-and-Ion-Structures\"><a href=\"#5-dGC-2H-cdot-Action-Spectroscopy-and-Ion-Structures\" class=\"headerlink\" title=\"5. $[dGC+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures\"></a>5. $[dGC+2H]^{+\\cdot}$ Action Spectroscopy and Ion Structures</h2><ul>\n<li>action spectra: extremely weak broad 620nm, 420-500nm and 360nm, strong 285nm</li>\n<li>structure<ul>\n<li>CE at 3-C ring</li>\n<li>radical at C</li>\n<li>proton transfer exthothermic but not fit spectra </li>\n</ul>\n</li>\n</ul>\n<h2 id=\"6-Discussion\"><a href=\"#6-Discussion\" class=\"headerlink\" title=\"6. Discussion\"></a>6. Discussion</h2><ul>\n<li>site of electron attachment to the dications depends on<ul>\n<li>nucleobase nature<br> C&gt;G: <em>RE</em>$<em>{adiab}$<em>(C)</em>=5.17eV; <em>RE</em>$</em>{adiab}$<em>(G)</em>=4.46eV</li>\n<li>nucleobase position<br>dGG: 5-G&gt;3-G</li>\n</ul>\n</li>\n<li>ring stacking and proton transfer<ul>\n<li>dGG: nucleobase stacking, faciles proton transfer</li>\n<li>dGC and dCG: nucleobases perpenticular, kinetically hampered</li>\n</ul>\n</li>\n<li>$(G+H)^{+} (aq,pK_a=3.3)+(G+H)^\\cdot (aq) \\overset{\\Delta G=-95 kJ/mol}{\\longrightarrow} G(aq)+(G+2H)^{+\\cdot}(aq,pK_a\\approx20.0)$</li>\n<li>$(C+H)^{+} (aq,pK_a=4.6)+(C+H)^\\cdot(aq) \\overset{\\Delta G=-0.1 kJ/mol}{\\rightleftharpoons} C(aq)+(C+2H)^{+\\cdot}(aq,pK_a\\approx4.6)$</li>\n</ul>\n<h1 id=\"Watson-Crick-Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\"><a href=\"#Watson-Crick-Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\" class=\"headerlink\" title=\"Watson-Crick Base Pair Radical Cation as a Model for Oxidative Damage in DNA\"></a><a href=\"https://pubs.acs.org/doi/10.1021/acs.jpclett.7b01251\" target=\"_blank\" rel=\"noopener\">Watson-Crick Base Pair Radical Cation as a Model for Oxidative Damage in DNA</a></h1><h2 id=\"Background\"><a href=\"#Background\" class=\"headerlink\" title=\"Background\"></a>Background</h2><ul>\n<li>mechanisms of DNA damage poorly understood<ul>\n<li>oxidation $\\rightarrow$ deprotonation at G $\\rightarrow$ H abstraction from sugar $\\rightarrow$ DNA strand breaks $\\rightarrow$ mutagenesis and cancer</li>\n<li>probing initially formed radical cation challengeing</li>\n</ul>\n</li>\n<li>proton-coupled electron and hole transfer is an important<br>feature in radiation damage process</li>\n</ul>\n<h2 id=\"Notes\"><a href=\"#Notes\" class=\"headerlink\" title=\"Notes\"></a>Notes</h2><ul>\n<li>gas-phase acidity data may be more appropriate to characterize the equilibrium position of the proton in oxidized GC base pairs (<a href=\"#gasbetter\">ref</a>)</li>\n<li>Guanine<ol>\n<li>the lowest ionization energy among GATC, both in solution and gas $\\Rightarrow$</li>\n<li>electtron loss during ionization of DNA mostly occurs form G $\\rightarrow$</li>\n<li>G radical cations enhaces acidities than G $\\Rightarrow$ </li>\n</ol>\n<ul>\n<li>dG$^{+\\cdot}$-dC pair: H transfer from G to C (G3$\\rightarrow$C3) $\\Rightarrow$ relocation of radical site to sugar</li>\n</ul>\n</li>\n<li>homolytic bond dissociation enthaloy of 401kJ/mol for [dG+H(N$_7$)]$^+$ is comparable to that for a typical C-H bond $\\Rightarrow$ other radicals via intra- or intermolecular H-abstraction reactions</li>\n<li>CID<ol>\n<li>$[dGdC]^{+\\cdot}-CH_2O$: occurs on the sugar of G</li>\n<li>further loss $C_2H_3O_2$</li>\n<li>$[dGdC]^{+\\cdot}-C_5H_8O_3$ not nucleobase specific </li>\n</ol>\n</li>\n</ul>\n<h1 id=\"Gas-Phase-Fragmentation-of-Oligonucleotide-Ions\"><a href=\"#Gas-Phase-Fragmentation-of-Oligonucleotide-Ions\" class=\"headerlink\" title=\"Gas-Phase Fragmentation of Oligonucleotide Ions\"></a><a href=\"https://www.sciencedirect.com/science/article/pii/S1387380604003264?via%3Dihub\" target=\"_blank\" rel=\"noopener\">Gas-Phase Fragmentation of Oligonucleotide Ions</a></h1><ul>\n<li>The preferred dissociation channels for a given ion are a function of the ion type, the structure o fth emolecule, the internal energy distribution of the ion and the time-frame over which the fragmentation reactions can evolve</li>\n<li>McLuckeys nomenclature for backbone cleavages (a/w,b/x,c/y,d/z, 5-frag:a,b,c,d; 3-frag: w,x,y,z)</li>\n</ul>\n<h1 id=\"The-Electronic-Spectrum-of-Protonated-Adenine-Theory-and-Experiment\"><a href=\"#The-Electronic-Spectrum-of-Protonated-Adenine-Theory-and-Experiment\" class=\"headerlink\" title=\"The Electronic Spectrum of Protonated Adenine: Theory and Experiment\"></a><jump id=\"ap1\"><a href=\"https://pubs.rsc.org/en/content/articlelanding/2005/cp/b507422c/unauth#!divAbstract\" target=\"_blank\" rel=\"noopener\">The Electronic Spectrum of Protonated Adenine: Theory and Experiment</a></jump></h1><h1 id=\"Gas-phase-spectroscopy-of-protonated-adenine-adenosine-5-monophosphate-and-monohydrated-ions\"><a href=\"#Gas-phase-spectroscopy-of-protonated-adenine-adenosine-5-monophosphate-and-monohydrated-ions\" class=\"headerlink\" title=\"Gas-phase spectroscopy of protonated adenine, adenosine 5-monophosphate and monohydrated ions\"></a><jump id=\"ap2\"><a href=\"https://pubs.rsc.org/en/content/articlelanding/2013/cp/c3cp53742k/unauth#!divAbstract\" target=\"_blank\" rel=\"noopener\">Gas-phase spectroscopy of protonated adenine, adenosine 5-monophosphate and monohydrated ions</a></jump></h1><h1 id=\"Combining-UV-photodissociation-action-spectroscopy-with-electron-transfer-dissociation-for-structure-analysis-of-gasphase-peptide-cationradicals\"><a href=\"#Combining-UV-photodissociation-action-spectroscopy-with-electron-transfer-dissociation-for-structure-analysis-of-gasphase-peptide-cationradicals\" class=\"headerlink\" title=\"Combining UV photodissociation action spectroscopy with electron transfer dissociation for structure analysis of gasphase peptide cationradicals\"></a><a href=\"https://onlinelibrary.wiley.com/doi/full/10.1002/jms.3717\" target=\"_blank\" rel=\"noopener\">Combining UV photodissociation action spectroscopy with electron transfer dissociation for structure analysis of gasphase peptide cationradicals</a></h1><h1 id=\"Distonic-Isomers-and-Tautomers-of-Adenine-Cation-Radical-in-the-Gas-Phase-and-Aqueous-Solution\"><a href=\"#Distonic-Isomers-and-Tautomers-of-Adenine-Cation-Radical-in-the-Gas-Phase-and-Aqueous-Solution\" class=\"headerlink\" title=\"Distonic Isomers and Tautomers of Adenine Cation Radical in the Gas Phase and Aqueous Solution\"></a><jump id=\"l1\"><a href=\"https://pubs.acs.org/doi/10.1021/jp046575q\" target=\"_blank\" rel=\"noopener\">Distonic Isomers and Tautomers of Adenine Cation Radical in the Gas Phase and Aqueous Solution</a></jump></h1><h1 id=\"Adenine-Radicals-in-the-Gas-Phase-An-Experimental-and-Computational-Study-of-Hydrogen-Atom-Adducts-to-Adenine\"><a href=\"#Adenine-Radicals-in-the-Gas-Phase-An-Experimental-and-Computational-Study-of-Hydrogen-Atom-Adducts-to-Adenine\" class=\"headerlink\" title=\"Adenine Radicals in the Gas Phase. An Experimental and Computational Study of Hydrogen Atom Adducts to Adenine\"></a><jump id=\"l2\"><a href=\"https://pubs.acs.org/doi/abs/10.1021/jp0529725\" target=\"_blank\" rel=\"noopener\">Adenine Radicals in the Gas Phase. An Experimental and Computational Study of Hydrogen Atom Adducts to Adenine</a></jump></h1><h1 id=\"Dependence-of-Spurious-Charge-Transfer-Excited-States-on-Orbital-Exchange-in-TDDFT-Large-Molecules-and-Clusters\"><a href=\"#Dependence-of-Spurious-Charge-Transfer-Excited-States-on-Orbital-Exchange-in-TDDFT-Large-Molecules-and-Clusters\" class=\"headerlink\" title=\"Dependence of Spurious Charge- Transfer Excited States on Orbital Exchange in TDDFT: Large Molecules and Clusters\"></a><a href=\"https://pubs.acs.org/doi/10.1021/ct600282k\" target=\"_blank\" rel=\"noopener\">Dependence of Spurious Charge- Transfer Excited States on Orbital Exchange in TDDFT: Large Molecules and Clusters</a></h1><h1 id=\"Electron-Detachment-Energies-and-Isomerism-in-Purinic-Deoxyribonucleotides\"><a href=\"#Electron-Detachment-Energies-and-Isomerism-in-Purinic-Deoxyribonucleotides\" class=\"headerlink\" title=\"Electron Detachment Energies and Isomerism in Purinic Deoxyribonucleotides\"></a><jump id=\"ion1\"><a href=\"https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.21330\" target=\"_blank\" rel=\"noopener\">Electron Detachment Energies and Isomerism in Purinic Deoxyribonucleotides</a></jump></h1><h1 id=\"Ab-Initio-Electron-Propagator-Methods-Applications-to-Nucleic-Acids-Fragments-and-Metallophthalocyanines\"><a href=\"#Ab-Initio-Electron-Propagator-Methods-Applications-to-Nucleic-Acids-Fragments-and-Metallophthalocyanines\" class=\"headerlink\" title=\"Ab Initio Electron Propagator Methods: Applications to Nucleic Acids Fragments and Metallophthalocyanines.\"></a><jump id=\"ion2\"><a href=\"https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.22836\" target=\"_blank\" rel=\"noopener\">Ab Initio Electron Propagator Methods: Applications to Nucleic Acids Fragments and Metallophthalocyanines.</a></jump></h1><h1 id=\"Ion-Ion-Reactions-New-Chemistry-for-Analytical-MS\"><a href=\"#Ion-Ion-Reactions-New-Chemistry-for-Analytical-MS\" class=\"headerlink\" title=\"Ion/Ion Reactions: New Chemistry for Analytical MS\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/ac9014935\" target=\"_blank\" rel=\"noopener\">Ion/Ion Reactions: New Chemistry for Analytical MS</a></h1><h1 id=\"Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\"><a href=\"#Base-Pair-Radical-Cation-as-a-Model-for-Oxidative-Damage-in-DNA\" class=\"headerlink\" title=\"Base Pair Radical Cation as a Model for Oxidative Damage in DNA\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/acs.jpclett.7b01251\" target=\"_blank\" rel=\"noopener\">Base Pair Radical Cation as a Model for Oxidative Damage in DNA</a></h1><h1 id=\"One-Electron-Oxidation-of-DNA-Oligomers-That-Lack-Guanine-Reaction-and-Strand-Cleavage-at-Remote-Thymines-by-Long-Distance-Radical-Cation-Hopping\"><a href=\"#One-Electron-Oxidation-of-DNA-Oligomers-That-Lack-Guanine-Reaction-and-Strand-Cleavage-at-Remote-Thymines-by-Long-Distance-Radical-Cation-Hopping\" class=\"headerlink\" title=\"One-Electron Oxidation of DNA Oligomers That Lack Guanine: Reaction and Strand Cleavage at Remote Thymines by Long-Distance Radical Cation Hopping\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/ja058758b\" target=\"_blank\" rel=\"noopener\">One-Electron Oxidation of DNA Oligomers That Lack Guanine: Reaction and Strand Cleavage at Remote Thymines by Long-Distance Radical Cation Hopping</a></h1><h1 id=\"Transient-Intermediates-of-Chemical-Reactions-by-NeutralizationReionization-Mass-Spectrometry\"><a href=\"#Transient-Intermediates-of-Chemical-Reactions-by-NeutralizationReionization-Mass-Spectrometry\" class=\"headerlink\" title=\"Transient Intermediates of Chemical Reactions by NeutralizationReionization Mass Spectrometry\"></a><jump id=\"ref\"><a href=\"https://link.springer.com/chapter/10.1007/3-540-36113-8_3\" target=\"_blank\" rel=\"noopener\">Transient Intermediates of Chemical Reactions by NeutralizationReionization Mass Spectrometry</a></jump></h1><h1 id=\"Irreversible-Electron-Attachment-A-Key-to-DNA-Damage-by-Solvated-Electrons-in-Aqueous-Solution\"><a href=\"#Irreversible-Electron-Attachment-A-Key-to-DNA-Damage-by-Solvated-Electrons-in-Aqueous-Solution\" class=\"headerlink\" title=\"Irreversible Electron Attachment - A Key to DNA Damage by Solvated Electrons in Aqueous Solution\"></a><a href=\"https://pubs.rsc.org/en/content/articlelanding/2015/ob/c5ob01542a#!divAbstract\" target=\"_blank\" rel=\"noopener\">Irreversible Electron Attachment - A Key to DNA Damage by Solvated Electrons in Aqueous Solution</a></h1><h1 id=\"What-Hinders-Electron-Transfer-Dissociation-ETD-of-DNA-Cations\"><a href=\"#What-Hinders-Electron-Transfer-Dissociation-ETD-of-DNA-Cations\" class=\"headerlink\" title=\"What Hinders Electron Transfer Dissociation (ETD) of DNA Cations?\"></a><a href=\"https://link.springer.com/article/10.1007%2Fs13361-017-1791-z\" target=\"_blank\" rel=\"noopener\">What Hinders Electron Transfer Dissociation (ETD) of DNA Cations?</a></h1><h1 id=\"Proton-and-hydrogen-atom-adducts-to-cytosine-An-experimental-and-computational-study\"><a href=\"#Proton-and-hydrogen-atom-adducts-to-cytosine-An-experimental-and-computational-study\" class=\"headerlink\" title=\"Proton and hydrogen atom adducts to cytosine. An experimental and computational study\"></a><a href=\"https://www.sciencedirect.com/science/article/pii/S1387380607000279\" target=\"_blank\" rel=\"noopener\">Proton and hydrogen atom adducts to cytosine. An experimental and computational study</a></h1><h1 id=\"Toward-True-DNA-Base-Stacking-Energies-MP2-CCSD-T-and-Complete-Basis-Set-Calculations\"><a href=\"#Toward-True-DNA-Base-Stacking-Energies-MP2-CCSD-T-and-Complete-Basis-Set-Calculations\" class=\"headerlink\" title=\"Toward True DNA Base-Stacking Energies: MP2, CCSD(T), and Complete Basis Set Calculations\"></a><a href=\"https://pubs.acs.org/doi/10.1021/ja026759n\" target=\"_blank\" rel=\"noopener\">Toward True DNA Base-Stacking Energies: MP2, CCSD(T), and Complete Basis Set Calculations</a></h1><h1 id=\"Purine-bases-nucleosides-and-nucleotides-aqueous-solution-redox-chemistry-and-transformation-reactions-of-their-radical-cations-and-e-and-OH-adducts\"><a href=\"#Purine-bases-nucleosides-and-nucleotides-aqueous-solution-redox-chemistry-and-transformation-reactions-of-their-radical-cations-and-e-and-OH-adducts\" class=\"headerlink\" title=\"Purine bases, nucleosides, and nucleotides: aqueous solution redox chemistry and transformation reactions of their radical cations and e- and OH adducts\"></a><a href=\"https://pubs.acs.org/doi/10.1021/cr00093a003\" target=\"_blank\" rel=\"noopener\">Purine bases, nucleosides, and nucleotides: aqueous solution redox chemistry and transformation reactions of their radical cations and e- and OH adducts</a></h1><h1 id=\"Proton-coupled-Electron-Transfer-in-DNA-on-Formation-of-Radiation-produced-Ion-Radicals\"><a href=\"#Proton-coupled-Electron-Transfer-in-DNA-on-Formation-of-Radiation-produced-Ion-Radicals\" class=\"headerlink\" title=\"Proton-coupled Electron Transfer in DNA on Formation of Radiation-produced Ion Radicals\"></a><a href=\"http://pubs.acs.org/doi/abs/10.1021/cr100023g\" target=\"_blank\" rel=\"noopener\">Proton-coupled Electron Transfer in DNA on Formation of Radiation-produced Ion Radicals</a></h1><h1 id=\"Induction-of-Strand-Breaks-in-Single-stranded-Polyribonucleotides-and-DNA-by-Photoionization-One-Electron-Oxidized-Nucleobase-Radicals-as-Precursors\"><a href=\"#Induction-of-Strand-Breaks-in-Single-stranded-Polyribonucleotides-and-DNA-by-Photoionization-One-Electron-Oxidized-Nucleobase-Radicals-as-Precursors\" class=\"headerlink\" title=\"Induction of Strand Breaks in Single-stranded Polyribonucleotides and DNA by Photoionization: One Electron Oxidized Nucleobase Radicals as Precursors\"></a><a href=\"https://pubs.acs.org/doi/abs/10.1021/ja961722m\" target=\"_blank\" rel=\"noopener\">Induction of Strand Breaks in Single-stranded Polyribonucleotides and DNA by Photoionization: One Electron Oxidized Nucleobase Radicals as Precursors</a></h1><h1 id=\"How-Easily-Oxidizable-is-DNA-One-electron-Reduction-Potentials-of-Adenosine-and-Guanosine-Radicals-in-Aqueous-Solution\"><a href=\"#How-Easily-Oxidizable-is-DNA-One-electron-Reduction-Potentials-of-Adenosine-and-Guanosine-Radicals-in-Aqueous-Solution\" class=\"headerlink\" title=\"How Easily Oxidizable is DNA? One-electron Reduction Potentials of Adenosine and Guanosine Radicals in Aqueous Solution\"></a><a href=\"https://pubs.acs.org/doi/10.1021/ja962255b\" target=\"_blank\" rel=\"noopener\">How Easily Oxidizable is DNA? One-electron Reduction Potentials of Adenosine and Guanosine Radicals in Aqueous Solution</a></h1><h1 id=\"Structure-and-Acid-base-Properties-of-One-electron-oxidized-Deoxyguanosine-Guanosine-and-1-Methylguanosine\"><a href=\"#Structure-and-Acid-base-Properties-of-One-electron-oxidized-Deoxyguanosine-Guanosine-and-1-Methylguanosine\" class=\"headerlink\" title=\"Structure and Acid-base Properties of One-electron-oxidized Deoxyguanosine, Guanosine, and 1-Methylguanosine\"></a><jump id=\"gasbetter\"><a href=\"https://pubs.acs.org/doi/10.1021/ja00185a046\" target=\"_blank\" rel=\"noopener\">Structure and Acid-base Properties of One-electron-oxidized Deoxyguanosine, Guanosine, and 1-Methylguanosine</a></jump></h1>"},{"title":"Gaussian on Hyak","date":"2018-12-17T04:54:49.000Z","_content":"\n*Here introduces how to setup Gaussian input file, submit it to [Hyak](https://wiki.cac.washington.edu/display/hyakusers/WIKI+for+Hyak+users) (super computer server) and analyze the output file by my python scripts. Scripts attached here are not limited by python versions.*\n\n# Gaussian 16 Input\n\n[Gaussian 16 input](http://gaussian.com/input/) consists of a series of lines in an ASCII text file. In general, the input is free-format and case-insensitive; comments start with an exclamation point(!), could be anywhere on a line; spaces, commas, tabs and forward slashes are all considered as valid delimiters (multi spaces are treated as a single demiliter); keyword=option,kw(op),kw=(op1,op2,...) and kw(op1,op2) are all correct. The common suffixes of the input file are gjf and com. The basic structure includes several different sections:\n\n## <font size=3>[Link 0 Commands](http://gaussian.com/link0/)</font>\n- locate and name scratch files \n- not blank line terminated\n- examples\n  - %LindaWorker\n    - add it when using 2 or more nodes on Hyak\n  - %NProcShared=*N*\n    - use up to N processors/cores on shared memory on one node\n    - default: 28 on Hyak-mox, 16 on Hyak-ikt\n  - %UseSSH\n    - start linda workers by ssh instead of rsh(default)\n    - rsh, remote shell, can execute command on another computer as another user\n    - ssh: a more secure way to communicate between computers\n    - some parallel jobs may mess up by using rsh\n  - %Mem=*N*\n    - set the dynamics of memory, can follow by MB,GB,etc. 800mb for g16 by default\n    - some gaussian jobs will select the appropriate algorithm automatically based on the setting of %Mem and [MaxDisk](#maxdisk).\n    - specifing more mem than availble will cause very poor performance; leave several GBs for operating system\n  - %RWF=*file*\n    - locate and name the  read-write file, a super huge file, used to [restart](http://gaussian.com/restart/) a job(not need for opt)\n    - usually followed by *`%NoSave`*, everything before nosave will deleted if job completes normally\n    - a suggested location  on Hyak is [`/gscratch/scrubbed/` ](https://wiki.cac.washington.edu/display/hyakusers/Hyak_disk_quota)\n    - how to locate it if not include %RWF(Hyak version):\n      - all scratch files are at [`/scr/`](https://wiki.cac.washington.edu/display/hyakusers/Managing+your+Files#ManagingyourFiles-HomeDirectories) of the local node ( `ssh nodenumber` to enter that node)\n      - the scratch disk of that node will be cleaned up after walltime runs out \n      - general version and more about restarting opt and freq jobs: [*click  me*](http://gaussian.com/faq2/)\n    - Related key word: [MaxDisk](#maxdisk)\n  - %Chk=*file*\n    - locate and name the checkpoint file\n    - used to restart jobs(especially [opt](#rstopt)), [add more states for td](#addtd) and [visualize molecular orbitals for td](#vistd)\n  - %OldChk=*file*\n    - use with *`%Chk=newfile`*: copy *file* to *newfile* and then write new chk info to *newfile*\n\n## <font size=3>[Route section (# lines)](http://gaussian.com/route/)</font>\n- job type and method\n- blank line terminated\n- examples\n  - print form\n    - *`#N`*: normal print, by default if not specify\n    - *`#P`*: print more info\n    - *`#T`*: terse print \n  - job type\n    - *[SP](http://gaussian.com/sp/)* : single point energy, by default if not specify\n    - *[OPT](http://gaussian.com/opt/)* : geometry optimization\n    - *[FREQ](http://gaussian.com/freq/)* : vibrational frequency and thermal information\n    - *[TD(NStates=n)](http://gaussian.com/td/)* : calculate n excited transitions\n  - other keywords\n    - [POP](http://gaussian.com/population/)\n      - charge and spin distribution\n      - `pop=min` by default except guess=only\n    - [SCF](http://gaussian.com/scf/)\n      - control the functioning of the SCF procedure\n      - `scf=tight` by default\n      - `scf=xqc` is helpful for difficult conversion case\n      - `NoSymm` or `Symmetry=None`: release orbital symmetry constraints\n    - [SCRF](http://gaussian.com/scrf/)\n      - in the presence of solvent, place solute in a cavity within the solvent reaction field.\n       - `scrf=pcm` by default\n       - ex: `scrf=(pcm,solvent=water)`\n    - [CacheSize](http://gaussian.com/cachesize/)\n      - the amount of cache per processor to use with various cache-blocking algorithms (in 8-byte words)\n      - ex: from `/proc/cpuinfo` find the cache available(35840kb) and a good value is its 50% ( $35840\\times1024\\div8\\times50\\%=2293760$): `cachesize=2293760`\n    - [<jump id='maxdisk'>MaxDisk</jump>](http://gaussian.com/maxdisk/)\n      - the amount of disk storage available for [scratch data](https://gaussian.com/running/?tabid=6) \n      - disk space of one node on Hyak is ~100GB. `lsblk -d` or `df -h` can show physical disk info of linux system\n      - the more disk space available, the faster the evaluation, especially for MP2. Some jobs have fixed or minimum disk requirments, click [me](http://gaussian.com/maxdisk/) for more info.\n\n## <font size=3>Title section</font>\n- any descriptions within 5 lines\n- avoid special character: @  #  !    _  \\  control characters (especially Ctrl-G)\n- blank line terminated\n\n## <font size=3>[Molecule specification](http://gaussian.com/molspec/)</font>\n- charge, multiplicity, atoms and coordinates\n  - multiplicity\n    - number of possible spin orientations of the total spin\n    - mp=2S+1, S($\\alpha$ electron)=0.5, S($\\beta$ electron)=-0.5\n  - coordinates\n    - x, y and z coordinates in angstrom\n- blank line terminated\n\n## <font size=3>Optinal additional sections</font>\n- additional input\n- blank line terminated\n\n*Example:*\n\n```\n%mem=32GB\n%nprocshared=28\n%chk=guanosine.chk\n# opt um062x/6-31+g(d,p) pop=min scf=(xqc,tight)\n\nComplex guanosine\n\n1 2\nO       -3.094427        1.959361        0.291777\nC       -4.011153        1.021154       -0.267210\nC       -3.292860       -0.293751       -0.453718\nO       -2.175288       -0.104229       -1.347075\n...           ...             ...             ...\nH       -1.180628        1.929546       -0.412585\nH       -3.574938        2.742899        0.582770\nH        1.100354        3.004366        0.220564\n! a blank line must be here\n```\n\n# Submit to Hyak\n\nRun ` ~/Hyak-Gaussian/gaussian-sub.py input_file`, will generate a sbatch file(suffix is sh):\n\n```\n#!/bin/bash\n#SBATCH --job-name=???\n#SBATCH --nodes=1\n\n##needed if ckpt partition or  any partitions with 2 or more nodes\n#SBATCH --ntasks-per-node=??\n\n#SBATCH --time=???:00:00\n\n##larger than %mem in input file\n#SBATCH --mem=???\n\n#SBATCH --workdir=??????\n#SBATCH --partition=???\n#SBATCH --account=???\n\n##turn on email notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=???your email???\n\n# load Gaussian environment\nmodule load contrib/g16.b01\n\n# debugging information\necho \"**** Job Debugging Information ****\"\necho \"This job will run on $SLURM_JOB_NODELIST\"\necho \"\"\necho \"ENVIRONMENT VARIABLES\"\nset\necho \"**********************************************\" \n\n# run Gaussian\ng16 ???input file???\n\nexit 0\n```\n\nRun `sbatch *.sh` to submit it to hyak.\n\n# Output & Analysis\n\n## <font size=4>I. [OPT](http://gaussian.com/opt/)</font>\n\nIf key word `Tight` or `SCF` is in route card, Berny optimization will be used. This kind of output is dilimited by *GradGradGrad...*. The appearance of the following words marks completion of opt, and the final structure is displayed after that. We always want to extract the optimized standard structure for the next step calculation.\n\n```\n         Item               Value     Threshold  Converged?\n Maximum Force            0.000020     0.000450     YES\n RMS     Force            0.000004     0.000300     YES\n Maximum Displacement     0.001510     0.001800     YES\n RMS     Displacement     0.000199     0.001200     YES\n Optimization completed.\n    -- Stationary point found\n```\n\n<jump id='rstopt'></jump>If `Stationary point found` is absent in log file, that means the opt job is ended earlier, maybe because of time limit. In this case, we need to write another restarted input file and submit it again to start from where it left, the route card of which should be `# opt=restart` plus the other keywords in the original input. For example: if the original route card is:`# opt ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)` and the chk file is named as *test.chk*. The new input file is like: \n\n```\n%UseSSH\n%mem=32GB\n%nprocshared=28\n%chk=test.chk\n# Opt=Restart ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)\n! a blank line must be here\n```\n\n### <font size=3>1. [optlog2gjfcom.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/optlog2gjfcom.py)</font>\n\n- *Usage*\n  - `python optlog2gjfcom.py opt_log`\n- *Descriptions*\n  - Uses `Stationary point found` as a key to tell if opt finishes\n  - If finished, locates `Standard orientation` after it, reads charge and multiplicity from the very end and then writes them to a new file in the form of gaussian input, named *test_opt.gjf* if original one is *test$.$com*.\n  - If not  finished, checks if input file in the current directory, gets chk file name from input and then writes the restarted input file just as showed above named with *test_rst.gjf* if original one is *test.gjf*. If original input and chk files not found, it will just stop without doing anything.\n- *Notes* \n  - The default route card for optimized file and link info for both optimized and restarted one are easily to change:\n  \n    ```\n    LINK='%UseSSH\\n%mem=32GB\\n%nprocshared=28\\n'\n    ROUTE='# td(NStates=25) um062x/6-31+g(d,p) pop=min scf=(xqc,tight)'\n    ```\n\n  - A quick way to walk through all log files in one directory:\n    ```\n    for x in *log; do python optlog2gjfcom.py $x; done\n    ```\n\n### <font size=3>2.<jump id='hfenergies'></jump>[HFenergies.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/HFenergies.py)</font>\n\nAnother important information in the output is optimized energy, which is easy to locate by key word *SCF Done*.\n\n- *Usage*\n  - `python HFenergies.py`\n- *Descriptions*\n  - Goes through all **.log* files in the current directory to extract energy\n  - If `Stationary point found` is in the presence of log file, reads the energy after the last `SCF Done`; if not, returns energy=*NA*\n  - Energies are sorted ascendingly and written to *HFenergies.csv* file with corresponding logfile name(without suffix)\n\n## <font size=4>II. [FREQ](http://gaussian.com/freq/)</font>\n\n*3N-6* frequecies can be found in the output file for nonlinear molecules (*3N-5* for linear molecules, *N* is the number of atoms), following by thermochemistry analysis at 298.15K, 1 atm.\nSince the temperature in the Mass Spec is around 310K, we need to extrat all normal modes(frequencies), zero-point vibrational energy(ZPVE) and entropy(S) from the log file and calculate entropy and enthalpy(H) at 310K 1 atm. Also, we correct frequencies by a factor of 0.975.\n\n*Note that the input of freq job should be the optimized structure optimized with the same method and basis set.*\n\n### <font size=3>1.<jump id='freqthermal'></jump>[freq_thermal.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/freq_thermal.py)</font>\n\n- *Usage*\n  - `python freq_thermal.py freq_log`\n- *Descriptions*\n  - Extracts frequencies from log file. If the first frequency is negative or freq not finished, raises error and stops.\n  - Uses partition functions to calculate enthalpy, entropy and heat capacity and writes the result to file named with *test_freq.csv* if *test.log* is given.\n  - *<font color=gray>explanations of calculation(to be writted)</font>*\n\n### <font size=3>2.[CpExtractor.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/CpExtractor.py)</font>\n\nSometimes, we only want to know the heat capacity at constant pressure. This scripts can extract Cp from all *freq.csv files.\n\n- *Usage*\n  - `python CpExtractor.py`\n- *Descriptions*\n  - Goes through all **_freq.csv* files in the working directory and writes the Cp and its file name into a new file *Cp.csv*\n  - If Cp not found, *NA* will be there instead of a number\n  \n### <font size=3>3.[GibbsEnergy.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/GibbsEnergy.py)</font>\n\nAfter finish all opt and freq jobs, we can use energy file got from *HFenergies$.$py* and *ZPVE*, *H* and *S* from *freq_thermal$.$py* to calculate their free energies.\n\n- *Usage*\n  - `python GibbsEnergy.py energyfile`\n- *Descriptions*\n  - Needs energy($E_{elec}$) file got from [HFenergies.py](#'hfenergies') and corresponding *_freq.csv files got from [freq_thermal.py](#'freqthermal') in the same directory. The delimiter of all these files must be comma(by default, don't change it)\n  - Reads structure's name(x) and energy from energy file. The frist row is considered as title, will be skipped. The structure with lowest energy is seen as reference.\n  - Uses x find its freq file: x_freq.csv and reads its 9th row(thermal information); only reads 8th row(title info) for one **_freq.csv*.\n  - $G=E_{elec}+ZPVE_{corr}+H(T)-T\\cdot S(T)$ and $\\Delta G=G-G_{ref}$ are used, the result in $kJ/mol$\n\n## <font size=4>III. [TDDFT](http://gaussian.com/td/)</font>\n\nThe main output of tddft contains the excitation energies, oscillation strength(f, the intensity of that transition) and S\\*\\*2, listed below. A resonable transition should satisfy spin forbidden. For a doublet(multiplicity:2S+1=2) S=0.5, so S\\*\\*2=S(S+1)=0.75. What should be consider is that if not following that rule, the electron flips during the transiton, the total spin momentum S changes from 0.5 to 1.5, and S\\*\\*2=3.75. When running tddft job, the transition is a combination of these two situations, usually the more differ from what S\\*\\*2 should be, the less f is. In our lab, we only keep transitions whose S\\*\\*2<2.6, and use lorentzian equation to calcualte its absorption spectra.\n\n```\n Excited State   1:  2.065-A      2.0123 eV  616.13 nm  f=0.0002  <S**2>=0.816\n     62B -> 70B       -0.10013\n     63B -> 70B       -0.16217\n     63B -> 72B       -0.10120\n     67B -> 70B        0.87674\n     68B -> 70B        0.37169\n```\n\n<jump id='addtd'></jump>In experiment, we measure the action spectra from 210nm to 700nm, so we hope the theoritical one can cover that region. If the last transition energy cannot reach 210nm, we should add more states to it. For example, if the original route card is `# TD(Nstates=30) um062x/6-31+g(d,p) pop=none scf=(xqc,tight)` and its chk file is *test.chk* the new input file should be:\n\n```\n%mem=32GB\n%nprocshared=28\n%oldchk=test.chk\n%chk=test_add.chk\n# TD(add=10) Geom=AllCheck um062x/6-31+g(d,p) pop=none scf=(xqc,tight)\n! a blank line must be here\n```\n\n### <font size=3>1.[tddft_lorentzian.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/tddft_lorentzian.py)</font>\n\n- *Usage*\n  - `python tddft_lorentzian.py td_log`\n- *Descriptions*\n  - Reads all excitated frequencies, oscilation strength and S**2 from log file and checks if the last one is below 210nm.\n  - If not, writes the new input file as shown above named with *test_add.gjf* if original input is *test.gjf*. The original input file and chk file must be in the same directory.\n  - Otherwise, uses S**2=2.6 as a cutoff to choose frequencies and applies lorentzian equation to calculate absorption spectra. The results are written to *test_uvvis.csv* if log named with *test.log*.\n\n### <jump id='vistd'></jump><font size=3>2.[cubegen.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/cubegen.py)</font>\n\nWe can also visualize the molecular orbital if we have tddft chk file. We should first use [`formchk`](http://gaussian.com/formchk/) command to generate fchk file, and then use [`cubegen`](http://gaussian.com/cubegen/) to get the cube file, which can be visualized by Gaussian-View. To use cubegen, we also need to decide the molecular orbital number, for $\\alpha$ orbital, like 68A, just set mo=68. But for $\\beta$ orbital,like 72B, we should find the total number of $\\alpha$ orbitals first. If one molecule has 70 $\\alpha$ electrons(NAE) and 356 virtual $\\alpha$ orbitals(NVA), set mo=498(70+356+72). \n\nIf we run cubegen on the login node, it will take around 1 minutes. Usually we are interested in several orbitals in one or more excited states. In this way, this script comes out. \n\n- *Usage*\n  - `python cubegen.py td_log num_excited_states`\n- *Descriptions*\n  - Finds the name of chk file from log file. If chk file not found, stops and does nothing. If its fchk file not found, writes formchk to a sbatch file. \n  - Finds NAE, NVA and unique molecule orbitals in the specified excited state. And writes corresponding cubegen to a txt file.\n  - Loads parallel environment and cats tasklists( the txt file) to the sbatch file.\n  - Submits it to ckpt partition. It should be finished in several seconds\n- *Example*\n  \n   The transition of the first excited state is listed above. If its log is test.log, NAE+NVA=426. Run `python cubegen.py test.log 1`, we will get 2 files: t1_test.txt and t1_test.sh, and it will submit t1_test.sh to ckpt queue.\n  \n    *t1_test.txt*:\n\n    ```\n    cubegen 0 mo=488 test.fchk test_62B.cube 0 h\n    cubegen 0 mo=489 test.fchk test_63B.cube 0 h\n    cubegen 0 mo=493 test.fchk test_67B.cube 0 h\n    cubegen 0 mo=494 test.fchk test_68B.cube 0 h\n    cubegen 0 mo=496 test.fchk test_70B.cube 0 h\n    cubegen 0 mo=498 test.fchk test_72B.cube 0 h\n    ```\n\n    *t1_test.sh*:\n\n    ```\n    #!/bin/bash\n    #SBATCH --job-name=fchk_cube\n    #SBATCH --nodes=1\n    #SBATCH --ntasks-per-node=28\n    #SBATCH --time=10:00\n    #SBATCH --mem=100G\n    #SBATCH --workdir=/gscratch/stf/yueliu96/test\n    #SBATCH --partition=ckpt\n    #SBATCH --account=stf-ckpt\n\n    echo 'This job will run on' $SLURM_JOB_NODELIST\n    #set up time\n    start=$(date +%s)\n\n    #load Gaussian environment\n    module load contrib/g16.b01\n\n    #use checkpoint file to generte formatted one\n    formchk test.chk\n\n    #load parallel environment\n    module load parallel-20170722\n    cat t1_test_opt.txt | parallel -j 28\n\n    end=$(date +%s)\n    echo 'Elapsed Time: '$(($end-$start))'s'\n    ```\n    After finish, we can get 6 cube files. Transfer them from hyak to your local work directory. We need to use *GaussView* to see how the orbital looks like:\n    - open test.fchk with *GaussView*\n    - click `Result`$\\rightarrow$`Surfaces/Contours`$\\rightarrow$`Cube Actions`$\\rightarrow$`Load Cube`$\\rightarrow$choose one of  your cube files$\\rightarrow$highlight that cube$\\rightarrow$`Surfacec Actions`$\\rightarrow$`New Surface`\n","source":"_posts/Gaussian-on-Hyak.md","raw":"---\ntitle: Gaussian on Hyak\ndate: 2018-12-16 20:54:49\ntags: \n- Hyak\n- ComputChem\n- software\ncategories:\n- Turecek Lab Tutorial\n---\n\n*Here introduces how to setup Gaussian input file, submit it to [Hyak](https://wiki.cac.washington.edu/display/hyakusers/WIKI+for+Hyak+users) (super computer server) and analyze the output file by my python scripts. Scripts attached here are not limited by python versions.*\n\n# Gaussian 16 Input\n\n[Gaussian 16 input](http://gaussian.com/input/) consists of a series of lines in an ASCII text file. In general, the input is free-format and case-insensitive; comments start with an exclamation point(!), could be anywhere on a line; spaces, commas, tabs and forward slashes are all considered as valid delimiters (multi spaces are treated as a single demiliter); keyword=option,kw(op),kw=(op1,op2,...) and kw(op1,op2) are all correct. The common suffixes of the input file are gjf and com. The basic structure includes several different sections:\n\n## <font size=3>[Link 0 Commands](http://gaussian.com/link0/)</font>\n- locate and name scratch files \n- not blank line terminated\n- examples\n  - %LindaWorker\n    - add it when using 2 or more nodes on Hyak\n  - %NProcShared=*N*\n    - use up to N processors/cores on shared memory on one node\n    - default: 28 on Hyak-mox, 16 on Hyak-ikt\n  - %UseSSH\n    - start linda workers by ssh instead of rsh(default)\n    - rsh, remote shell, can execute command on another computer as another user\n    - ssh: a more secure way to communicate between computers\n    - some parallel jobs may mess up by using rsh\n  - %Mem=*N*\n    - set the dynamics of memory, can follow by MB,GB,etc. 800mb for g16 by default\n    - some gaussian jobs will select the appropriate algorithm automatically based on the setting of %Mem and [MaxDisk](#maxdisk).\n    - specifing more mem than availble will cause very poor performance; leave several GBs for operating system\n  - %RWF=*file*\n    - locate and name the  read-write file, a super huge file, used to [restart](http://gaussian.com/restart/) a job(not need for opt)\n    - usually followed by *`%NoSave`*, everything before nosave will deleted if job completes normally\n    - a suggested location  on Hyak is [`/gscratch/scrubbed/` ](https://wiki.cac.washington.edu/display/hyakusers/Hyak_disk_quota)\n    - how to locate it if not include %RWF(Hyak version):\n      - all scratch files are at [`/scr/`](https://wiki.cac.washington.edu/display/hyakusers/Managing+your+Files#ManagingyourFiles-HomeDirectories) of the local node ( `ssh nodenumber` to enter that node)\n      - the scratch disk of that node will be cleaned up after walltime runs out \n      - general version and more about restarting opt and freq jobs: [*click  me*](http://gaussian.com/faq2/)\n    - Related key word: [MaxDisk](#maxdisk)\n  - %Chk=*file*\n    - locate and name the checkpoint file\n    - used to restart jobs(especially [opt](#rstopt)), [add more states for td](#addtd) and [visualize molecular orbitals for td](#vistd)\n  - %OldChk=*file*\n    - use with *`%Chk=newfile`*: copy *file* to *newfile* and then write new chk info to *newfile*\n\n## <font size=3>[Route section (# lines)](http://gaussian.com/route/)</font>\n- job type and method\n- blank line terminated\n- examples\n  - print form\n    - *`#N`*: normal print, by default if not specify\n    - *`#P`*: print more info\n    - *`#T`*: terse print \n  - job type\n    - *[SP](http://gaussian.com/sp/)* : single point energy, by default if not specify\n    - *[OPT](http://gaussian.com/opt/)* : geometry optimization\n    - *[FREQ](http://gaussian.com/freq/)* : vibrational frequency and thermal information\n    - *[TD(NStates=n)](http://gaussian.com/td/)* : calculate n excited transitions\n  - other keywords\n    - [POP](http://gaussian.com/population/)\n      - charge and spin distribution\n      - `pop=min` by default except guess=only\n    - [SCF](http://gaussian.com/scf/)\n      - control the functioning of the SCF procedure\n      - `scf=tight` by default\n      - `scf=xqc` is helpful for difficult conversion case\n      - `NoSymm` or `Symmetry=None`: release orbital symmetry constraints\n    - [SCRF](http://gaussian.com/scrf/)\n      - in the presence of solvent, place solute in a cavity within the solvent reaction field.\n       - `scrf=pcm` by default\n       - ex: `scrf=(pcm,solvent=water)`\n    - [CacheSize](http://gaussian.com/cachesize/)\n      - the amount of cache per processor to use with various cache-blocking algorithms (in 8-byte words)\n      - ex: from `/proc/cpuinfo` find the cache available(35840kb) and a good value is its 50% ( $35840\\times1024\\div8\\times50\\%=2293760$): `cachesize=2293760`\n    - [<jump id='maxdisk'>MaxDisk</jump>](http://gaussian.com/maxdisk/)\n      - the amount of disk storage available for [scratch data](https://gaussian.com/running/?tabid=6) \n      - disk space of one node on Hyak is ~100GB. `lsblk -d` or `df -h` can show physical disk info of linux system\n      - the more disk space available, the faster the evaluation, especially for MP2. Some jobs have fixed or minimum disk requirments, click [me](http://gaussian.com/maxdisk/) for more info.\n\n## <font size=3>Title section</font>\n- any descriptions within 5 lines\n- avoid special character: @  #  !    _  \\  control characters (especially Ctrl-G)\n- blank line terminated\n\n## <font size=3>[Molecule specification](http://gaussian.com/molspec/)</font>\n- charge, multiplicity, atoms and coordinates\n  - multiplicity\n    - number of possible spin orientations of the total spin\n    - mp=2S+1, S($\\alpha$ electron)=0.5, S($\\beta$ electron)=-0.5\n  - coordinates\n    - x, y and z coordinates in angstrom\n- blank line terminated\n\n## <font size=3>Optinal additional sections</font>\n- additional input\n- blank line terminated\n\n*Example:*\n\n```\n%mem=32GB\n%nprocshared=28\n%chk=guanosine.chk\n# opt um062x/6-31+g(d,p) pop=min scf=(xqc,tight)\n\nComplex guanosine\n\n1 2\nO       -3.094427        1.959361        0.291777\nC       -4.011153        1.021154       -0.267210\nC       -3.292860       -0.293751       -0.453718\nO       -2.175288       -0.104229       -1.347075\n...           ...             ...             ...\nH       -1.180628        1.929546       -0.412585\nH       -3.574938        2.742899        0.582770\nH        1.100354        3.004366        0.220564\n! a blank line must be here\n```\n\n# Submit to Hyak\n\nRun ` ~/Hyak-Gaussian/gaussian-sub.py input_file`, will generate a sbatch file(suffix is sh):\n\n```\n#!/bin/bash\n#SBATCH --job-name=???\n#SBATCH --nodes=1\n\n##needed if ckpt partition or  any partitions with 2 or more nodes\n#SBATCH --ntasks-per-node=??\n\n#SBATCH --time=???:00:00\n\n##larger than %mem in input file\n#SBATCH --mem=???\n\n#SBATCH --workdir=??????\n#SBATCH --partition=???\n#SBATCH --account=???\n\n##turn on email notification\n#SBATCH --mail-type=ALL\n#SBATCH --mail-user=???your email???\n\n# load Gaussian environment\nmodule load contrib/g16.b01\n\n# debugging information\necho \"**** Job Debugging Information ****\"\necho \"This job will run on $SLURM_JOB_NODELIST\"\necho \"\"\necho \"ENVIRONMENT VARIABLES\"\nset\necho \"**********************************************\" \n\n# run Gaussian\ng16 ???input file???\n\nexit 0\n```\n\nRun `sbatch *.sh` to submit it to hyak.\n\n# Output & Analysis\n\n## <font size=4>I. [OPT](http://gaussian.com/opt/)</font>\n\nIf key word `Tight` or `SCF` is in route card, Berny optimization will be used. This kind of output is dilimited by *GradGradGrad...*. The appearance of the following words marks completion of opt, and the final structure is displayed after that. We always want to extract the optimized standard structure for the next step calculation.\n\n```\n         Item               Value     Threshold  Converged?\n Maximum Force            0.000020     0.000450     YES\n RMS     Force            0.000004     0.000300     YES\n Maximum Displacement     0.001510     0.001800     YES\n RMS     Displacement     0.000199     0.001200     YES\n Optimization completed.\n    -- Stationary point found\n```\n\n<jump id='rstopt'></jump>If `Stationary point found` is absent in log file, that means the opt job is ended earlier, maybe because of time limit. In this case, we need to write another restarted input file and submit it again to start from where it left, the route card of which should be `# opt=restart` plus the other keywords in the original input. For example: if the original route card is:`# opt ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)` and the chk file is named as *test.chk*. The new input file is like: \n\n```\n%UseSSH\n%mem=32GB\n%nprocshared=28\n%chk=test.chk\n# Opt=Restart ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)\n! a blank line must be here\n```\n\n### <font size=3>1. [optlog2gjfcom.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/optlog2gjfcom.py)</font>\n\n- *Usage*\n  - `python optlog2gjfcom.py opt_log`\n- *Descriptions*\n  - Uses `Stationary point found` as a key to tell if opt finishes\n  - If finished, locates `Standard orientation` after it, reads charge and multiplicity from the very end and then writes them to a new file in the form of gaussian input, named *test_opt.gjf* if original one is *test$.$com*.\n  - If not  finished, checks if input file in the current directory, gets chk file name from input and then writes the restarted input file just as showed above named with *test_rst.gjf* if original one is *test.gjf*. If original input and chk files not found, it will just stop without doing anything.\n- *Notes* \n  - The default route card for optimized file and link info for both optimized and restarted one are easily to change:\n  \n    ```\n    LINK='%UseSSH\\n%mem=32GB\\n%nprocshared=28\\n'\n    ROUTE='# td(NStates=25) um062x/6-31+g(d,p) pop=min scf=(xqc,tight)'\n    ```\n\n  - A quick way to walk through all log files in one directory:\n    ```\n    for x in *log; do python optlog2gjfcom.py $x; done\n    ```\n\n### <font size=3>2.<jump id='hfenergies'></jump>[HFenergies.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/HFenergies.py)</font>\n\nAnother important information in the output is optimized energy, which is easy to locate by key word *SCF Done*.\n\n- *Usage*\n  - `python HFenergies.py`\n- *Descriptions*\n  - Goes through all **.log* files in the current directory to extract energy\n  - If `Stationary point found` is in the presence of log file, reads the energy after the last `SCF Done`; if not, returns energy=*NA*\n  - Energies are sorted ascendingly and written to *HFenergies.csv* file with corresponding logfile name(without suffix)\n\n## <font size=4>II. [FREQ](http://gaussian.com/freq/)</font>\n\n*3N-6* frequecies can be found in the output file for nonlinear molecules (*3N-5* for linear molecules, *N* is the number of atoms), following by thermochemistry analysis at 298.15K, 1 atm.\nSince the temperature in the Mass Spec is around 310K, we need to extrat all normal modes(frequencies), zero-point vibrational energy(ZPVE) and entropy(S) from the log file and calculate entropy and enthalpy(H) at 310K 1 atm. Also, we correct frequencies by a factor of 0.975.\n\n*Note that the input of freq job should be the optimized structure optimized with the same method and basis set.*\n\n### <font size=3>1.<jump id='freqthermal'></jump>[freq_thermal.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/freq_thermal.py)</font>\n\n- *Usage*\n  - `python freq_thermal.py freq_log`\n- *Descriptions*\n  - Extracts frequencies from log file. If the first frequency is negative or freq not finished, raises error and stops.\n  - Uses partition functions to calculate enthalpy, entropy and heat capacity and writes the result to file named with *test_freq.csv* if *test.log* is given.\n  - *<font color=gray>explanations of calculation(to be writted)</font>*\n\n### <font size=3>2.[CpExtractor.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/CpExtractor.py)</font>\n\nSometimes, we only want to know the heat capacity at constant pressure. This scripts can extract Cp from all *freq.csv files.\n\n- *Usage*\n  - `python CpExtractor.py`\n- *Descriptions*\n  - Goes through all **_freq.csv* files in the working directory and writes the Cp and its file name into a new file *Cp.csv*\n  - If Cp not found, *NA* will be there instead of a number\n  \n### <font size=3>3.[GibbsEnergy.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/GibbsEnergy.py)</font>\n\nAfter finish all opt and freq jobs, we can use energy file got from *HFenergies$.$py* and *ZPVE*, *H* and *S* from *freq_thermal$.$py* to calculate their free energies.\n\n- *Usage*\n  - `python GibbsEnergy.py energyfile`\n- *Descriptions*\n  - Needs energy($E_{elec}$) file got from [HFenergies.py](#'hfenergies') and corresponding *_freq.csv files got from [freq_thermal.py](#'freqthermal') in the same directory. The delimiter of all these files must be comma(by default, don't change it)\n  - Reads structure's name(x) and energy from energy file. The frist row is considered as title, will be skipped. The structure with lowest energy is seen as reference.\n  - Uses x find its freq file: x_freq.csv and reads its 9th row(thermal information); only reads 8th row(title info) for one **_freq.csv*.\n  - $G=E_{elec}+ZPVE_{corr}+H(T)-T\\cdot S(T)$ and $\\Delta G=G-G_{ref}$ are used, the result in $kJ/mol$\n\n## <font size=4>III. [TDDFT](http://gaussian.com/td/)</font>\n\nThe main output of tddft contains the excitation energies, oscillation strength(f, the intensity of that transition) and S\\*\\*2, listed below. A resonable transition should satisfy spin forbidden. For a doublet(multiplicity:2S+1=2) S=0.5, so S\\*\\*2=S(S+1)=0.75. What should be consider is that if not following that rule, the electron flips during the transiton, the total spin momentum S changes from 0.5 to 1.5, and S\\*\\*2=3.75. When running tddft job, the transition is a combination of these two situations, usually the more differ from what S\\*\\*2 should be, the less f is. In our lab, we only keep transitions whose S\\*\\*2<2.6, and use lorentzian equation to calcualte its absorption spectra.\n\n```\n Excited State   1:  2.065-A      2.0123 eV  616.13 nm  f=0.0002  <S**2>=0.816\n     62B -> 70B       -0.10013\n     63B -> 70B       -0.16217\n     63B -> 72B       -0.10120\n     67B -> 70B        0.87674\n     68B -> 70B        0.37169\n```\n\n<jump id='addtd'></jump>In experiment, we measure the action spectra from 210nm to 700nm, so we hope the theoritical one can cover that region. If the last transition energy cannot reach 210nm, we should add more states to it. For example, if the original route card is `# TD(Nstates=30) um062x/6-31+g(d,p) pop=none scf=(xqc,tight)` and its chk file is *test.chk* the new input file should be:\n\n```\n%mem=32GB\n%nprocshared=28\n%oldchk=test.chk\n%chk=test_add.chk\n# TD(add=10) Geom=AllCheck um062x/6-31+g(d,p) pop=none scf=(xqc,tight)\n! a blank line must be here\n```\n\n### <font size=3>1.[tddft_lorentzian.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/tddft_lorentzian.py)</font>\n\n- *Usage*\n  - `python tddft_lorentzian.py td_log`\n- *Descriptions*\n  - Reads all excitated frequencies, oscilation strength and S**2 from log file and checks if the last one is below 210nm.\n  - If not, writes the new input file as shown above named with *test_add.gjf* if original input is *test.gjf*. The original input file and chk file must be in the same directory.\n  - Otherwise, uses S**2=2.6 as a cutoff to choose frequencies and applies lorentzian equation to calculate absorption spectra. The results are written to *test_uvvis.csv* if log named with *test.log*.\n\n### <jump id='vistd'></jump><font size=3>2.[cubegen.py](https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/cubegen.py)</font>\n\nWe can also visualize the molecular orbital if we have tddft chk file. We should first use [`formchk`](http://gaussian.com/formchk/) command to generate fchk file, and then use [`cubegen`](http://gaussian.com/cubegen/) to get the cube file, which can be visualized by Gaussian-View. To use cubegen, we also need to decide the molecular orbital number, for $\\alpha$ orbital, like 68A, just set mo=68. But for $\\beta$ orbital,like 72B, we should find the total number of $\\alpha$ orbitals first. If one molecule has 70 $\\alpha$ electrons(NAE) and 356 virtual $\\alpha$ orbitals(NVA), set mo=498(70+356+72). \n\nIf we run cubegen on the login node, it will take around 1 minutes. Usually we are interested in several orbitals in one or more excited states. In this way, this script comes out. \n\n- *Usage*\n  - `python cubegen.py td_log num_excited_states`\n- *Descriptions*\n  - Finds the name of chk file from log file. If chk file not found, stops and does nothing. If its fchk file not found, writes formchk to a sbatch file. \n  - Finds NAE, NVA and unique molecule orbitals in the specified excited state. And writes corresponding cubegen to a txt file.\n  - Loads parallel environment and cats tasklists( the txt file) to the sbatch file.\n  - Submits it to ckpt partition. It should be finished in several seconds\n- *Example*\n  \n   The transition of the first excited state is listed above. If its log is test.log, NAE+NVA=426. Run `python cubegen.py test.log 1`, we will get 2 files: t1_test.txt and t1_test.sh, and it will submit t1_test.sh to ckpt queue.\n  \n    *t1_test.txt*:\n\n    ```\n    cubegen 0 mo=488 test.fchk test_62B.cube 0 h\n    cubegen 0 mo=489 test.fchk test_63B.cube 0 h\n    cubegen 0 mo=493 test.fchk test_67B.cube 0 h\n    cubegen 0 mo=494 test.fchk test_68B.cube 0 h\n    cubegen 0 mo=496 test.fchk test_70B.cube 0 h\n    cubegen 0 mo=498 test.fchk test_72B.cube 0 h\n    ```\n\n    *t1_test.sh*:\n\n    ```\n    #!/bin/bash\n    #SBATCH --job-name=fchk_cube\n    #SBATCH --nodes=1\n    #SBATCH --ntasks-per-node=28\n    #SBATCH --time=10:00\n    #SBATCH --mem=100G\n    #SBATCH --workdir=/gscratch/stf/yueliu96/test\n    #SBATCH --partition=ckpt\n    #SBATCH --account=stf-ckpt\n\n    echo 'This job will run on' $SLURM_JOB_NODELIST\n    #set up time\n    start=$(date +%s)\n\n    #load Gaussian environment\n    module load contrib/g16.b01\n\n    #use checkpoint file to generte formatted one\n    formchk test.chk\n\n    #load parallel environment\n    module load parallel-20170722\n    cat t1_test_opt.txt | parallel -j 28\n\n    end=$(date +%s)\n    echo 'Elapsed Time: '$(($end-$start))'s'\n    ```\n    After finish, we can get 6 cube files. Transfer them from hyak to your local work directory. We need to use *GaussView* to see how the orbital looks like:\n    - open test.fchk with *GaussView*\n    - click `Result`$\\rightarrow$`Surfaces/Contours`$\\rightarrow$`Cube Actions`$\\rightarrow$`Load Cube`$\\rightarrow$choose one of  your cube files$\\rightarrow$highlight that cube$\\rightarrow$`Surfacec Actions`$\\rightarrow$`New Surface`\n","slug":"Gaussian-on-Hyak","published":1,"updated":"2019-01-04T21:40:09.311Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjqojihr9000sp45k3pjf63wq","content":"<p><em>Here introduces how to setup Gaussian input file, submit it to <a href=\"https://wiki.cac.washington.edu/display/hyakusers/WIKI+for+Hyak+users\" target=\"_blank\" rel=\"noopener\">Hyak</a> (super computer server) and analyze the output file by my python scripts. Scripts attached here are not limited by python versions.</em></p>\n<h1 id=\"Gaussian-16-Input\"><a href=\"#Gaussian-16-Input\" class=\"headerlink\" title=\"Gaussian 16 Input\"></a>Gaussian 16 Input</h1><p><a href=\"http://gaussian.com/input/\" target=\"_blank\" rel=\"noopener\">Gaussian 16 input</a> consists of a series of lines in an ASCII text file. In general, the input is free-format and case-insensitive; comments start with an exclamation point(!), could be anywhere on a line; spaces, commas, tabs and forward slashes are all considered as valid delimiters (multi spaces are treated as a single demiliter); keyword=option,kw(op),kw=(op1,op2,) and kw(op1,op2) are all correct. The common suffixes of the input file are gjf and com. The basic structure includes several different sections:</p>\n<h2 id=\"Link-0-Commands\"><a href=\"#Link-0-Commands\" class=\"headerlink\" title=\"Link 0 Commands\"></a><font size=\"3\"><a href=\"http://gaussian.com/link0/\" target=\"_blank\" rel=\"noopener\">Link 0 Commands</a></font></h2><ul>\n<li>locate and name scratch files </li>\n<li>not blank line terminated</li>\n<li>examples<ul>\n<li>%LindaWorker<ul>\n<li>add it when using 2 or more nodes on Hyak</li>\n</ul>\n</li>\n<li>%NProcShared=<em>N</em><ul>\n<li>use up to N processors/cores on shared memory on one node</li>\n<li>default: 28 on Hyak-mox, 16 on Hyak-ikt</li>\n</ul>\n</li>\n<li>%UseSSH<ul>\n<li>start linda workers by ssh instead of rsh(default)</li>\n<li>rsh, remote shell, can execute command on another computer as another user</li>\n<li>ssh: a more secure way to communicate between computers</li>\n<li>some parallel jobs may mess up by using rsh</li>\n</ul>\n</li>\n<li>%Mem=<em>N</em><ul>\n<li>set the dynamics of memory, can follow by MB,GB,etc. 800mb for g16 by default</li>\n<li>some gaussian jobs will select the appropriate algorithm automatically based on the setting of %Mem and <a href=\"#maxdisk\">MaxDisk</a>.</li>\n<li>specifing more mem than availble will cause very poor performance; leave several GBs for operating system</li>\n</ul>\n</li>\n<li>%RWF=<em>file</em><ul>\n<li>locate and name the  read-write file, a super huge file, used to <a href=\"http://gaussian.com/restart/\" target=\"_blank\" rel=\"noopener\">restart</a> a job(not need for opt)</li>\n<li>usually followed by <em><code>%NoSave</code></em>, everything before nosave will deleted if job completes normally</li>\n<li>a suggested location  on Hyak is <a href=\"https://wiki.cac.washington.edu/display/hyakusers/Hyak_disk_quota\" target=\"_blank\" rel=\"noopener\"><code>/gscratch/scrubbed/</code> </a></li>\n<li>how to locate it if not include %RWF(Hyak version):<ul>\n<li>all scratch files are at <a href=\"https://wiki.cac.washington.edu/display/hyakusers/Managing+your+Files#ManagingyourFiles-HomeDirectories\" target=\"_blank\" rel=\"noopener\"><code>/scr/</code></a> of the local node ( <code>ssh nodenumber</code> to enter that node)</li>\n<li>the scratch disk of that node will be cleaned up after walltime runs out </li>\n<li>general version and more about restarting opt and freq jobs: <a href=\"http://gaussian.com/faq2/\" target=\"_blank\" rel=\"noopener\"><em>click  me</em></a></li>\n</ul>\n</li>\n<li>Related key word: <a href=\"#maxdisk\">MaxDisk</a></li>\n</ul>\n</li>\n<li>%Chk=<em>file</em><ul>\n<li>locate and name the checkpoint file</li>\n<li>used to restart jobs(especially <a href=\"#rstopt\">opt</a>), <a href=\"#addtd\">add more states for td</a> and <a href=\"#vistd\">visualize molecular orbitals for td</a></li>\n</ul>\n</li>\n<li>%OldChk=<em>file</em><ul>\n<li>use with <em><code>%Chk=newfile</code></em>: copy <em>file</em> to <em>newfile</em> and then write new chk info to <em>newfile</em></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Route-section-lines\"><a href=\"#Route-section-lines\" class=\"headerlink\" title=\"Route section (# lines)\"></a><font size=\"3\"><a href=\"http://gaussian.com/route/\" target=\"_blank\" rel=\"noopener\">Route section (# lines)</a></font></h2><ul>\n<li>job type and method</li>\n<li>blank line terminated</li>\n<li>examples<ul>\n<li>print form<ul>\n<li><em><code>#N</code></em>: normal print, by default if not specify</li>\n<li><em><code>#P</code></em>: print more info</li>\n<li><em><code>#T</code></em>: terse print </li>\n</ul>\n</li>\n<li>job type<ul>\n<li><em><a href=\"http://gaussian.com/sp/\" target=\"_blank\" rel=\"noopener\">SP</a></em> : single point energy, by default if not specify</li>\n<li><em><a href=\"http://gaussian.com/opt/\" target=\"_blank\" rel=\"noopener\">OPT</a></em> : geometry optimization</li>\n<li><em><a href=\"http://gaussian.com/freq/\" target=\"_blank\" rel=\"noopener\">FREQ</a></em> : vibrational frequency and thermal information</li>\n<li><em><a href=\"http://gaussian.com/td/\" target=\"_blank\" rel=\"noopener\">TD(NStates=n)</a></em> : calculate n excited transitions</li>\n</ul>\n</li>\n<li>other keywords<ul>\n<li><a href=\"http://gaussian.com/population/\" target=\"_blank\" rel=\"noopener\">POP</a><ul>\n<li>charge and spin distribution</li>\n<li><code>pop=min</code> by default except guess=only</li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/scf/\" target=\"_blank\" rel=\"noopener\">SCF</a><ul>\n<li>control the functioning of the SCF procedure</li>\n<li><code>scf=tight</code> by default</li>\n<li><code>scf=xqc</code> is helpful for difficult conversion case</li>\n<li><code>NoSymm</code> or <code>Symmetry=None</code>: release orbital symmetry constraints</li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/scrf/\" target=\"_blank\" rel=\"noopener\">SCRF</a><ul>\n<li>in the presence of solvent, place solute in a cavity within the solvent reaction field.<ul>\n<li><code>scrf=pcm</code> by default</li>\n<li>ex: <code>scrf=(pcm,solvent=water)</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/cachesize/\" target=\"_blank\" rel=\"noopener\">CacheSize</a><ul>\n<li>the amount of cache per processor to use with various cache-blocking algorithms (in 8-byte words)</li>\n<li>ex: from <code>/proc/cpuinfo</code> find the cache available(35840kb) and a good value is its 50% ( $35840\\times1024\\div8\\times50\\%=2293760$): <code>cachesize=2293760</code></li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/maxdisk/\" target=\"_blank\" rel=\"noopener\"><jump id=\"maxdisk\">MaxDisk</jump></a><ul>\n<li>the amount of disk storage available for <a href=\"https://gaussian.com/running/?tabid=6\" target=\"_blank\" rel=\"noopener\">scratch data</a> </li>\n<li>disk space of one node on Hyak is ~100GB. <code>lsblk -d</code> or <code>df -h</code> can show physical disk info of linux system</li>\n<li>the more disk space available, the faster the evaluation, especially for MP2. Some jobs have fixed or minimum disk requirments, click <a href=\"http://gaussian.com/maxdisk/\" target=\"_blank\" rel=\"noopener\">me</a> for more info.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Title-section\"><a href=\"#Title-section\" class=\"headerlink\" title=\"Title section\"></a><font size=\"3\">Title section</font></h2><ul>\n<li>any descriptions within 5 lines</li>\n<li>avoid special character: @  #  !    _  \\  control characters (especially Ctrl-G)</li>\n<li>blank line terminated</li>\n</ul>\n<h2 id=\"Molecule-specification\"><a href=\"#Molecule-specification\" class=\"headerlink\" title=\"Molecule specification\"></a><font size=\"3\"><a href=\"http://gaussian.com/molspec/\" target=\"_blank\" rel=\"noopener\">Molecule specification</a></font></h2><ul>\n<li>charge, multiplicity, atoms and coordinates<ul>\n<li>multiplicity<ul>\n<li>number of possible spin orientations of the total spin</li>\n<li>mp=2S+1, S($\\alpha$ electron)=0.5, S($\\beta$ electron)=-0.5</li>\n</ul>\n</li>\n<li>coordinates<ul>\n<li>x, y and z coordinates in angstrom</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>blank line terminated</li>\n</ul>\n<h2 id=\"Optinal-additional-sections\"><a href=\"#Optinal-additional-sections\" class=\"headerlink\" title=\"Optinal additional sections\"></a><font size=\"3\">Optinal additional sections</font></h2><ul>\n<li>additional input</li>\n<li>blank line terminated</li>\n</ul>\n<p><em>Example:</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%mem=32GB</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%chk=guanosine.chk</span><br><span class=\"line\"># opt um062x/6-31+g(d,p) pop=min scf=(xqc,tight)</span><br><span class=\"line\"></span><br><span class=\"line\">Complex guanosine</span><br><span class=\"line\"></span><br><span class=\"line\">1 2</span><br><span class=\"line\">O       -3.094427        1.959361        0.291777</span><br><span class=\"line\">C       -4.011153        1.021154       -0.267210</span><br><span class=\"line\">C       -3.292860       -0.293751       -0.453718</span><br><span class=\"line\">O       -2.175288       -0.104229       -1.347075</span><br><span class=\"line\">...           ...             ...             ...</span><br><span class=\"line\">H       -1.180628        1.929546       -0.412585</span><br><span class=\"line\">H       -3.574938        2.742899        0.582770</span><br><span class=\"line\">H        1.100354        3.004366        0.220564</span><br><span class=\"line\">! a blank line must be here</span><br></pre></td></tr></table></figure>\n<h1 id=\"Submit-to-Hyak\"><a href=\"#Submit-to-Hyak\" class=\"headerlink\" title=\"Submit to Hyak\"></a>Submit to Hyak</h1><p>Run <code>~/Hyak-Gaussian/gaussian-sub.py input_file</code>, will generate a sbatch file(suffix is sh):</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=???</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\"></span><br><span class=\"line\">##needed if ckpt partition or  any partitions with 2 or more nodes</span><br><span class=\"line\">#SBATCH --ntasks-per-node=??</span><br><span class=\"line\"></span><br><span class=\"line\">#SBATCH --time=???:00:00</span><br><span class=\"line\"></span><br><span class=\"line\">##larger than %mem in input file</span><br><span class=\"line\">#SBATCH --mem=???</span><br><span class=\"line\"></span><br><span class=\"line\">#SBATCH --workdir=??????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">##turn on email notification</span><br><span class=\"line\">#SBATCH --mail-type=ALL</span><br><span class=\"line\">#SBATCH --mail-user=???your email???</span><br><span class=\"line\"></span><br><span class=\"line\"># load Gaussian environment</span><br><span class=\"line\">module load contrib/g16.b01</span><br><span class=\"line\"></span><br><span class=\"line\"># debugging information</span><br><span class=\"line\">echo &quot;**** Job Debugging Information ****&quot;</span><br><span class=\"line\">echo &quot;This job will run on $SLURM_JOB_NODELIST&quot;</span><br><span class=\"line\">echo &quot;&quot;</span><br><span class=\"line\">echo &quot;ENVIRONMENT VARIABLES&quot;</span><br><span class=\"line\">set</span><br><span class=\"line\">echo &quot;**********************************************&quot; </span><br><span class=\"line\"></span><br><span class=\"line\"># run Gaussian</span><br><span class=\"line\">g16 ???input file???</span><br><span class=\"line\"></span><br><span class=\"line\">exit 0</span><br></pre></td></tr></table></figure>\n<p>Run <code>sbatch *.sh</code> to submit it to hyak.</p>\n<h1 id=\"Output-amp-Analysis\"><a href=\"#Output-amp-Analysis\" class=\"headerlink\" title=\"Output &amp; Analysis\"></a>Output &amp; Analysis</h1><h2 id=\"I-OPT\"><a href=\"#I-OPT\" class=\"headerlink\" title=\"I. OPT\"></a><font size=\"4\">I. <a href=\"http://gaussian.com/opt/\" target=\"_blank\" rel=\"noopener\">OPT</a></font></h2><p>If key word <code>Tight</code> or <code>SCF</code> is in route card, Berny optimization will be used. This kind of output is dilimited by <em>GradGradGrad</em>. The appearance of the following words marks completion of opt, and the final structure is displayed after that. We always want to extract the optimized standard structure for the next step calculation.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">        Item               Value     Threshold  Converged?</span><br><span class=\"line\">Maximum Force            0.000020     0.000450     YES</span><br><span class=\"line\">RMS     Force            0.000004     0.000300     YES</span><br><span class=\"line\">Maximum Displacement     0.001510     0.001800     YES</span><br><span class=\"line\">RMS     Displacement     0.000199     0.001200     YES</span><br><span class=\"line\">Optimization completed.</span><br><span class=\"line\">   -- Stationary point found</span><br></pre></td></tr></table></figure>\n<p><jump id=\"rstopt\"></jump>If <code>Stationary point found</code> is absent in log file, that means the opt job is ended earlier, maybe because of time limit. In this case, we need to write another restarted input file and submit it again to start from where it left, the route card of which should be <code># opt=restart</code> plus the other keywords in the original input. For example: if the original route card is:<code># opt ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)</code> and the chk file is named as <em>test.chk</em>. The new input file is like: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%UseSSH</span><br><span class=\"line\">%mem=32GB</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%chk=test.chk</span><br><span class=\"line\"># Opt=Restart ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)</span><br><span class=\"line\">! a blank line must be here</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-optlog2gjfcom-py\"><a href=\"#1-optlog2gjfcom-py\" class=\"headerlink\" title=\"1. optlog2gjfcom.py\"></a><font size=\"3\">1. <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/optlog2gjfcom.py\" target=\"_blank\" rel=\"noopener\">optlog2gjfcom.py</a></font></h3><ul>\n<li><em>Usage</em><ul>\n<li><code>python optlog2gjfcom.py opt_log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Uses <code>Stationary point found</code> as a key to tell if opt finishes</li>\n<li>If finished, locates <code>Standard orientation</code> after it, reads charge and multiplicity from the very end and then writes them to a new file in the form of gaussian input, named <em>test_opt.gjf</em> if original one is <em>test$.$com</em>.</li>\n<li>If not  finished, checks if input file in the current directory, gets chk file name from input and then writes the restarted input file just as showed above named with <em>test_rst.gjf</em> if original one is <em>test.gjf</em>. If original input and chk files not found, it will just stop without doing anything.</li>\n</ul>\n</li>\n<li><p><em>Notes</em> </p>\n<ul>\n<li><p>The default route card for optimized file and link info for both optimized and restarted one are easily to change:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LINK=&apos;%UseSSH\\n%mem=32GB\\n%nprocshared=28\\n&apos;</span><br><span class=\"line\">ROUTE=&apos;# td(NStates=25) um062x/6-31+g(d,p) pop=min scf=(xqc,tight)&apos;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>A quick way to walk through all log files in one directory:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for x in *log; do python optlog2gjfcom.py $x; done</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-HFenergies-py\"><a href=\"#2-HFenergies-py\" class=\"headerlink\" title=\"2.HFenergies.py\"></a><font size=\"3\">2.<jump id=\"hfenergies\"></jump><a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/HFenergies.py\" target=\"_blank\" rel=\"noopener\">HFenergies.py</a></font></h3><p>Another important information in the output is optimized energy, which is easy to locate by key word <em>SCF Done</em>.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python HFenergies.py</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Goes through all *<em>.log</em> files in the current directory to extract energy</li>\n<li>If <code>Stationary point found</code> is in the presence of log file, reads the energy after the last <code>SCF Done</code>; if not, returns energy=<em>NA</em></li>\n<li>Energies are sorted ascendingly and written to <em>HFenergies.csv</em> file with corresponding logfile name(without suffix)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"II-FREQ\"><a href=\"#II-FREQ\" class=\"headerlink\" title=\"II. FREQ\"></a><font size=\"4\">II. <a href=\"http://gaussian.com/freq/\" target=\"_blank\" rel=\"noopener\">FREQ</a></font></h2><p><em>3N-6</em> frequecies can be found in the output file for nonlinear molecules (<em>3N-5</em> for linear molecules, <em>N</em> is the number of atoms), following by thermochemistry analysis at 298.15K, 1 atm.<br>Since the temperature in the Mass Spec is around 310K, we need to extrat all normal modes(frequencies), zero-point vibrational energy(ZPVE) and entropy(S) from the log file and calculate entropy and enthalpy(H) at 310K 1 atm. Also, we correct frequencies by a factor of 0.975.</p>\n<p><em>Note that the input of freq job should be the optimized structure optimized with the same method and basis set.</em></p>\n<h3 id=\"1-freq-thermal-py\"><a href=\"#1-freq-thermal-py\" class=\"headerlink\" title=\"1.freq_thermal.py\"></a><font size=\"3\">1.<jump id=\"freqthermal\"></jump><a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/freq_thermal.py\" target=\"_blank\" rel=\"noopener\">freq_thermal.py</a></font></h3><ul>\n<li><em>Usage</em><ul>\n<li><code>python freq_thermal.py freq_log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Extracts frequencies from log file. If the first frequency is negative or freq not finished, raises error and stops.</li>\n<li>Uses partition functions to calculate enthalpy, entropy and heat capacity and writes the result to file named with <em>test_freq.csv</em> if <em>test.log</em> is given.</li>\n<li><em><font color=\"gray\">explanations of calculation(to be writted)</font></em></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-CpExtractor-py\"><a href=\"#2-CpExtractor-py\" class=\"headerlink\" title=\"2.CpExtractor.py\"></a><font size=\"3\">2.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/CpExtractor.py\" target=\"_blank\" rel=\"noopener\">CpExtractor.py</a></font></h3><p>Sometimes, we only want to know the heat capacity at constant pressure. This scripts can extract Cp from all *freq.csv files.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python CpExtractor.py</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Goes through all *<em>_freq.csv</em> files in the working directory and writes the Cp and its file name into a new file <em>Cp.csv</em></li>\n<li>If Cp not found, <em>NA</em> will be there instead of a number</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"3-GibbsEnergy-py\"><a href=\"#3-GibbsEnergy-py\" class=\"headerlink\" title=\"3.GibbsEnergy.py\"></a><font size=\"3\">3.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/GibbsEnergy.py\" target=\"_blank\" rel=\"noopener\">GibbsEnergy.py</a></font></h3><p>After finish all opt and freq jobs, we can use energy file got from <em>HFenergies$.$py</em> and <em>ZPVE</em>, <em>H</em> and <em>S</em> from <em>freq_thermal$.$py</em> to calculate their free energies.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python GibbsEnergy.py energyfile</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Needs energy($E_{elec}$) file got from <a href=\"#&#39;hfenergies&#39;\">HFenergies.py</a> and corresponding *_freq.csv files got from <a href=\"#&#39;freqthermal&#39;\">freq_thermal.py</a> in the same directory. The delimiter of all these files must be comma(by default, dont change it)</li>\n<li>Reads structures name(x) and energy from energy file. The frist row is considered as title, will be skipped. The structure with lowest energy is seen as reference.</li>\n<li>Uses x find its freq file: x_freq.csv and reads its 9th row(thermal information); only reads 8th row(title info) for one *<em>_freq.csv</em>.</li>\n<li>$G=E_{elec}+ZPVE_{corr}+H(T)-T\\cdot S(T)$ and $\\Delta G=G-G_{ref}$ are used, the result in $kJ/mol$</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"III-TDDFT\"><a href=\"#III-TDDFT\" class=\"headerlink\" title=\"III. TDDFT\"></a><font size=\"4\">III. <a href=\"http://gaussian.com/td/\" target=\"_blank\" rel=\"noopener\">TDDFT</a></font></h2><p>The main output of tddft contains the excitation energies, oscillation strength(f, the intensity of that transition) and S**2, listed below. A resonable transition should satisfy spin forbidden. For a doublet(multiplicity:2S+1=2) S=0.5, so S**2=S(S+1)=0.75. What should be consider is that if not following that rule, the electron flips during the transiton, the total spin momentum S changes from 0.5 to 1.5, and S**2=3.75. When running tddft job, the transition is a combination of these two situations, usually the more differ from what S**2 should be, the less f is. In our lab, we only keep transitions whose S**2&lt;2.6, and use lorentzian equation to calcualte its absorption spectra.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Excited State   1:  2.065-A      2.0123 eV  616.13 nm  f=0.0002  &lt;S**2&gt;=0.816</span><br><span class=\"line\">    62B -&gt; 70B       -0.10013</span><br><span class=\"line\">    63B -&gt; 70B       -0.16217</span><br><span class=\"line\">    63B -&gt; 72B       -0.10120</span><br><span class=\"line\">    67B -&gt; 70B        0.87674</span><br><span class=\"line\">    68B -&gt; 70B        0.37169</span><br></pre></td></tr></table></figure>\n<p><jump id=\"addtd\"></jump>In experiment, we measure the action spectra from 210nm to 700nm, so we hope the theoritical one can cover that region. If the last transition energy cannot reach 210nm, we should add more states to it. For example, if the original route card is <code># TD(Nstates=30) um062x/6-31+g(d,p) pop=none scf=(xqc,tight)</code> and its chk file is <em>test.chk</em> the new input file should be:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%mem=32GB</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%oldchk=test.chk</span><br><span class=\"line\">%chk=test_add.chk</span><br><span class=\"line\"># TD(add=10) Geom=AllCheck um062x/6-31+g(d,p) pop=none scf=(xqc,tight)</span><br><span class=\"line\">! a blank line must be here</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-tddft-lorentzian-py\"><a href=\"#1-tddft-lorentzian-py\" class=\"headerlink\" title=\"1.tddft_lorentzian.py\"></a><font size=\"3\">1.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/tddft_lorentzian.py\" target=\"_blank\" rel=\"noopener\">tddft_lorentzian.py</a></font></h3><ul>\n<li><em>Usage</em><ul>\n<li><code>python tddft_lorentzian.py td_log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Reads all excitated frequencies, oscilation strength and S**2 from log file and checks if the last one is below 210nm.</li>\n<li>If not, writes the new input file as shown above named with <em>test_add.gjf</em> if original input is <em>test.gjf</em>. The original input file and chk file must be in the same directory.</li>\n<li>Otherwise, uses S*<em>2=2.6 as a cutoff to choose frequencies and applies lorentzian equation to calculate absorption spectra. The results are written to </em>test_uvvis.csv<em> if log named with </em>test.log*.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-cubegen-py\"><a href=\"#2-cubegen-py\" class=\"headerlink\" title=\"2.cubegen.py\"></a><jump id=\"vistd\"></jump><font size=\"3\">2.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/cubegen.py\" target=\"_blank\" rel=\"noopener\">cubegen.py</a></font></h3><p>We can also visualize the molecular orbital if we have tddft chk file. We should first use <a href=\"http://gaussian.com/formchk/\" target=\"_blank\" rel=\"noopener\"><code>formchk</code></a> command to generate fchk file, and then use <a href=\"http://gaussian.com/cubegen/\" target=\"_blank\" rel=\"noopener\"><code>cubegen</code></a> to get the cube file, which can be visualized by Gaussian-View. To use cubegen, we also need to decide the molecular orbital number, for $\\alpha$ orbital, like 68A, just set mo=68. But for $\\beta$ orbital,like 72B, we should find the total number of $\\alpha$ orbitals first. If one molecule has 70 $\\alpha$ electrons(NAE) and 356 virtual $\\alpha$ orbitals(NVA), set mo=498(70+356+72). </p>\n<p>If we run cubegen on the login node, it will take around 1 minutes. Usually we are interested in several orbitals in one or more excited states. In this way, this script comes out. </p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python cubegen.py td_log num_excited_states</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Finds the name of chk file from log file. If chk file not found, stops and does nothing. If its fchk file not found, writes formchk to a sbatch file. </li>\n<li>Finds NAE, NVA and unique molecule orbitals in the specified excited state. And writes corresponding cubegen to a txt file.</li>\n<li>Loads parallel environment and cats tasklists( the txt file) to the sbatch file.</li>\n<li>Submits it to ckpt partition. It should be finished in several seconds</li>\n</ul>\n</li>\n<li><p><em>Example</em></p>\n<p> The transition of the first excited state is listed above. If its log is test.log, NAE+NVA=426. Run <code>python cubegen.py test.log 1</code>, we will get 2 files: t1_test.txt and t1_test.sh, and it will submit t1_test.sh to ckpt queue.</p>\n<p>  <em>t1_test.txt</em>:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cubegen 0 mo=488 test.fchk test_62B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=489 test.fchk test_63B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=493 test.fchk test_67B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=494 test.fchk test_68B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=496 test.fchk test_70B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=498 test.fchk test_72B.cube 0 h</span><br></pre></td></tr></table></figure>\n<p>  <em>t1_test.sh</em>:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=fchk_cube</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --ntasks-per-node=28</span><br><span class=\"line\">#SBATCH --time=10:00</span><br><span class=\"line\">#SBATCH --mem=100G</span><br><span class=\"line\">#SBATCH --workdir=/gscratch/stf/yueliu96/test</span><br><span class=\"line\">#SBATCH --partition=ckpt</span><br><span class=\"line\">#SBATCH --account=stf-ckpt</span><br><span class=\"line\"></span><br><span class=\"line\">echo &apos;This job will run on&apos; $SLURM_JOB_NODELIST</span><br><span class=\"line\">#set up time</span><br><span class=\"line\">start=$(date +%s)</span><br><span class=\"line\"></span><br><span class=\"line\">#load Gaussian environment</span><br><span class=\"line\">module load contrib/g16.b01</span><br><span class=\"line\"></span><br><span class=\"line\">#use checkpoint file to generte formatted one</span><br><span class=\"line\">formchk test.chk</span><br><span class=\"line\"></span><br><span class=\"line\">#load parallel environment</span><br><span class=\"line\">module load parallel-20170722</span><br><span class=\"line\">cat t1_test_opt.txt | parallel -j 28</span><br><span class=\"line\"></span><br><span class=\"line\">end=$(date +%s)</span><br><span class=\"line\">echo &apos;Elapsed Time: &apos;$(($end-$start))&apos;s&apos;</span><br></pre></td></tr></table></figure>\n<p>  After finish, we can get 6 cube files. Transfer them from hyak to your local work directory. We need to use <em>GaussView</em> to see how the orbital looks like:</p>\n<ul>\n<li>open test.fchk with <em>GaussView</em></li>\n<li>click <code>Result</code>$\\rightarrow$<code>Surfaces/Contours</code>$\\rightarrow$<code>Cube Actions</code>$\\rightarrow$<code>Load Cube</code>$\\rightarrow$choose one of  your cube files$\\rightarrow$highlight that cube$\\rightarrow$<code>Surfacec Actions</code>$\\rightarrow$<code>New Surface</code></li>\n</ul>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><em>Here introduces how to setup Gaussian input file, submit it to <a href=\"https://wiki.cac.washington.edu/display/hyakusers/WIKI+for+Hyak+users\" target=\"_blank\" rel=\"noopener\">Hyak</a> (super computer server) and analyze the output file by my python scripts. Scripts attached here are not limited by python versions.</em></p>\n<h1 id=\"Gaussian-16-Input\"><a href=\"#Gaussian-16-Input\" class=\"headerlink\" title=\"Gaussian 16 Input\"></a>Gaussian 16 Input</h1><p><a href=\"http://gaussian.com/input/\" target=\"_blank\" rel=\"noopener\">Gaussian 16 input</a> consists of a series of lines in an ASCII text file. In general, the input is free-format and case-insensitive; comments start with an exclamation point(!), could be anywhere on a line; spaces, commas, tabs and forward slashes are all considered as valid delimiters (multi spaces are treated as a single demiliter); keyword=option,kw(op),kw=(op1,op2,) and kw(op1,op2) are all correct. The common suffixes of the input file are gjf and com. The basic structure includes several different sections:</p>\n<h2 id=\"Link-0-Commands\"><a href=\"#Link-0-Commands\" class=\"headerlink\" title=\"Link 0 Commands\"></a><font size=\"3\"><a href=\"http://gaussian.com/link0/\" target=\"_blank\" rel=\"noopener\">Link 0 Commands</a></font></h2><ul>\n<li>locate and name scratch files </li>\n<li>not blank line terminated</li>\n<li>examples<ul>\n<li>%LindaWorker<ul>\n<li>add it when using 2 or more nodes on Hyak</li>\n</ul>\n</li>\n<li>%NProcShared=<em>N</em><ul>\n<li>use up to N processors/cores on shared memory on one node</li>\n<li>default: 28 on Hyak-mox, 16 on Hyak-ikt</li>\n</ul>\n</li>\n<li>%UseSSH<ul>\n<li>start linda workers by ssh instead of rsh(default)</li>\n<li>rsh, remote shell, can execute command on another computer as another user</li>\n<li>ssh: a more secure way to communicate between computers</li>\n<li>some parallel jobs may mess up by using rsh</li>\n</ul>\n</li>\n<li>%Mem=<em>N</em><ul>\n<li>set the dynamics of memory, can follow by MB,GB,etc. 800mb for g16 by default</li>\n<li>some gaussian jobs will select the appropriate algorithm automatically based on the setting of %Mem and <a href=\"#maxdisk\">MaxDisk</a>.</li>\n<li>specifing more mem than availble will cause very poor performance; leave several GBs for operating system</li>\n</ul>\n</li>\n<li>%RWF=<em>file</em><ul>\n<li>locate and name the  read-write file, a super huge file, used to <a href=\"http://gaussian.com/restart/\" target=\"_blank\" rel=\"noopener\">restart</a> a job(not need for opt)</li>\n<li>usually followed by <em><code>%NoSave</code></em>, everything before nosave will deleted if job completes normally</li>\n<li>a suggested location  on Hyak is <a href=\"https://wiki.cac.washington.edu/display/hyakusers/Hyak_disk_quota\" target=\"_blank\" rel=\"noopener\"><code>/gscratch/scrubbed/</code> </a></li>\n<li>how to locate it if not include %RWF(Hyak version):<ul>\n<li>all scratch files are at <a href=\"https://wiki.cac.washington.edu/display/hyakusers/Managing+your+Files#ManagingyourFiles-HomeDirectories\" target=\"_blank\" rel=\"noopener\"><code>/scr/</code></a> of the local node ( <code>ssh nodenumber</code> to enter that node)</li>\n<li>the scratch disk of that node will be cleaned up after walltime runs out </li>\n<li>general version and more about restarting opt and freq jobs: <a href=\"http://gaussian.com/faq2/\" target=\"_blank\" rel=\"noopener\"><em>click  me</em></a></li>\n</ul>\n</li>\n<li>Related key word: <a href=\"#maxdisk\">MaxDisk</a></li>\n</ul>\n</li>\n<li>%Chk=<em>file</em><ul>\n<li>locate and name the checkpoint file</li>\n<li>used to restart jobs(especially <a href=\"#rstopt\">opt</a>), <a href=\"#addtd\">add more states for td</a> and <a href=\"#vistd\">visualize molecular orbitals for td</a></li>\n</ul>\n</li>\n<li>%OldChk=<em>file</em><ul>\n<li>use with <em><code>%Chk=newfile</code></em>: copy <em>file</em> to <em>newfile</em> and then write new chk info to <em>newfile</em></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Route-section-lines\"><a href=\"#Route-section-lines\" class=\"headerlink\" title=\"Route section (# lines)\"></a><font size=\"3\"><a href=\"http://gaussian.com/route/\" target=\"_blank\" rel=\"noopener\">Route section (# lines)</a></font></h2><ul>\n<li>job type and method</li>\n<li>blank line terminated</li>\n<li>examples<ul>\n<li>print form<ul>\n<li><em><code>#N</code></em>: normal print, by default if not specify</li>\n<li><em><code>#P</code></em>: print more info</li>\n<li><em><code>#T</code></em>: terse print </li>\n</ul>\n</li>\n<li>job type<ul>\n<li><em><a href=\"http://gaussian.com/sp/\" target=\"_blank\" rel=\"noopener\">SP</a></em> : single point energy, by default if not specify</li>\n<li><em><a href=\"http://gaussian.com/opt/\" target=\"_blank\" rel=\"noopener\">OPT</a></em> : geometry optimization</li>\n<li><em><a href=\"http://gaussian.com/freq/\" target=\"_blank\" rel=\"noopener\">FREQ</a></em> : vibrational frequency and thermal information</li>\n<li><em><a href=\"http://gaussian.com/td/\" target=\"_blank\" rel=\"noopener\">TD(NStates=n)</a></em> : calculate n excited transitions</li>\n</ul>\n</li>\n<li>other keywords<ul>\n<li><a href=\"http://gaussian.com/population/\" target=\"_blank\" rel=\"noopener\">POP</a><ul>\n<li>charge and spin distribution</li>\n<li><code>pop=min</code> by default except guess=only</li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/scf/\" target=\"_blank\" rel=\"noopener\">SCF</a><ul>\n<li>control the functioning of the SCF procedure</li>\n<li><code>scf=tight</code> by default</li>\n<li><code>scf=xqc</code> is helpful for difficult conversion case</li>\n<li><code>NoSymm</code> or <code>Symmetry=None</code>: release orbital symmetry constraints</li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/scrf/\" target=\"_blank\" rel=\"noopener\">SCRF</a><ul>\n<li>in the presence of solvent, place solute in a cavity within the solvent reaction field.<ul>\n<li><code>scrf=pcm</code> by default</li>\n<li>ex: <code>scrf=(pcm,solvent=water)</code></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/cachesize/\" target=\"_blank\" rel=\"noopener\">CacheSize</a><ul>\n<li>the amount of cache per processor to use with various cache-blocking algorithms (in 8-byte words)</li>\n<li>ex: from <code>/proc/cpuinfo</code> find the cache available(35840kb) and a good value is its 50% ( $35840\\times1024\\div8\\times50\\%=2293760$): <code>cachesize=2293760</code></li>\n</ul>\n</li>\n<li><a href=\"http://gaussian.com/maxdisk/\" target=\"_blank\" rel=\"noopener\"><jump id=\"maxdisk\">MaxDisk</jump></a><ul>\n<li>the amount of disk storage available for <a href=\"https://gaussian.com/running/?tabid=6\" target=\"_blank\" rel=\"noopener\">scratch data</a> </li>\n<li>disk space of one node on Hyak is ~100GB. <code>lsblk -d</code> or <code>df -h</code> can show physical disk info of linux system</li>\n<li>the more disk space available, the faster the evaluation, especially for MP2. Some jobs have fixed or minimum disk requirments, click <a href=\"http://gaussian.com/maxdisk/\" target=\"_blank\" rel=\"noopener\">me</a> for more info.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Title-section\"><a href=\"#Title-section\" class=\"headerlink\" title=\"Title section\"></a><font size=\"3\">Title section</font></h2><ul>\n<li>any descriptions within 5 lines</li>\n<li>avoid special character: @  #  !    _  \\  control characters (especially Ctrl-G)</li>\n<li>blank line terminated</li>\n</ul>\n<h2 id=\"Molecule-specification\"><a href=\"#Molecule-specification\" class=\"headerlink\" title=\"Molecule specification\"></a><font size=\"3\"><a href=\"http://gaussian.com/molspec/\" target=\"_blank\" rel=\"noopener\">Molecule specification</a></font></h2><ul>\n<li>charge, multiplicity, atoms and coordinates<ul>\n<li>multiplicity<ul>\n<li>number of possible spin orientations of the total spin</li>\n<li>mp=2S+1, S($\\alpha$ electron)=0.5, S($\\beta$ electron)=-0.5</li>\n</ul>\n</li>\n<li>coordinates<ul>\n<li>x, y and z coordinates in angstrom</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>blank line terminated</li>\n</ul>\n<h2 id=\"Optinal-additional-sections\"><a href=\"#Optinal-additional-sections\" class=\"headerlink\" title=\"Optinal additional sections\"></a><font size=\"3\">Optinal additional sections</font></h2><ul>\n<li>additional input</li>\n<li>blank line terminated</li>\n</ul>\n<p><em>Example:</em></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%mem=32GB</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%chk=guanosine.chk</span><br><span class=\"line\"># opt um062x/6-31+g(d,p) pop=min scf=(xqc,tight)</span><br><span class=\"line\"></span><br><span class=\"line\">Complex guanosine</span><br><span class=\"line\"></span><br><span class=\"line\">1 2</span><br><span class=\"line\">O       -3.094427        1.959361        0.291777</span><br><span class=\"line\">C       -4.011153        1.021154       -0.267210</span><br><span class=\"line\">C       -3.292860       -0.293751       -0.453718</span><br><span class=\"line\">O       -2.175288       -0.104229       -1.347075</span><br><span class=\"line\">...           ...             ...             ...</span><br><span class=\"line\">H       -1.180628        1.929546       -0.412585</span><br><span class=\"line\">H       -3.574938        2.742899        0.582770</span><br><span class=\"line\">H        1.100354        3.004366        0.220564</span><br><span class=\"line\">! a blank line must be here</span><br></pre></td></tr></table></figure>\n<h1 id=\"Submit-to-Hyak\"><a href=\"#Submit-to-Hyak\" class=\"headerlink\" title=\"Submit to Hyak\"></a>Submit to Hyak</h1><p>Run <code>~/Hyak-Gaussian/gaussian-sub.py input_file</code>, will generate a sbatch file(suffix is sh):</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=???</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\"></span><br><span class=\"line\">##needed if ckpt partition or  any partitions with 2 or more nodes</span><br><span class=\"line\">#SBATCH --ntasks-per-node=??</span><br><span class=\"line\"></span><br><span class=\"line\">#SBATCH --time=???:00:00</span><br><span class=\"line\"></span><br><span class=\"line\">##larger than %mem in input file</span><br><span class=\"line\">#SBATCH --mem=???</span><br><span class=\"line\"></span><br><span class=\"line\">#SBATCH --workdir=??????</span><br><span class=\"line\">#SBATCH --partition=???</span><br><span class=\"line\">#SBATCH --account=???</span><br><span class=\"line\"></span><br><span class=\"line\">##turn on email notification</span><br><span class=\"line\">#SBATCH --mail-type=ALL</span><br><span class=\"line\">#SBATCH --mail-user=???your email???</span><br><span class=\"line\"></span><br><span class=\"line\"># load Gaussian environment</span><br><span class=\"line\">module load contrib/g16.b01</span><br><span class=\"line\"></span><br><span class=\"line\"># debugging information</span><br><span class=\"line\">echo &quot;**** Job Debugging Information ****&quot;</span><br><span class=\"line\">echo &quot;This job will run on $SLURM_JOB_NODELIST&quot;</span><br><span class=\"line\">echo &quot;&quot;</span><br><span class=\"line\">echo &quot;ENVIRONMENT VARIABLES&quot;</span><br><span class=\"line\">set</span><br><span class=\"line\">echo &quot;**********************************************&quot; </span><br><span class=\"line\"></span><br><span class=\"line\"># run Gaussian</span><br><span class=\"line\">g16 ???input file???</span><br><span class=\"line\"></span><br><span class=\"line\">exit 0</span><br></pre></td></tr></table></figure>\n<p>Run <code>sbatch *.sh</code> to submit it to hyak.</p>\n<h1 id=\"Output-amp-Analysis\"><a href=\"#Output-amp-Analysis\" class=\"headerlink\" title=\"Output &amp; Analysis\"></a>Output &amp; Analysis</h1><h2 id=\"I-OPT\"><a href=\"#I-OPT\" class=\"headerlink\" title=\"I. OPT\"></a><font size=\"4\">I. <a href=\"http://gaussian.com/opt/\" target=\"_blank\" rel=\"noopener\">OPT</a></font></h2><p>If key word <code>Tight</code> or <code>SCF</code> is in route card, Berny optimization will be used. This kind of output is dilimited by <em>GradGradGrad</em>. The appearance of the following words marks completion of opt, and the final structure is displayed after that. We always want to extract the optimized standard structure for the next step calculation.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">        Item               Value     Threshold  Converged?</span><br><span class=\"line\">Maximum Force            0.000020     0.000450     YES</span><br><span class=\"line\">RMS     Force            0.000004     0.000300     YES</span><br><span class=\"line\">Maximum Displacement     0.001510     0.001800     YES</span><br><span class=\"line\">RMS     Displacement     0.000199     0.001200     YES</span><br><span class=\"line\">Optimization completed.</span><br><span class=\"line\">   -- Stationary point found</span><br></pre></td></tr></table></figure>\n<p><jump id=\"rstopt\"></jump>If <code>Stationary point found</code> is absent in log file, that means the opt job is ended earlier, maybe because of time limit. In this case, we need to write another restarted input file and submit it again to start from where it left, the route card of which should be <code># opt=restart</code> plus the other keywords in the original input. For example: if the original route card is:<code># opt ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)</code> and the chk file is named as <em>test.chk</em>. The new input file is like: </p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%UseSSH</span><br><span class=\"line\">%mem=32GB</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%chk=test.chk</span><br><span class=\"line\"># Opt=Restart ub3lyp/6-31+g(d,p) pop=min scf=(xqc,tight)</span><br><span class=\"line\">! a blank line must be here</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-optlog2gjfcom-py\"><a href=\"#1-optlog2gjfcom-py\" class=\"headerlink\" title=\"1. optlog2gjfcom.py\"></a><font size=\"3\">1. <a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/optlog2gjfcom.py\" target=\"_blank\" rel=\"noopener\">optlog2gjfcom.py</a></font></h3><ul>\n<li><em>Usage</em><ul>\n<li><code>python optlog2gjfcom.py opt_log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Uses <code>Stationary point found</code> as a key to tell if opt finishes</li>\n<li>If finished, locates <code>Standard orientation</code> after it, reads charge and multiplicity from the very end and then writes them to a new file in the form of gaussian input, named <em>test_opt.gjf</em> if original one is <em>test$.$com</em>.</li>\n<li>If not  finished, checks if input file in the current directory, gets chk file name from input and then writes the restarted input file just as showed above named with <em>test_rst.gjf</em> if original one is <em>test.gjf</em>. If original input and chk files not found, it will just stop without doing anything.</li>\n</ul>\n</li>\n<li><p><em>Notes</em> </p>\n<ul>\n<li><p>The default route card for optimized file and link info for both optimized and restarted one are easily to change:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LINK=&apos;%UseSSH\\n%mem=32GB\\n%nprocshared=28\\n&apos;</span><br><span class=\"line\">ROUTE=&apos;# td(NStates=25) um062x/6-31+g(d,p) pop=min scf=(xqc,tight)&apos;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>A quick way to walk through all log files in one directory:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for x in *log; do python optlog2gjfcom.py $x; done</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-HFenergies-py\"><a href=\"#2-HFenergies-py\" class=\"headerlink\" title=\"2.HFenergies.py\"></a><font size=\"3\">2.<jump id=\"hfenergies\"></jump><a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/HFenergies.py\" target=\"_blank\" rel=\"noopener\">HFenergies.py</a></font></h3><p>Another important information in the output is optimized energy, which is easy to locate by key word <em>SCF Done</em>.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python HFenergies.py</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Goes through all *<em>.log</em> files in the current directory to extract energy</li>\n<li>If <code>Stationary point found</code> is in the presence of log file, reads the energy after the last <code>SCF Done</code>; if not, returns energy=<em>NA</em></li>\n<li>Energies are sorted ascendingly and written to <em>HFenergies.csv</em> file with corresponding logfile name(without suffix)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"II-FREQ\"><a href=\"#II-FREQ\" class=\"headerlink\" title=\"II. FREQ\"></a><font size=\"4\">II. <a href=\"http://gaussian.com/freq/\" target=\"_blank\" rel=\"noopener\">FREQ</a></font></h2><p><em>3N-6</em> frequecies can be found in the output file for nonlinear molecules (<em>3N-5</em> for linear molecules, <em>N</em> is the number of atoms), following by thermochemistry analysis at 298.15K, 1 atm.<br>Since the temperature in the Mass Spec is around 310K, we need to extrat all normal modes(frequencies), zero-point vibrational energy(ZPVE) and entropy(S) from the log file and calculate entropy and enthalpy(H) at 310K 1 atm. Also, we correct frequencies by a factor of 0.975.</p>\n<p><em>Note that the input of freq job should be the optimized structure optimized with the same method and basis set.</em></p>\n<h3 id=\"1-freq-thermal-py\"><a href=\"#1-freq-thermal-py\" class=\"headerlink\" title=\"1.freq_thermal.py\"></a><font size=\"3\">1.<jump id=\"freqthermal\"></jump><a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/freq_thermal.py\" target=\"_blank\" rel=\"noopener\">freq_thermal.py</a></font></h3><ul>\n<li><em>Usage</em><ul>\n<li><code>python freq_thermal.py freq_log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Extracts frequencies from log file. If the first frequency is negative or freq not finished, raises error and stops.</li>\n<li>Uses partition functions to calculate enthalpy, entropy and heat capacity and writes the result to file named with <em>test_freq.csv</em> if <em>test.log</em> is given.</li>\n<li><em><font color=\"gray\">explanations of calculation(to be writted)</font></em></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-CpExtractor-py\"><a href=\"#2-CpExtractor-py\" class=\"headerlink\" title=\"2.CpExtractor.py\"></a><font size=\"3\">2.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/CpExtractor.py\" target=\"_blank\" rel=\"noopener\">CpExtractor.py</a></font></h3><p>Sometimes, we only want to know the heat capacity at constant pressure. This scripts can extract Cp from all *freq.csv files.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python CpExtractor.py</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Goes through all *<em>_freq.csv</em> files in the working directory and writes the Cp and its file name into a new file <em>Cp.csv</em></li>\n<li>If Cp not found, <em>NA</em> will be there instead of a number</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"3-GibbsEnergy-py\"><a href=\"#3-GibbsEnergy-py\" class=\"headerlink\" title=\"3.GibbsEnergy.py\"></a><font size=\"3\">3.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/GibbsEnergy.py\" target=\"_blank\" rel=\"noopener\">GibbsEnergy.py</a></font></h3><p>After finish all opt and freq jobs, we can use energy file got from <em>HFenergies$.$py</em> and <em>ZPVE</em>, <em>H</em> and <em>S</em> from <em>freq_thermal$.$py</em> to calculate their free energies.</p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python GibbsEnergy.py energyfile</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Needs energy($E_{elec}$) file got from <a href=\"#&#39;hfenergies&#39;\">HFenergies.py</a> and corresponding *_freq.csv files got from <a href=\"#&#39;freqthermal&#39;\">freq_thermal.py</a> in the same directory. The delimiter of all these files must be comma(by default, dont change it)</li>\n<li>Reads structures name(x) and energy from energy file. The frist row is considered as title, will be skipped. The structure with lowest energy is seen as reference.</li>\n<li>Uses x find its freq file: x_freq.csv and reads its 9th row(thermal information); only reads 8th row(title info) for one *<em>_freq.csv</em>.</li>\n<li>$G=E_{elec}+ZPVE_{corr}+H(T)-T\\cdot S(T)$ and $\\Delta G=G-G_{ref}$ are used, the result in $kJ/mol$</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"III-TDDFT\"><a href=\"#III-TDDFT\" class=\"headerlink\" title=\"III. TDDFT\"></a><font size=\"4\">III. <a href=\"http://gaussian.com/td/\" target=\"_blank\" rel=\"noopener\">TDDFT</a></font></h2><p>The main output of tddft contains the excitation energies, oscillation strength(f, the intensity of that transition) and S**2, listed below. A resonable transition should satisfy spin forbidden. For a doublet(multiplicity:2S+1=2) S=0.5, so S**2=S(S+1)=0.75. What should be consider is that if not following that rule, the electron flips during the transiton, the total spin momentum S changes from 0.5 to 1.5, and S**2=3.75. When running tddft job, the transition is a combination of these two situations, usually the more differ from what S**2 should be, the less f is. In our lab, we only keep transitions whose S**2&lt;2.6, and use lorentzian equation to calcualte its absorption spectra.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Excited State   1:  2.065-A      2.0123 eV  616.13 nm  f=0.0002  &lt;S**2&gt;=0.816</span><br><span class=\"line\">    62B -&gt; 70B       -0.10013</span><br><span class=\"line\">    63B -&gt; 70B       -0.16217</span><br><span class=\"line\">    63B -&gt; 72B       -0.10120</span><br><span class=\"line\">    67B -&gt; 70B        0.87674</span><br><span class=\"line\">    68B -&gt; 70B        0.37169</span><br></pre></td></tr></table></figure>\n<p><jump id=\"addtd\"></jump>In experiment, we measure the action spectra from 210nm to 700nm, so we hope the theoritical one can cover that region. If the last transition energy cannot reach 210nm, we should add more states to it. For example, if the original route card is <code># TD(Nstates=30) um062x/6-31+g(d,p) pop=none scf=(xqc,tight)</code> and its chk file is <em>test.chk</em> the new input file should be:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%mem=32GB</span><br><span class=\"line\">%nprocshared=28</span><br><span class=\"line\">%oldchk=test.chk</span><br><span class=\"line\">%chk=test_add.chk</span><br><span class=\"line\"># TD(add=10) Geom=AllCheck um062x/6-31+g(d,p) pop=none scf=(xqc,tight)</span><br><span class=\"line\">! a blank line must be here</span><br></pre></td></tr></table></figure>\n<h3 id=\"1-tddft-lorentzian-py\"><a href=\"#1-tddft-lorentzian-py\" class=\"headerlink\" title=\"1.tddft_lorentzian.py\"></a><font size=\"3\">1.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/tddft_lorentzian.py\" target=\"_blank\" rel=\"noopener\">tddft_lorentzian.py</a></font></h3><ul>\n<li><em>Usage</em><ul>\n<li><code>python tddft_lorentzian.py td_log</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Reads all excitated frequencies, oscilation strength and S**2 from log file and checks if the last one is below 210nm.</li>\n<li>If not, writes the new input file as shown above named with <em>test_add.gjf</em> if original input is <em>test.gjf</em>. The original input file and chk file must be in the same directory.</li>\n<li>Otherwise, uses S*<em>2=2.6 as a cutoff to choose frequencies and applies lorentzian equation to calculate absorption spectra. The results are written to </em>test_uvvis.csv<em> if log named with </em>test.log*.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-cubegen-py\"><a href=\"#2-cubegen-py\" class=\"headerlink\" title=\"2.cubegen.py\"></a><jump id=\"vistd\"></jump><font size=\"3\">2.<a href=\"https://raw.githubusercontent.com/yueliu96/scripts_for_lab/master/cubegen.py\" target=\"_blank\" rel=\"noopener\">cubegen.py</a></font></h3><p>We can also visualize the molecular orbital if we have tddft chk file. We should first use <a href=\"http://gaussian.com/formchk/\" target=\"_blank\" rel=\"noopener\"><code>formchk</code></a> command to generate fchk file, and then use <a href=\"http://gaussian.com/cubegen/\" target=\"_blank\" rel=\"noopener\"><code>cubegen</code></a> to get the cube file, which can be visualized by Gaussian-View. To use cubegen, we also need to decide the molecular orbital number, for $\\alpha$ orbital, like 68A, just set mo=68. But for $\\beta$ orbital,like 72B, we should find the total number of $\\alpha$ orbitals first. If one molecule has 70 $\\alpha$ electrons(NAE) and 356 virtual $\\alpha$ orbitals(NVA), set mo=498(70+356+72). </p>\n<p>If we run cubegen on the login node, it will take around 1 minutes. Usually we are interested in several orbitals in one or more excited states. In this way, this script comes out. </p>\n<ul>\n<li><em>Usage</em><ul>\n<li><code>python cubegen.py td_log num_excited_states</code></li>\n</ul>\n</li>\n<li><em>Descriptions</em><ul>\n<li>Finds the name of chk file from log file. If chk file not found, stops and does nothing. If its fchk file not found, writes formchk to a sbatch file. </li>\n<li>Finds NAE, NVA and unique molecule orbitals in the specified excited state. And writes corresponding cubegen to a txt file.</li>\n<li>Loads parallel environment and cats tasklists( the txt file) to the sbatch file.</li>\n<li>Submits it to ckpt partition. It should be finished in several seconds</li>\n</ul>\n</li>\n<li><p><em>Example</em></p>\n<p> The transition of the first excited state is listed above. If its log is test.log, NAE+NVA=426. Run <code>python cubegen.py test.log 1</code>, we will get 2 files: t1_test.txt and t1_test.sh, and it will submit t1_test.sh to ckpt queue.</p>\n<p>  <em>t1_test.txt</em>:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cubegen 0 mo=488 test.fchk test_62B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=489 test.fchk test_63B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=493 test.fchk test_67B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=494 test.fchk test_68B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=496 test.fchk test_70B.cube 0 h</span><br><span class=\"line\">cubegen 0 mo=498 test.fchk test_72B.cube 0 h</span><br></pre></td></tr></table></figure>\n<p>  <em>t1_test.sh</em>:</p>\n  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\">#SBATCH --job-name=fchk_cube</span><br><span class=\"line\">#SBATCH --nodes=1</span><br><span class=\"line\">#SBATCH --ntasks-per-node=28</span><br><span class=\"line\">#SBATCH --time=10:00</span><br><span class=\"line\">#SBATCH --mem=100G</span><br><span class=\"line\">#SBATCH --workdir=/gscratch/stf/yueliu96/test</span><br><span class=\"line\">#SBATCH --partition=ckpt</span><br><span class=\"line\">#SBATCH --account=stf-ckpt</span><br><span class=\"line\"></span><br><span class=\"line\">echo &apos;This job will run on&apos; $SLURM_JOB_NODELIST</span><br><span class=\"line\">#set up time</span><br><span class=\"line\">start=$(date +%s)</span><br><span class=\"line\"></span><br><span class=\"line\">#load Gaussian environment</span><br><span class=\"line\">module load contrib/g16.b01</span><br><span class=\"line\"></span><br><span class=\"line\">#use checkpoint file to generte formatted one</span><br><span class=\"line\">formchk test.chk</span><br><span class=\"line\"></span><br><span class=\"line\">#load parallel environment</span><br><span class=\"line\">module load parallel-20170722</span><br><span class=\"line\">cat t1_test_opt.txt | parallel -j 28</span><br><span class=\"line\"></span><br><span class=\"line\">end=$(date +%s)</span><br><span class=\"line\">echo &apos;Elapsed Time: &apos;$(($end-$start))&apos;s&apos;</span><br></pre></td></tr></table></figure>\n<p>  After finish, we can get 6 cube files. Transfer them from hyak to your local work directory. We need to use <em>GaussView</em> to see how the orbital looks like:</p>\n<ul>\n<li>open test.fchk with <em>GaussView</em></li>\n<li>click <code>Result</code>$\\rightarrow$<code>Surfaces/Contours</code>$\\rightarrow$<code>Cube Actions</code>$\\rightarrow$<code>Load Cube</code>$\\rightarrow$choose one of  your cube files$\\rightarrow$highlight that cube$\\rightarrow$<code>Surfacec Actions</code>$\\rightarrow$<code>New Surface</code></li>\n</ul>\n</li>\n</ul>\n"},{"title":"Scientific Computing","date":"2019-01-02T21:28:18.000Z","_content":"\n*A manual for individual use, which focuses on how to solve ordinary and partial differential equation numerically, including how to solve initial value problem with Euler, 2nd- and 4th- order Runge-Kutta and Adams-Bashford method; how to handle boundary value problem with shooting method and direct method and how to deal with PDE with finite difference schemes and spectral methods. Quantum Harmonic Oscillator, Vorticity-Streamfunction Equations, Reaction-Diffusion Systems are are discussed.*\n\n# Initial Value Problem\n\n$$\n\\frac{d\\overrightarrow{y}}{dt}=f(t,\\overrightarrow{y}) \\quad \\overrightarrow{y}(0)=\\overrightarrow{y_0} \\quad t\\in[0,T]\n$$\n\n## Forward Euler Method\n\nThis is the simplest algorithm for solving this problem, which is derived from the definition of the derivative:\n\n$$\n\\frac{d\\overrightarrow y}{dt}=\\lim_{\\Delta t \\to 0} \\frac{\\Delta\\overrightarrow y}{\\Delta t} \\approx \\frac{\\overrightarrow y_{n+1}-\\overrightarrow y_n}{t_{n+1}-t_n}\n$$\n\nFrom the above equation, we can get:\n\n$$\n\\overrightarrow{y}_{n+1} = \\overrightarrow y_n + \\Delta t \\cdot f(t_n,\\overrightarrow y_n)\n$$\n\nNote that each subsequenct approximation in Euler Method is generated from the slope of the previous point. Considering the error coulde be very large, we need to find some ways to improve it.\n\n## Improved from Euler Method\n\n One way we can think of is to use the slope of other points instead of that of the previous one to predict the next point. For example, the average slope (Heun's Method), or the slope of the midpoint (RK2).\n \n### Heun's \n  \n  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_n,y_n)+f(t_{n+1},y_{n+1})]$$\n\n### RK2 \n  \n  $$y_{n+1}=y_n+\\Delta t \\cdot f[t_n+\\frac{\\Delta t}{2},y(t_n+\\frac{\\Delta t}{2})]$$\n\n### In general \n  \n  $$y_{n+1}=y_n+\\Delta t[A \\cdot f(t_n,y_n)+B \\cdot f(t+P\\Delta t,y_n+Q\\Delta t \\cdot f(t_n,y_n)]\\\\where\\quad A+B=1\\quad B\\cdot P=\\frac{1}{2}\\quad B\\cdot Q=\\frac{1}{2}$$\n\n- If $A=\\frac{1}{2}\\Rightarrow B=\\frac{1}{2}\\Rightarrow P=1\\Rightarrow Q=1\\Rightarrow$Heun's Method\n- If $A=0\\Rightarrow B=0\\Rightarrow P=\\frac{1}{2}\\Rightarrow Q=\\frac{1}{2}\\Rightarrow$RK2 Method\n  \n### RK4\n  \n$$y_{n+1}=y_n+\\frac{\\Delta t}{6}(f_1+2f_2+2f_3+f_4)\\\\\nf_1=f(t_n,y_n)\\\\\nf_2=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_1)\\\\\nf_3=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_2)\\\\\nf_4=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_3)$$\n\n### Summary and Error Analysis\n\n| Scheme | Local Error | Global Error | Matlab | Python\n|----|----|----|----|----|\n|Forward Euler|$\\Delta t^2$|$\\Delta t$||\n|Heun's/RK2|$\\Delta t^3$|$\\Delta t^2$|ode23|Method=RK23\n|RK4|$\\Delta t^5$|$\\Delta t^4$|ode45|Method=RK45\n\nThe error in numerical algorithm not only comes from the local error (truncated error) in the algorithm iteself, but also arises from round off error since computer can only keep limit digits of number: $Error_{total}=\\varepsilon_{round\\ off}+\\varepsilon_{truncate}$. If the round-off error is dominant, our algorithm can be unstable to be used. That's why Backward Euler Method is introduced.\n\n## Backward Euler Method\n\nIt is an implicit method, which is more stable\n\n$$y_n=y_{n+1}-\\Delta t \\cdot f(t_{n+1},y_{n+1})$$\n\nExample:\n\n$$\\frac{dy}{dt}=\\lambda y\\quad y(0)=y_0$$\n\n- FE:\n  $$y_{n+1}=y_n+\\Delta t \\cdot f(t_n,y_n)=y_n+\\Delta t \\cdot \\lambda y \\Rightarrow y_n=(y_0+\\varepsilon_{round\\_off})(1+\\Delta t \\lambda)^N$$\n  set  $r_{FE}=(1+\\Delta t \\lambda)^N\\Rightarrow y_n=y_0\\cdot r_{FE}^N+\\varepsilon_{round\\_off}\\cdot r_{FE}^N$\n  \n  - $\\lambda>0\\Rightarrow |r_{FE}|>1\\Rightarrow$ unconditionally unstable\n  - $\\lambda<0\\Rightarrow |r_{FE}|<1\\Rightarrow \\begin{cases} \\Delta t<\\frac{2}{|\\lambda|} & stable\\\\ \\Delta t>\\frac{2}{|\\lambda|} & unsatble\\\\ \\end{cases}$\n  \n- BE:\n  \n  $$y_n=y_{n+1}-\\Delta t\\cdot \\lambda\\cdot y_{n+1}\\Rightarrow y_{n+1}=r_{BE}\\cdot y_n,\\ where\\ r_{BE}=\\frac{1}{1-\\Delta t\\lambda}\n  \\\\y_n=y_0\\cdot r_{BE}^N+\\varepsilon_{round\\_off}\\cdot r_{BE}^N$$\n    - $\\lambda<0\\Rightarrow |r_{FE}|<1\\Rightarrow$ unconditionally stable\n    - $\\lambda>0\\Rightarrow |r_{FE}|<1\\Rightarrow \\begin{cases} \\Delta t>\\frac{2}{|\\lambda|} & stable\\\\ \\Delta t<\\frac{2}{|\\lambda|} & unsatble\\\\ \\end{cases}$\n \n## MultiStep Method\n\n - Adams-Bash forth (explicit method)\n  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})$$ \n - Adams-Moulthon (implicit method)\n  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}(f_{n+1}+f_n)$$\n - Predictor-Corrector\n  $$y_{n+1}^P=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})\\\\y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_{n+1},y_{n+1}^P)+f_n]$$\n\n## Matlab for ODE45\n\nsolve this equation $\\frac{d^2y(t)}{dt^2}+\\epsilon[y^2(t)-1]\\frac{dy(t)}{dt}+y(t)=0$ with $\\epsilon$=0.1, t=[0:0.5:32], y(t=0)=$\\sqrt 3$ and $\\frac{dy(t=0)}{dt}$=1 by ode45 method.\n\n```\nfunction f = fvdposc(t,y,epsilon)\nf1 = y(2);                          %f1=y'\nf2 = -epsilon*(y(1)^2-1)*y(2)-y(1);%f2=y''\nf = [f1;f2];    %f must be a column vector\t\n```\n\n```\nabstol=10^-6;reltol=10^-6;\noptions = odeset('AbsTol',abstol,'RelTol',reltol);\n%if options not specified, use the default one. the other items must be there.\n[T,Y] = ode45( @(t,y) fvdposc(t,y,epsilon),tspan,y0,options);\n```\n\nIn this way, we can get Y is a [65 $\\times$ 2] matrix. This first column is the y values in tspan, and the other columne is y' values in tspan.\n\n\n# Boundary Value Problem\n\nThere might be multiple solutions to this kind of problem, and we should choose those suit boundary conditions. Let's start with a simple case:\n\n$$\n\\frac{d^2y}{dt^2} = f(t,y,\\frac{dy}{dt})\\quad y(a) = \\alpha\\quad y(b) = \\beta\n$$\n\n## Shooting Method\n\nActually, BVP is  comparable to IVP:\n\n-    IVP: y(a)=$\\alpha$, y'(a)=A\n-    BVP: y(a)=$\\alpha$, y(b)=$\\beta$\n\nSo we can guess an initial condition to see how difference the result from the other boundary value; and decide a new initial guess to repeat the above process until the result reaches the other boundary value.\n\n## Direct-Linear BVP\n\nHere we can consider a general case:\n\n$$\n\\frac{d^2y}{dt^2}=p(t)\\frac{dy}{dt}+q(t)y+r(t)\\\\\n\\alpha_1y(a)+\\beta_1y'(a)=\\gamma_1\\\\\n\\alpha_2y(b)+\\beta_2y'(b)=\\gamma_2\n$$\n\nCombine Taylor series and central difference method $y'=\\frac{y(t+\\Delta t)-y(t-\\Delta t)}{2\\Delta t}+O(\\Delta t^2)$, we can get $y''=\\frac{y(t+\\Delta t)-2y(t)+y(t-\\Delta t)}{\\Delta t^2}+O(\\Delta t^2)$. Finally, we can get: \n\n$$[1-\\frac{p(t)\\Delta t}{2}]\\cdot y(t+\\Delta t)-[2+q(t)\\Delta t^2]\\cdot y(t)+[1+\\frac{p(t)\\Delta t}{2}]\\cdot y(t-\\Delta t)=r(t)\\Delta t^2$$\n\nConvert it in to matrix form:\n\n$$A\\times \\overrightarrow x = \\overrightarrow b$$\n\n$$ \\begin{pmatrix} 1 & 0 &\\cdots &\\cdots &\\cdots & 0 \\\\ a & b & c & 0 &\\cdots &0 \\\\0&a&b&c&\\cdots&0\\\\\\vdots&\\ddots&\\ddots&\\ddots&\\ddots&\\vdots\\\\\\vdots&\\ddots&\\ddots&a&b&c\\\\0&\\cdots&\\cdots&\\cdots&a&1 \\end{pmatrix} \\times \\begin{pmatrix}y(t_0)\\\\y(t+\\Delta t)\\\\y(t+2\\Delta t)\\\\\\vdots\\\\\\vdots\\\\y(t_N) \\end{pmatrix}=\\begin{pmatrix} \\alpha\\\\r(t+\\Delta t)\\Delta t^2\\\\ r(t+2\\Delta t)\\Delta t^2\\\\\\vdots\\\\\\vdots\\\\\\beta \\end{pmatrix}$$\n\nIn Matlab, we can use function `X=A\\b` or `eig(A)` to solve it; in python(numpy), function `linalg.solve(A,b)` or `eig(A)` also works.\n\n## Newton-Raphson Method\n\nOne thing must be noted that, initial guess for this method should be close to the real value, otherwise it may diverge.\n$$x_{n+1}=x_n-\\frac{f(x_n)}{f'(x_n)}$$\n\n## Summary\n\n1. Approximate y', y'' using central difference formula;\n2. Approximate boundary condition using FDF, DBF\n3. Solve $A\\overrightarrow x=\\overrightarrow b$\n4. solution--O($\\Delta t^2$)\n\n## Quantum Harmonic Oscillation\n\n$$\\frac{d^2\\phi_n}{dx^2}-[Kx^2-\\varepsilon_n]\\phi_n=0$$\nwe expect the solution $\\phi_n(x)\\rightarrow 0$ as $x\\rightarrow \\pm \\infty$ and $\\varepsilon_n>0$ is the quantum energy. Note that $K=km/\\hbar^2$ and $\\varepsilon_n=E_nm/\\hbar^2$. Here take K=1, and always normalize so that $\\int_{-\\infty} ^{+\\infty} {|\\phi_n|^2} \\,{\\rm d}x=1$. Calculate the first five normalized eigenfunctions ($\\phi_n$) and eigenvalues($\\varepsilon_n$) up to tolerance of $10^{-4}$ in increasing order such that the first eigenvalue is the lowest one.\n\n- Shooting method\n\n```\nfunction f=pdefunc(x,y,e)\n\nf1 = y(2);\nf2 = (x^2-e)*y(1);\n\nf = [f1;f2];\n```\n\n```\nL=4; dx=0.1; e_start=0.5; tol=10^-4;\n\nxspan = -L:dx:L;\nA = 1; % suggest A=phi(-L)=phi(L)\n\nfor modes=1:5\n    e = e_start;\n    de=0.01;\n    for j=1:1000\n        y0 = [A;A*sqrt(L^2-e)];\n        \n        [x,phi] = ode45( @(x,phi) pdefunc(x,phi,e), xspan ,y0);\n        \n        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);\n        if abs(rightbc)<tol\n            eigen_e(modes,1)=e;\n            break;\n        end\n        \n        if (-1)^(1+modes)*rightbc>0\n            e = e+de;\n        else\n            de = de/2;\n            e = e-de;\n        end\n    end\n    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));\n        e_start = e+0.2;\nend\n\n%eigen_phi,eigen_e are what we want\n```\n\n- Direct Method\n\n```\nL=4; dx=0.1; \nxspan = -L:dx:L;\nmax = length(xspan)-2;\nA = zeros(max,max);\nphi_sort = zeros(max+2,max+2);\n% build up A matrix which doesn't consider phi(x1) and phi(xn). A is built\n% based on 2nd order central difference. The first and last row don't\n% consider x1 and xn, use FDF and BDF and approximation to make phi(x2) and\n% phi(x3) express phi(x1); phi(xn-2) and phi(xn-1) express phi(xn).\nA(1,1:2) = [2/3/dx^2+xspan(2)^2,-2/3/dx^2];\nA(end,end-1:end) = [-2/3/dx^2,2/3/dx^2+xspan(end-1)^2];\ni = 2;\nwhile i<max\n    A(i,i-1) = -1/dx^2;\n    A(i,i+1) = -1/dx^2;\n    A(i,i) = 2/dx^2+xspan(i+1)^2;\n    i=i+1;\nend\n%phi function only contains [phi(2),phi(3),...phi(n-2),phi(n-1)]\n[phi,e]=eig(A);\n\n%sort phi function based on ascending energy.\nfor i=1:max\n    eng(i,1) = e(i,i);\nend\n\n[eng, Index_eng] = sort(eng);\n\n%only get the first five phi functions. \n%phi(1)/phi(N) are calculated based on FDF/BDF method without approximation.\nfor i =1:5\n    phi_sort(2:end-1,i) = phi(:,Index_eng(i));\n    phi_sort(1,i) = (4*phi_sort(2,i)-phi_sort(3,i))/(3+2*dx*sqrt(L^2-eng(i)));\n    phi_sort(end,i) = (4*phi_sort(end-1,i)-phi_sort(end-2,i))/(3+2*dx*sqrt(L^2-eng(i)));\n    phi_sort(:,i) = phi_sort(:,i)/sqrt(trapz(xspan,phi_sort(:,i).^2));\nend\n\n%phi_sort,eng is the result\n```\n\n- Shooting for nonlinear cases\n  \n$$\\frac{d^2\\phi_n}{dx^2}-[\\gamma |\\phi_n|^2+Kx^2-\\varepsilon_n]\\phi_n=0$$\\\n\nStill use $x\\in [-L,L]$ with L=2 and choose xspan = -L:0.1:L. Find the first two normalized modes for  $\\gamma=0.05$:\n\n```\nL=2; dx=0.1; e_start=0.5; tol=10^-4; gama=0.05; A_start=0.2;\nxspan = -L:dx:L;\n\nfor modes=1:2\n    e = e_start;\n    de=0.01;\n    for j=1:1000\n        A = A_start;\n        dA = 0.1;\n        for a=1:1000\n            y0 = [A;A*sqrt(L^2-e)];\n            \n            [x,phi] = ode45( @(x,phi) nolinpdefunc(x,phi,gama,e), xspan ,y0);\n         \n            AA = trapz(x,phi(:,1).^2);\n           \n            if abs(AA-1)<tol\n                opt_A(modes,1)=A;\n                break;\n            end\n            if AA>1\n                A = A-dA;\n            else\n                dA = dA/2;\n                A = A+dA;\n            end       \n        end\n        \n        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);\n        if abs(rightbc)<tol\n            eigen_e(modes,1)=e;\n            break;\n        end\n        \n        if (-1)^(1+modes)*rightbc>0\n            e = e+de;\n        else\n            de = de/2;\n            e = e-de;\n        end\n    end\n    e_start = e+1;\n    A_start = A+1;\n    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));    \nend\n```\n\n# Partial Differential Equations\n\nSolving PDE is harder than ODE, because we need to consider both initial conditions and boundary conditions, also need to solve both in time and in space. The classic PDE is vortivity-streamfunction equations and reaction-diffusion systems. We will go through these two systems to show how to slove PDE.\n\n## Finite Scheme Method for Vorticity-Streamfunction Equations\n\n$$\\omega_t+[\\psi,\\omega]=\\mu\\nabla^2\\psi\\quad \\nabla^2\\psi=\\omega\\\\\nwhere\\; [\\psi,\\omega]=\\psi_x\\omega_y-\\psi_y\\omega_x \\; and \\; \\nabla^2=\\partial_x^2+\\partial_y^2$$\n\n- Steps:\n 1. Elliptic Solve: given $\\omega_0 \\rightarrow$ compute $\\psi_0$ by using $ \\nabla^2\\psi=\\omega$\n 2. Time-Stepping: choose step $\\Delta t$ compute $\\omega '$ using $\\omega_{k+1}=\\omega_k+\\Delta t\\cdot f(\\psi^k,\\omega^k)$\n 3. Iterate\n\n- Step 1: the elliptic problem\n$$(\\psi_{mn})_{xx}+(\\psi_{mn})_{yy}=\\omega_{mn}$$\nBy using CDF:\n$$\\frac{\\psi_{m-1,n}-2\\psi_{m,n}+\\psi_{m+1,n}}{\\Delta x^2}+\\frac{\\psi_{m,n-1}-2\\psi_{m,n}+\\psi_{m,n+1}}{\\Delta y^2}=\\omega_{m,n}\\delta^2$$\nIf we set $\\Delta x=\\Delta y$, and reshape the matrix $\\psi_{m,n}$ and $\\omega_{m,n}$ (m=n)to vectors (the same thing as matlab fucntion `reshape(matrix,n^2,1)`), we can write the above equation into a matrix form:\n$$A\\overrightarrow \\psi = \\overrightarrow \\omega $$\nwhere $A=A'/\\delta^2$, $A'=A_D+A_x+A_y$, $A_D=-4\\psi_{m,n}$, $A_x=\\psi_{m-1,n}+\\psi_{m,n-1}$ and $A_y=\\psi_{m,n-1}+\\psi_{m,n+1}$\n\n- *Matlab script*\n    \n    $A=\\nabla^2$, $B=\\partial_x$, $C=\\partial_y$\n\n```\nfunction [A B C] = derivmatrix(dx,dy,n)\n\ne1 = ones(n^2,1);\n%A = dx^2+dy^2\n\n%A = (AD+AX+AY)/dx/dy; AD=-4y(m,n),AX=y(m-1,n)+y(m+1,n), AY=y(m,n-1)+y(m,n+1)\nAD = spdiags(-4*e1,0,n^2,n^2); \nAD(1,1)=2;%set the first element not -4 to avoid denominator too small\nAX = spdiags([e1 e1 e1 e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2);\nAY = spdiags([e1 e1],[-1 1],n^2,n^2);\nfor i=1:n\n    AY(1+n*(i-1),n*i) = 1;\n    AY(n*i,1+n*(i-1)) = 1;\n    if i<n\n        AY(n*i,1+n*i) = 0;\n        AY(1+n*i,n*i) = 0;\n    end\nend\nA = (AD+AX+AY)/(dx*dy);\n\n%B = dx\n%B = (y(m+1,n)-y(m-1,n))/(2*dx)\nB = spdiags([e1 -e1 e1 -e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2)/(2*dx);\n\n%C = dy\n%C = (y(m,n+1)-y(m,n-1))/(2*dy)\nC = spdiags([-e1 e1],[-1,1],n^2,n^2);\nfor i=1:n\n    C(1+n*(i-1),n*i) = -1;\n    C(n*i,1+n*(i-1)) = 1;\n    if i<n\n        C(n*i,1+n*i) = 0;\n        C(1+n*i,n*i) = 0;\n    end\nend\nC = C/(2*dy);\n```\n\nthen, we could use one of these two method to slove $\\psi$\n\n```\npsi = A\\w;\n```\n\n```\n [L,U,P] = lu(A);\n y=L\\(P*w);\n psi = U\\y;\n```\n\n- Step 2: Method Line\n\n$$\n\\nabla^2\\psi(x,y)=f(x,y)\\qquad+b.c.\\\\\nu_t(t,x)=u_x(t,x)\\quad+i.c.,b.c.\\\\\nu_x(t,x)\\approx\\frac{u(x+\\Delta x)-u(x-\\Delta x)}{2\\Delta x}\n$$\nWe have to condiser the stability of this method. Choose $\\lambda$ carefully to make sure it is stable and also will not run forever.\n$$u_n^{(m)}=g^mexp(i\\zeta\\Delta x)\\\\\n$$\\lambda =\\frac{\\Delta t^{num-t-der}} {\\Delta x^{num-x-der}}$$\n\n## Spectral Method for Vorticity-Streamfunction Equations\n\nexpand u(x,t):\n\n$$u(x,t)=\\sum_{k=1}^N a_k(t)\\phi_k(x)\\qquad$$\n where $\\phi_k(x)$are orthogonal\nUsing Fourier Series\n\n$$\\widehat{u}(t)=u(k,t)=\\sum_{n=1}^N u(n,t)e^{-i2\\pi(k-1)(n-1)/N}\\\\\\qquad\\;u(n,t)=1/N\\sum_{n=1}^N \\widehat u(t)e^{i2\\pi(k-1)(n-1)/N}$$\nDerivative property:\n$$\\widehat u^{(m)}(x,t)=(ik)^{(m)}\\widehat u(k,t)$$\nPDE  Fourier Space\n$$u_t=Lu+N(u) \\Longrightarrow \\widehat(u)_t=\\alpha(k)\\widehat u+\\widehat N(u)$$\nHere attached the script for solve VSE by the above two methods.\n\n```\nclear all; clf; close all; clc\nnu = 0.001;\nn=64;\nL=10;\ntspan = 0:0.5:4;\n\nw1 = runvs(L,n,tspan,nu,1);\n\nw2 = runvs(L,n,tspan,nu,2);\n\nw3 = runvs(L,n,tspan,nu,3);\n```\n\n```\nfunction wfsol = runvs(L,n,tspan,nu,choice)\n\nx2 = linspace(-L/2,L/2,n+1);\nx = x2(1:n);\ndx = x(2)-x(1);\n\n[X,Y] = meshgrid(x);%grid\n[A,B,C] = derivmatrix(dx,dx,n);%apply to vector [64*64,1]\n\nwfinit = exp(-X.^2-Y.^2/20);%grid\nwfinitvect = reshape(wfinit,n^2,1);%vector\n\n[t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,1),tspan,wfinitvect);\n\nif choice==3\n    kx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];\n    kx(1) = 1e-6;\n\n    [KX,KY]=meshgrid(kx);\n    K = KX.^2+KY.^2;\n    \n    [t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,K)tspan,wfinitvect);\nend\n```\n\n```\nfunction rhs = vortstream(t,w,n,nu,A,B,C,choice,K)\n\nif choice==1\n    psi = A\\w;%vector\nelseif choice==2\n    [L,U,P] = lu(A);\n    y=L\\(P*w);\n    psi = U\\y;\nelse\n    wf = fft2(reshape(w,n,n));\n    psif = -wf./K;\n    psi = reshape(real(ifft2(psif)),n^2,1);\nend\n\nrhs = -(B*psi).*(C*w)+(C*psi).*(B*w)+nu*A*w;%vector\n```\n\n## Chebishev Polynomials\n\n$$\\phi_k(x)=T_k(x)\\quad T_k(cos\\theta)=cosk\\theta$$\nMatlab Script:\n\n```\nfunction [D,x] = cheb(N)\n  if N==0, D=0; x=1; return, end\n  x = cos(pi*(0:N)/N)'; \n  c = [2; ones(N-1,1); 2].*(-1).^(0:N)';\n  X = repmat(x,1,N+1);\n  dX = X-X';                  \n  D  = (c*(1./c)')./(dX+(eye(N+1)));      % off-diagonal entries\n  D  = D - diag(sum(D'));                 % diagonal entries\n```\n\nSolve reaction-diffusion system with both spectral and cheb methods\n$$U_t=\\lambda(A)U-\\omega (A)V+D_1\\nabla^2U\\\\V_t=\\omega (a)U+\\lambda(A)V+D_2\\nabla^2V$$\nwhere $A^2=U^2+V^2$ and $\\nabla^2=\\partial_x^2+\\partial_y^2$. Consider $\\lambda(A)=1-A^2$ and $\\omega(A)=-\\beta A^2$\n\n```\nclear all; close all; clc\nL=20;n=64;beta=1;d1=0.1;d2=d1;m=1;\ntspan=0:0.5:4;\n\nuv1 = runrds_fft(tspan,L,n,beta,d1,d2,m);\nA1 = real(uv1);\nA2 = imag(uv1);\n\nn=31;\nuv2 = runrds_cheb(tspan,L,n,beta,d1,d2,m);\nA3 = uv2;\n```\nwe consider $x,y \\in[-10,10]$, n=64, $\\beta =1$, $D_1=D_2=0.1$, m=1, tspan=0:0.5:4 and $u_f$ stacked on top of $v_f$.\nThe following is FFT(spectral) method:\n\n```\nfunction xfsol = runrds_fft(tspan,L,n,beta,d1,d2,m)\n\nx2 = linspace(-L/2,L/2,n+1);\nx = x2(1:n);\ny=x;\n\nkx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];\nkx(1) = 1e-6;\nky=kx;\n\n[X,Y]=meshgrid(x,y);\n[KX,KY]=meshgrid(kx,ky);\nK = KX.^2+KY.^2;\nKvec = reshape(K,n^2,1);\n\nuint = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid\nvint = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));\nufint = fft2(uint);\nvfint = fft2(vint);\nufvecint = reshape(ufint,n^2,1);\nvfvecint = reshape(vfint,n^2,1);\nxfvecint = [ufvecint;vfvecint];\n\n[t,xfsol] = ode45(@(t,xfvec) rds_fft(t,xfvec,beta,Kvec,n,d1,d2),tspan,xfvecint);\n\n```\n\n```\nfunction rhs = rds_fft(t,xfvec,beta,Kvec,n,d1,d2)\n\nufvec = xfvec(1:n^2);\nvfvec = xfvec(n^2+1:end);\n\nu = real(ifft2(reshape(ufvec,n,n)));\nv = real(ifft2(reshape(vfvec,n,n)));\nA = u.^2+v.^2;\nl = 1-A;\nw = -beta*A;\n\nuft = reshape(fft2(l.*u-w.*v),n^2,1)-d1*Kvec.*ufvec;\nvft = reshape(fft2(w.*u+l.*v),n^2,1)-d2*Kvec.*vfvec;\n\nrhs = [uft;vft];\n```\n\nThe following is cheb method with n=30 and m=1\n\n```\nfunction xsolvec = runrds_cheb(tspan,L,n,beta,d1,d2,m)\n\n[D,x2] = cheb(n-1);\nD2= D^2;\nD2(1,:) = zeros(1,n);\nD2(n,:) = zeros(1,n);%boundary should be 0\nI = eye(length(D2));\nLap = kron(D2,I)+kron(I,D2);\n\nx = x2*L/2;\n[X,Y]=meshgrid(x);\n\nuinit = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid\nvinit = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));\n\nuvecinit = reshape(uinit,n^2,1);\nvvecinit = reshape(vinit,n^2,1);\nxvecinit = [uvecinit;vvecinit];\n\n[t,xsolvec] =ode45(@(t,xvec) rds_cheb(t,L,xvec,beta,Lap,n,d1,d2),tspan,xvecinit);\n\n```\n\n```\nfunction rhs = rds_cheb(t,L,xvec,beta,Lap,n,d1,d2)\n\nuvec = xvec(1:n^2);\nvvec = xvec(n^2+1:end);\n\nAvec = uvec.^2+vvec.^2;\nlvec = 1-Avec;\nwvec = -beta*Avec;\n\nut = lvec.*uvec-wvec.*vvec+d1*4/L^2*Lap*uvec;\nvt = wvec.*uvec+lvec.*vvec+d2*4/L^2*Lap*vvec;\n\nrhs = [ut;vt];\n\n```\n\n\n\n","source":"_posts/Scientific-Computing.md","raw":"---\ntitle: Scientific Computing\ndate: 2019-01-02 13:28:18\ntags:\n- AMATH\ncategories:\n- NoteBook\n---\n\n*A manual for individual use, which focuses on how to solve ordinary and partial differential equation numerically, including how to solve initial value problem with Euler, 2nd- and 4th- order Runge-Kutta and Adams-Bashford method; how to handle boundary value problem with shooting method and direct method and how to deal with PDE with finite difference schemes and spectral methods. Quantum Harmonic Oscillator, Vorticity-Streamfunction Equations, Reaction-Diffusion Systems are are discussed.*\n\n# Initial Value Problem\n\n$$\n\\frac{d\\overrightarrow{y}}{dt}=f(t,\\overrightarrow{y}) \\quad \\overrightarrow{y}(0)=\\overrightarrow{y_0} \\quad t\\in[0,T]\n$$\n\n## Forward Euler Method\n\nThis is the simplest algorithm for solving this problem, which is derived from the definition of the derivative:\n\n$$\n\\frac{d\\overrightarrow y}{dt}=\\lim_{\\Delta t \\to 0} \\frac{\\Delta\\overrightarrow y}{\\Delta t} \\approx \\frac{\\overrightarrow y_{n+1}-\\overrightarrow y_n}{t_{n+1}-t_n}\n$$\n\nFrom the above equation, we can get:\n\n$$\n\\overrightarrow{y}_{n+1} = \\overrightarrow y_n + \\Delta t \\cdot f(t_n,\\overrightarrow y_n)\n$$\n\nNote that each subsequenct approximation in Euler Method is generated from the slope of the previous point. Considering the error coulde be very large, we need to find some ways to improve it.\n\n## Improved from Euler Method\n\n One way we can think of is to use the slope of other points instead of that of the previous one to predict the next point. For example, the average slope (Heun's Method), or the slope of the midpoint (RK2).\n \n### Heun's \n  \n  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_n,y_n)+f(t_{n+1},y_{n+1})]$$\n\n### RK2 \n  \n  $$y_{n+1}=y_n+\\Delta t \\cdot f[t_n+\\frac{\\Delta t}{2},y(t_n+\\frac{\\Delta t}{2})]$$\n\n### In general \n  \n  $$y_{n+1}=y_n+\\Delta t[A \\cdot f(t_n,y_n)+B \\cdot f(t+P\\Delta t,y_n+Q\\Delta t \\cdot f(t_n,y_n)]\\\\where\\quad A+B=1\\quad B\\cdot P=\\frac{1}{2}\\quad B\\cdot Q=\\frac{1}{2}$$\n\n- If $A=\\frac{1}{2}\\Rightarrow B=\\frac{1}{2}\\Rightarrow P=1\\Rightarrow Q=1\\Rightarrow$Heun's Method\n- If $A=0\\Rightarrow B=0\\Rightarrow P=\\frac{1}{2}\\Rightarrow Q=\\frac{1}{2}\\Rightarrow$RK2 Method\n  \n### RK4\n  \n$$y_{n+1}=y_n+\\frac{\\Delta t}{6}(f_1+2f_2+2f_3+f_4)\\\\\nf_1=f(t_n,y_n)\\\\\nf_2=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_1)\\\\\nf_3=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_2)\\\\\nf_4=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_3)$$\n\n### Summary and Error Analysis\n\n| Scheme | Local Error | Global Error | Matlab | Python\n|----|----|----|----|----|\n|Forward Euler|$\\Delta t^2$|$\\Delta t$||\n|Heun's/RK2|$\\Delta t^3$|$\\Delta t^2$|ode23|Method=RK23\n|RK4|$\\Delta t^5$|$\\Delta t^4$|ode45|Method=RK45\n\nThe error in numerical algorithm not only comes from the local error (truncated error) in the algorithm iteself, but also arises from round off error since computer can only keep limit digits of number: $Error_{total}=\\varepsilon_{round\\ off}+\\varepsilon_{truncate}$. If the round-off error is dominant, our algorithm can be unstable to be used. That's why Backward Euler Method is introduced.\n\n## Backward Euler Method\n\nIt is an implicit method, which is more stable\n\n$$y_n=y_{n+1}-\\Delta t \\cdot f(t_{n+1},y_{n+1})$$\n\nExample:\n\n$$\\frac{dy}{dt}=\\lambda y\\quad y(0)=y_0$$\n\n- FE:\n  $$y_{n+1}=y_n+\\Delta t \\cdot f(t_n,y_n)=y_n+\\Delta t \\cdot \\lambda y \\Rightarrow y_n=(y_0+\\varepsilon_{round\\_off})(1+\\Delta t \\lambda)^N$$\n  set  $r_{FE}=(1+\\Delta t \\lambda)^N\\Rightarrow y_n=y_0\\cdot r_{FE}^N+\\varepsilon_{round\\_off}\\cdot r_{FE}^N$\n  \n  - $\\lambda>0\\Rightarrow |r_{FE}|>1\\Rightarrow$ unconditionally unstable\n  - $\\lambda<0\\Rightarrow |r_{FE}|<1\\Rightarrow \\begin{cases} \\Delta t<\\frac{2}{|\\lambda|} & stable\\\\ \\Delta t>\\frac{2}{|\\lambda|} & unsatble\\\\ \\end{cases}$\n  \n- BE:\n  \n  $$y_n=y_{n+1}-\\Delta t\\cdot \\lambda\\cdot y_{n+1}\\Rightarrow y_{n+1}=r_{BE}\\cdot y_n,\\ where\\ r_{BE}=\\frac{1}{1-\\Delta t\\lambda}\n  \\\\y_n=y_0\\cdot r_{BE}^N+\\varepsilon_{round\\_off}\\cdot r_{BE}^N$$\n    - $\\lambda<0\\Rightarrow |r_{FE}|<1\\Rightarrow$ unconditionally stable\n    - $\\lambda>0\\Rightarrow |r_{FE}|<1\\Rightarrow \\begin{cases} \\Delta t>\\frac{2}{|\\lambda|} & stable\\\\ \\Delta t<\\frac{2}{|\\lambda|} & unsatble\\\\ \\end{cases}$\n \n## MultiStep Method\n\n - Adams-Bash forth (explicit method)\n  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})$$ \n - Adams-Moulthon (implicit method)\n  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}(f_{n+1}+f_n)$$\n - Predictor-Corrector\n  $$y_{n+1}^P=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})\\\\y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_{n+1},y_{n+1}^P)+f_n]$$\n\n## Matlab for ODE45\n\nsolve this equation $\\frac{d^2y(t)}{dt^2}+\\epsilon[y^2(t)-1]\\frac{dy(t)}{dt}+y(t)=0$ with $\\epsilon$=0.1, t=[0:0.5:32], y(t=0)=$\\sqrt 3$ and $\\frac{dy(t=0)}{dt}$=1 by ode45 method.\n\n```\nfunction f = fvdposc(t,y,epsilon)\nf1 = y(2);                          %f1=y'\nf2 = -epsilon*(y(1)^2-1)*y(2)-y(1);%f2=y''\nf = [f1;f2];    %f must be a column vector\t\n```\n\n```\nabstol=10^-6;reltol=10^-6;\noptions = odeset('AbsTol',abstol,'RelTol',reltol);\n%if options not specified, use the default one. the other items must be there.\n[T,Y] = ode45( @(t,y) fvdposc(t,y,epsilon),tspan,y0,options);\n```\n\nIn this way, we can get Y is a [65 $\\times$ 2] matrix. This first column is the y values in tspan, and the other columne is y' values in tspan.\n\n\n# Boundary Value Problem\n\nThere might be multiple solutions to this kind of problem, and we should choose those suit boundary conditions. Let's start with a simple case:\n\n$$\n\\frac{d^2y}{dt^2} = f(t,y,\\frac{dy}{dt})\\quad y(a) = \\alpha\\quad y(b) = \\beta\n$$\n\n## Shooting Method\n\nActually, BVP is  comparable to IVP:\n\n-    IVP: y(a)=$\\alpha$, y'(a)=A\n-    BVP: y(a)=$\\alpha$, y(b)=$\\beta$\n\nSo we can guess an initial condition to see how difference the result from the other boundary value; and decide a new initial guess to repeat the above process until the result reaches the other boundary value.\n\n## Direct-Linear BVP\n\nHere we can consider a general case:\n\n$$\n\\frac{d^2y}{dt^2}=p(t)\\frac{dy}{dt}+q(t)y+r(t)\\\\\n\\alpha_1y(a)+\\beta_1y'(a)=\\gamma_1\\\\\n\\alpha_2y(b)+\\beta_2y'(b)=\\gamma_2\n$$\n\nCombine Taylor series and central difference method $y'=\\frac{y(t+\\Delta t)-y(t-\\Delta t)}{2\\Delta t}+O(\\Delta t^2)$, we can get $y''=\\frac{y(t+\\Delta t)-2y(t)+y(t-\\Delta t)}{\\Delta t^2}+O(\\Delta t^2)$. Finally, we can get: \n\n$$[1-\\frac{p(t)\\Delta t}{2}]\\cdot y(t+\\Delta t)-[2+q(t)\\Delta t^2]\\cdot y(t)+[1+\\frac{p(t)\\Delta t}{2}]\\cdot y(t-\\Delta t)=r(t)\\Delta t^2$$\n\nConvert it in to matrix form:\n\n$$A\\times \\overrightarrow x = \\overrightarrow b$$\n\n$$ \\begin{pmatrix} 1 & 0 &\\cdots &\\cdots &\\cdots & 0 \\\\ a & b & c & 0 &\\cdots &0 \\\\0&a&b&c&\\cdots&0\\\\\\vdots&\\ddots&\\ddots&\\ddots&\\ddots&\\vdots\\\\\\vdots&\\ddots&\\ddots&a&b&c\\\\0&\\cdots&\\cdots&\\cdots&a&1 \\end{pmatrix} \\times \\begin{pmatrix}y(t_0)\\\\y(t+\\Delta t)\\\\y(t+2\\Delta t)\\\\\\vdots\\\\\\vdots\\\\y(t_N) \\end{pmatrix}=\\begin{pmatrix} \\alpha\\\\r(t+\\Delta t)\\Delta t^2\\\\ r(t+2\\Delta t)\\Delta t^2\\\\\\vdots\\\\\\vdots\\\\\\beta \\end{pmatrix}$$\n\nIn Matlab, we can use function `X=A\\b` or `eig(A)` to solve it; in python(numpy), function `linalg.solve(A,b)` or `eig(A)` also works.\n\n## Newton-Raphson Method\n\nOne thing must be noted that, initial guess for this method should be close to the real value, otherwise it may diverge.\n$$x_{n+1}=x_n-\\frac{f(x_n)}{f'(x_n)}$$\n\n## Summary\n\n1. Approximate y', y'' using central difference formula;\n2. Approximate boundary condition using FDF, DBF\n3. Solve $A\\overrightarrow x=\\overrightarrow b$\n4. solution--O($\\Delta t^2$)\n\n## Quantum Harmonic Oscillation\n\n$$\\frac{d^2\\phi_n}{dx^2}-[Kx^2-\\varepsilon_n]\\phi_n=0$$\nwe expect the solution $\\phi_n(x)\\rightarrow 0$ as $x\\rightarrow \\pm \\infty$ and $\\varepsilon_n>0$ is the quantum energy. Note that $K=km/\\hbar^2$ and $\\varepsilon_n=E_nm/\\hbar^2$. Here take K=1, and always normalize so that $\\int_{-\\infty} ^{+\\infty} {|\\phi_n|^2} \\,{\\rm d}x=1$. Calculate the first five normalized eigenfunctions ($\\phi_n$) and eigenvalues($\\varepsilon_n$) up to tolerance of $10^{-4}$ in increasing order such that the first eigenvalue is the lowest one.\n\n- Shooting method\n\n```\nfunction f=pdefunc(x,y,e)\n\nf1 = y(2);\nf2 = (x^2-e)*y(1);\n\nf = [f1;f2];\n```\n\n```\nL=4; dx=0.1; e_start=0.5; tol=10^-4;\n\nxspan = -L:dx:L;\nA = 1; % suggest A=phi(-L)=phi(L)\n\nfor modes=1:5\n    e = e_start;\n    de=0.01;\n    for j=1:1000\n        y0 = [A;A*sqrt(L^2-e)];\n        \n        [x,phi] = ode45( @(x,phi) pdefunc(x,phi,e), xspan ,y0);\n        \n        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);\n        if abs(rightbc)<tol\n            eigen_e(modes,1)=e;\n            break;\n        end\n        \n        if (-1)^(1+modes)*rightbc>0\n            e = e+de;\n        else\n            de = de/2;\n            e = e-de;\n        end\n    end\n    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));\n        e_start = e+0.2;\nend\n\n%eigen_phi,eigen_e are what we want\n```\n\n- Direct Method\n\n```\nL=4; dx=0.1; \nxspan = -L:dx:L;\nmax = length(xspan)-2;\nA = zeros(max,max);\nphi_sort = zeros(max+2,max+2);\n% build up A matrix which doesn't consider phi(x1) and phi(xn). A is built\n% based on 2nd order central difference. The first and last row don't\n% consider x1 and xn, use FDF and BDF and approximation to make phi(x2) and\n% phi(x3) express phi(x1); phi(xn-2) and phi(xn-1) express phi(xn).\nA(1,1:2) = [2/3/dx^2+xspan(2)^2,-2/3/dx^2];\nA(end,end-1:end) = [-2/3/dx^2,2/3/dx^2+xspan(end-1)^2];\ni = 2;\nwhile i<max\n    A(i,i-1) = -1/dx^2;\n    A(i,i+1) = -1/dx^2;\n    A(i,i) = 2/dx^2+xspan(i+1)^2;\n    i=i+1;\nend\n%phi function only contains [phi(2),phi(3),...phi(n-2),phi(n-1)]\n[phi,e]=eig(A);\n\n%sort phi function based on ascending energy.\nfor i=1:max\n    eng(i,1) = e(i,i);\nend\n\n[eng, Index_eng] = sort(eng);\n\n%only get the first five phi functions. \n%phi(1)/phi(N) are calculated based on FDF/BDF method without approximation.\nfor i =1:5\n    phi_sort(2:end-1,i) = phi(:,Index_eng(i));\n    phi_sort(1,i) = (4*phi_sort(2,i)-phi_sort(3,i))/(3+2*dx*sqrt(L^2-eng(i)));\n    phi_sort(end,i) = (4*phi_sort(end-1,i)-phi_sort(end-2,i))/(3+2*dx*sqrt(L^2-eng(i)));\n    phi_sort(:,i) = phi_sort(:,i)/sqrt(trapz(xspan,phi_sort(:,i).^2));\nend\n\n%phi_sort,eng is the result\n```\n\n- Shooting for nonlinear cases\n  \n$$\\frac{d^2\\phi_n}{dx^2}-[\\gamma |\\phi_n|^2+Kx^2-\\varepsilon_n]\\phi_n=0$$\\\n\nStill use $x\\in [-L,L]$ with L=2 and choose xspan = -L:0.1:L. Find the first two normalized modes for  $\\gamma=0.05$:\n\n```\nL=2; dx=0.1; e_start=0.5; tol=10^-4; gama=0.05; A_start=0.2;\nxspan = -L:dx:L;\n\nfor modes=1:2\n    e = e_start;\n    de=0.01;\n    for j=1:1000\n        A = A_start;\n        dA = 0.1;\n        for a=1:1000\n            y0 = [A;A*sqrt(L^2-e)];\n            \n            [x,phi] = ode45( @(x,phi) nolinpdefunc(x,phi,gama,e), xspan ,y0);\n         \n            AA = trapz(x,phi(:,1).^2);\n           \n            if abs(AA-1)<tol\n                opt_A(modes,1)=A;\n                break;\n            end\n            if AA>1\n                A = A-dA;\n            else\n                dA = dA/2;\n                A = A+dA;\n            end       \n        end\n        \n        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);\n        if abs(rightbc)<tol\n            eigen_e(modes,1)=e;\n            break;\n        end\n        \n        if (-1)^(1+modes)*rightbc>0\n            e = e+de;\n        else\n            de = de/2;\n            e = e-de;\n        end\n    end\n    e_start = e+1;\n    A_start = A+1;\n    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));    \nend\n```\n\n# Partial Differential Equations\n\nSolving PDE is harder than ODE, because we need to consider both initial conditions and boundary conditions, also need to solve both in time and in space. The classic PDE is vortivity-streamfunction equations and reaction-diffusion systems. We will go through these two systems to show how to slove PDE.\n\n## Finite Scheme Method for Vorticity-Streamfunction Equations\n\n$$\\omega_t+[\\psi,\\omega]=\\mu\\nabla^2\\psi\\quad \\nabla^2\\psi=\\omega\\\\\nwhere\\; [\\psi,\\omega]=\\psi_x\\omega_y-\\psi_y\\omega_x \\; and \\; \\nabla^2=\\partial_x^2+\\partial_y^2$$\n\n- Steps:\n 1. Elliptic Solve: given $\\omega_0 \\rightarrow$ compute $\\psi_0$ by using $ \\nabla^2\\psi=\\omega$\n 2. Time-Stepping: choose step $\\Delta t$ compute $\\omega '$ using $\\omega_{k+1}=\\omega_k+\\Delta t\\cdot f(\\psi^k,\\omega^k)$\n 3. Iterate\n\n- Step 1: the elliptic problem\n$$(\\psi_{mn})_{xx}+(\\psi_{mn})_{yy}=\\omega_{mn}$$\nBy using CDF:\n$$\\frac{\\psi_{m-1,n}-2\\psi_{m,n}+\\psi_{m+1,n}}{\\Delta x^2}+\\frac{\\psi_{m,n-1}-2\\psi_{m,n}+\\psi_{m,n+1}}{\\Delta y^2}=\\omega_{m,n}\\delta^2$$\nIf we set $\\Delta x=\\Delta y$, and reshape the matrix $\\psi_{m,n}$ and $\\omega_{m,n}$ (m=n)to vectors (the same thing as matlab fucntion `reshape(matrix,n^2,1)`), we can write the above equation into a matrix form:\n$$A\\overrightarrow \\psi = \\overrightarrow \\omega $$\nwhere $A=A'/\\delta^2$, $A'=A_D+A_x+A_y$, $A_D=-4\\psi_{m,n}$, $A_x=\\psi_{m-1,n}+\\psi_{m,n-1}$ and $A_y=\\psi_{m,n-1}+\\psi_{m,n+1}$\n\n- *Matlab script*\n    \n    $A=\\nabla^2$, $B=\\partial_x$, $C=\\partial_y$\n\n```\nfunction [A B C] = derivmatrix(dx,dy,n)\n\ne1 = ones(n^2,1);\n%A = dx^2+dy^2\n\n%A = (AD+AX+AY)/dx/dy; AD=-4y(m,n),AX=y(m-1,n)+y(m+1,n), AY=y(m,n-1)+y(m,n+1)\nAD = spdiags(-4*e1,0,n^2,n^2); \nAD(1,1)=2;%set the first element not -4 to avoid denominator too small\nAX = spdiags([e1 e1 e1 e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2);\nAY = spdiags([e1 e1],[-1 1],n^2,n^2);\nfor i=1:n\n    AY(1+n*(i-1),n*i) = 1;\n    AY(n*i,1+n*(i-1)) = 1;\n    if i<n\n        AY(n*i,1+n*i) = 0;\n        AY(1+n*i,n*i) = 0;\n    end\nend\nA = (AD+AX+AY)/(dx*dy);\n\n%B = dx\n%B = (y(m+1,n)-y(m-1,n))/(2*dx)\nB = spdiags([e1 -e1 e1 -e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2)/(2*dx);\n\n%C = dy\n%C = (y(m,n+1)-y(m,n-1))/(2*dy)\nC = spdiags([-e1 e1],[-1,1],n^2,n^2);\nfor i=1:n\n    C(1+n*(i-1),n*i) = -1;\n    C(n*i,1+n*(i-1)) = 1;\n    if i<n\n        C(n*i,1+n*i) = 0;\n        C(1+n*i,n*i) = 0;\n    end\nend\nC = C/(2*dy);\n```\n\nthen, we could use one of these two method to slove $\\psi$\n\n```\npsi = A\\w;\n```\n\n```\n [L,U,P] = lu(A);\n y=L\\(P*w);\n psi = U\\y;\n```\n\n- Step 2: Method Line\n\n$$\n\\nabla^2\\psi(x,y)=f(x,y)\\qquad+b.c.\\\\\nu_t(t,x)=u_x(t,x)\\quad+i.c.,b.c.\\\\\nu_x(t,x)\\approx\\frac{u(x+\\Delta x)-u(x-\\Delta x)}{2\\Delta x}\n$$\nWe have to condiser the stability of this method. Choose $\\lambda$ carefully to make sure it is stable and also will not run forever.\n$$u_n^{(m)}=g^mexp(i\\zeta\\Delta x)\\\\\n$$\\lambda =\\frac{\\Delta t^{num-t-der}} {\\Delta x^{num-x-der}}$$\n\n## Spectral Method for Vorticity-Streamfunction Equations\n\nexpand u(x,t):\n\n$$u(x,t)=\\sum_{k=1}^N a_k(t)\\phi_k(x)\\qquad$$\n where $\\phi_k(x)$are orthogonal\nUsing Fourier Series\n\n$$\\widehat{u}(t)=u(k,t)=\\sum_{n=1}^N u(n,t)e^{-i2\\pi(k-1)(n-1)/N}\\\\\\qquad\\;u(n,t)=1/N\\sum_{n=1}^N \\widehat u(t)e^{i2\\pi(k-1)(n-1)/N}$$\nDerivative property:\n$$\\widehat u^{(m)}(x,t)=(ik)^{(m)}\\widehat u(k,t)$$\nPDE  Fourier Space\n$$u_t=Lu+N(u) \\Longrightarrow \\widehat(u)_t=\\alpha(k)\\widehat u+\\widehat N(u)$$\nHere attached the script for solve VSE by the above two methods.\n\n```\nclear all; clf; close all; clc\nnu = 0.001;\nn=64;\nL=10;\ntspan = 0:0.5:4;\n\nw1 = runvs(L,n,tspan,nu,1);\n\nw2 = runvs(L,n,tspan,nu,2);\n\nw3 = runvs(L,n,tspan,nu,3);\n```\n\n```\nfunction wfsol = runvs(L,n,tspan,nu,choice)\n\nx2 = linspace(-L/2,L/2,n+1);\nx = x2(1:n);\ndx = x(2)-x(1);\n\n[X,Y] = meshgrid(x);%grid\n[A,B,C] = derivmatrix(dx,dx,n);%apply to vector [64*64,1]\n\nwfinit = exp(-X.^2-Y.^2/20);%grid\nwfinitvect = reshape(wfinit,n^2,1);%vector\n\n[t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,1),tspan,wfinitvect);\n\nif choice==3\n    kx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];\n    kx(1) = 1e-6;\n\n    [KX,KY]=meshgrid(kx);\n    K = KX.^2+KY.^2;\n    \n    [t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,K)tspan,wfinitvect);\nend\n```\n\n```\nfunction rhs = vortstream(t,w,n,nu,A,B,C,choice,K)\n\nif choice==1\n    psi = A\\w;%vector\nelseif choice==2\n    [L,U,P] = lu(A);\n    y=L\\(P*w);\n    psi = U\\y;\nelse\n    wf = fft2(reshape(w,n,n));\n    psif = -wf./K;\n    psi = reshape(real(ifft2(psif)),n^2,1);\nend\n\nrhs = -(B*psi).*(C*w)+(C*psi).*(B*w)+nu*A*w;%vector\n```\n\n## Chebishev Polynomials\n\n$$\\phi_k(x)=T_k(x)\\quad T_k(cos\\theta)=cosk\\theta$$\nMatlab Script:\n\n```\nfunction [D,x] = cheb(N)\n  if N==0, D=0; x=1; return, end\n  x = cos(pi*(0:N)/N)'; \n  c = [2; ones(N-1,1); 2].*(-1).^(0:N)';\n  X = repmat(x,1,N+1);\n  dX = X-X';                  \n  D  = (c*(1./c)')./(dX+(eye(N+1)));      % off-diagonal entries\n  D  = D - diag(sum(D'));                 % diagonal entries\n```\n\nSolve reaction-diffusion system with both spectral and cheb methods\n$$U_t=\\lambda(A)U-\\omega (A)V+D_1\\nabla^2U\\\\V_t=\\omega (a)U+\\lambda(A)V+D_2\\nabla^2V$$\nwhere $A^2=U^2+V^2$ and $\\nabla^2=\\partial_x^2+\\partial_y^2$. Consider $\\lambda(A)=1-A^2$ and $\\omega(A)=-\\beta A^2$\n\n```\nclear all; close all; clc\nL=20;n=64;beta=1;d1=0.1;d2=d1;m=1;\ntspan=0:0.5:4;\n\nuv1 = runrds_fft(tspan,L,n,beta,d1,d2,m);\nA1 = real(uv1);\nA2 = imag(uv1);\n\nn=31;\nuv2 = runrds_cheb(tspan,L,n,beta,d1,d2,m);\nA3 = uv2;\n```\nwe consider $x,y \\in[-10,10]$, n=64, $\\beta =1$, $D_1=D_2=0.1$, m=1, tspan=0:0.5:4 and $u_f$ stacked on top of $v_f$.\nThe following is FFT(spectral) method:\n\n```\nfunction xfsol = runrds_fft(tspan,L,n,beta,d1,d2,m)\n\nx2 = linspace(-L/2,L/2,n+1);\nx = x2(1:n);\ny=x;\n\nkx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];\nkx(1) = 1e-6;\nky=kx;\n\n[X,Y]=meshgrid(x,y);\n[KX,KY]=meshgrid(kx,ky);\nK = KX.^2+KY.^2;\nKvec = reshape(K,n^2,1);\n\nuint = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid\nvint = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));\nufint = fft2(uint);\nvfint = fft2(vint);\nufvecint = reshape(ufint,n^2,1);\nvfvecint = reshape(vfint,n^2,1);\nxfvecint = [ufvecint;vfvecint];\n\n[t,xfsol] = ode45(@(t,xfvec) rds_fft(t,xfvec,beta,Kvec,n,d1,d2),tspan,xfvecint);\n\n```\n\n```\nfunction rhs = rds_fft(t,xfvec,beta,Kvec,n,d1,d2)\n\nufvec = xfvec(1:n^2);\nvfvec = xfvec(n^2+1:end);\n\nu = real(ifft2(reshape(ufvec,n,n)));\nv = real(ifft2(reshape(vfvec,n,n)));\nA = u.^2+v.^2;\nl = 1-A;\nw = -beta*A;\n\nuft = reshape(fft2(l.*u-w.*v),n^2,1)-d1*Kvec.*ufvec;\nvft = reshape(fft2(w.*u+l.*v),n^2,1)-d2*Kvec.*vfvec;\n\nrhs = [uft;vft];\n```\n\nThe following is cheb method with n=30 and m=1\n\n```\nfunction xsolvec = runrds_cheb(tspan,L,n,beta,d1,d2,m)\n\n[D,x2] = cheb(n-1);\nD2= D^2;\nD2(1,:) = zeros(1,n);\nD2(n,:) = zeros(1,n);%boundary should be 0\nI = eye(length(D2));\nLap = kron(D2,I)+kron(I,D2);\n\nx = x2*L/2;\n[X,Y]=meshgrid(x);\n\nuinit = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid\nvinit = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));\n\nuvecinit = reshape(uinit,n^2,1);\nvvecinit = reshape(vinit,n^2,1);\nxvecinit = [uvecinit;vvecinit];\n\n[t,xsolvec] =ode45(@(t,xvec) rds_cheb(t,L,xvec,beta,Lap,n,d1,d2),tspan,xvecinit);\n\n```\n\n```\nfunction rhs = rds_cheb(t,L,xvec,beta,Lap,n,d1,d2)\n\nuvec = xvec(1:n^2);\nvvec = xvec(n^2+1:end);\n\nAvec = uvec.^2+vvec.^2;\nlvec = 1-Avec;\nwvec = -beta*Avec;\n\nut = lvec.*uvec-wvec.*vvec+d1*4/L^2*Lap*uvec;\nvt = wvec.*uvec+lvec.*vvec+d2*4/L^2*Lap*vvec;\n\nrhs = [ut;vt];\n\n```\n\n\n\n","slug":"Scientific-Computing","published":1,"updated":"2019-01-04T21:40:09.310Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cjqojihrb000tp45kv9b694md","content":"<p><em>A manual for individual use, which focuses on how to solve ordinary and partial differential equation numerically, including how to solve initial value problem with Euler, 2nd- and 4th- order Runge-Kutta and Adams-Bashford method; how to handle boundary value problem with shooting method and direct method and how to deal with PDE with finite difference schemes and spectral methods. Quantum Harmonic Oscillator, Vorticity-Streamfunction Equations, Reaction-Diffusion Systems are are discussed.</em></p>\n<h1 id=\"Initial-Value-Problem\"><a href=\"#Initial-Value-Problem\" class=\"headerlink\" title=\"Initial Value Problem\"></a>Initial Value Problem</h1><p>$$<br>\\frac{d\\overrightarrow{y}}{dt}=f(t,\\overrightarrow{y}) \\quad \\overrightarrow{y}(0)=\\overrightarrow{y_0} \\quad t\\in[0,T]<br>$$</p>\n<h2 id=\"Forward-Euler-Method\"><a href=\"#Forward-Euler-Method\" class=\"headerlink\" title=\"Forward Euler Method\"></a>Forward Euler Method</h2><p>This is the simplest algorithm for solving this problem, which is derived from the definition of the derivative:</p>\n<p>$$<br>\\frac{d\\overrightarrow y}{dt}=\\lim_{\\Delta t \\to 0} \\frac{\\Delta\\overrightarrow y}{\\Delta t} \\approx \\frac{\\overrightarrow y_{n+1}-\\overrightarrow y_n}{t_{n+1}-t_n}<br>$$</p>\n<p>From the above equation, we can get:</p>\n<p>$$<br>\\overrightarrow{y}_{n+1} = \\overrightarrow y_n + \\Delta t \\cdot f(t_n,\\overrightarrow y_n)<br>$$</p>\n<p>Note that each subsequenct approximation in Euler Method is generated from the slope of the previous point. Considering the error coulde be very large, we need to find some ways to improve it.</p>\n<h2 id=\"Improved-from-Euler-Method\"><a href=\"#Improved-from-Euler-Method\" class=\"headerlink\" title=\"Improved from Euler Method\"></a>Improved from Euler Method</h2><p> One way we can think of is to use the slope of other points instead of that of the previous one to predict the next point. For example, the average slope (Heuns Method), or the slope of the midpoint (RK2).</p>\n<h3 id=\"Heuns\"><a href=\"#Heuns\" class=\"headerlink\" title=\"Heuns\"></a>Heuns</h3><p>  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_n,y_n)+f(t_{n+1},y_{n+1})]$$</p>\n<h3 id=\"RK2\"><a href=\"#RK2\" class=\"headerlink\" title=\"RK2\"></a>RK2</h3><p>  $$y_{n+1}=y_n+\\Delta t \\cdot f[t_n+\\frac{\\Delta t}{2},y(t_n+\\frac{\\Delta t}{2})]$$</p>\n<h3 id=\"In-general\"><a href=\"#In-general\" class=\"headerlink\" title=\"In general\"></a>In general</h3><p>  $$y_{n+1}=y_n+\\Delta t[A \\cdot f(t_n,y_n)+B \\cdot f(t+P\\Delta t,y_n+Q\\Delta t \\cdot f(t_n,y_n)]\\where\\quad A+B=1\\quad B\\cdot P=\\frac{1}{2}\\quad B\\cdot Q=\\frac{1}{2}$$</p>\n<ul>\n<li>If $A=\\frac{1}{2}\\Rightarrow B=\\frac{1}{2}\\Rightarrow P=1\\Rightarrow Q=1\\Rightarrow$Heuns Method</li>\n<li>If $A=0\\Rightarrow B=0\\Rightarrow P=\\frac{1}{2}\\Rightarrow Q=\\frac{1}{2}\\Rightarrow$RK2 Method</li>\n</ul>\n<h3 id=\"RK4\"><a href=\"#RK4\" class=\"headerlink\" title=\"RK4\"></a>RK4</h3><p>$$y_{n+1}=y_n+\\frac{\\Delta t}{6}(f_1+2f_2+2f_3+f_4)\\<br>f_1=f(t_n,y_n)\\<br>f_2=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_1)\\<br>f_3=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_2)\\<br>f_4=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_3)$$</p>\n<h3 id=\"Summary-and-Error-Analysis\"><a href=\"#Summary-and-Error-Analysis\" class=\"headerlink\" title=\"Summary and Error Analysis\"></a>Summary and Error Analysis</h3><table>\n<thead>\n<tr>\n<th>Scheme</th>\n<th>Local Error</th>\n<th>Global Error</th>\n<th>Matlab</th>\n<th>Python</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Forward Euler</td>\n<td>$\\Delta t^2$</td>\n<td>$\\Delta t$</td>\n<td></td>\n</tr>\n<tr>\n<td>Heuns/RK2</td>\n<td>$\\Delta t^3$</td>\n<td>$\\Delta t^2$</td>\n<td>ode23</td>\n<td>Method=RK23</td>\n</tr>\n<tr>\n<td>RK4</td>\n<td>$\\Delta t^5$</td>\n<td>$\\Delta t^4$</td>\n<td>ode45</td>\n<td>Method=RK45</td>\n</tr>\n</tbody>\n</table>\n<p>The error in numerical algorithm not only comes from the local error (truncated error) in the algorithm iteself, but also arises from round off error since computer can only keep limit digits of number: $Error_{total}=\\varepsilon_{round\\ off}+\\varepsilon_{truncate}$. If the round-off error is dominant, our algorithm can be unstable to be used. Thats why Backward Euler Method is introduced.</p>\n<h2 id=\"Backward-Euler-Method\"><a href=\"#Backward-Euler-Method\" class=\"headerlink\" title=\"Backward Euler Method\"></a>Backward Euler Method</h2><p>It is an implicit method, which is more stable</p>\n<p>$$y_n=y_{n+1}-\\Delta t \\cdot f(t_{n+1},y_{n+1})$$</p>\n<p>Example:</p>\n<p>$$\\frac{dy}{dt}=\\lambda y\\quad y(0)=y_0$$</p>\n<ul>\n<li><p>FE:<br>$$y_{n+1}=y_n+\\Delta t \\cdot f(t_n,y_n)=y_n+\\Delta t \\cdot \\lambda y \\Rightarrow y_n=(y_0+\\varepsilon_{round_off})(1+\\Delta t \\lambda)^N$$<br>set  $r_{FE}=(1+\\Delta t \\lambda)^N\\Rightarrow y_n=y_0\\cdot r_{FE}^N+\\varepsilon_{round_off}\\cdot r_{FE}^N$</p>\n<ul>\n<li>$\\lambda&gt;0\\Rightarrow |r_{FE}|&gt;1\\Rightarrow$ unconditionally unstable</li>\n<li>$\\lambda&lt;0\\Rightarrow |r_{FE}|&lt;1\\Rightarrow \\begin{cases} \\Delta t&lt;\\frac{2}{|\\lambda|} &amp; stable\\ \\Delta t&gt;\\frac{2}{|\\lambda|} &amp; unsatble\\ \\end{cases}$</li>\n</ul>\n</li>\n<li><p>BE:</p>\n<p>$$y_n=y_{n+1}-\\Delta t\\cdot \\lambda\\cdot y_{n+1}\\Rightarrow y_{n+1}=r_{BE}\\cdot y_n,\\ where\\ r_{BE}=\\frac{1}{1-\\Delta t\\lambda}<br>\\y_n=y_0\\cdot r_{BE}^N+\\varepsilon_{round_off}\\cdot r_{BE}^N$$</p>\n<ul>\n<li>$\\lambda&lt;0\\Rightarrow |r_{FE}|&lt;1\\Rightarrow$ unconditionally stable</li>\n<li>$\\lambda&gt;0\\Rightarrow |r_{FE}|&lt;1\\Rightarrow \\begin{cases} \\Delta t&gt;\\frac{2}{|\\lambda|} &amp; stable\\ \\Delta t&lt;\\frac{2}{|\\lambda|} &amp; unsatble\\ \\end{cases}$</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"MultiStep-Method\"><a href=\"#MultiStep-Method\" class=\"headerlink\" title=\"MultiStep Method\"></a>MultiStep Method</h2><ul>\n<li>Adams-Bash forth (explicit method)<br>$$y_{n+1}=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})$$ </li>\n<li>Adams-Moulthon (implicit method)<br>$$y_{n+1}=y_n+\\frac{\\Delta t}{2}(f_{n+1}+f_n)$$</li>\n<li>Predictor-Corrector<br>$$y_{n+1}^P=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})\\y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_{n+1},y_{n+1}^P)+f_n]$$</li>\n</ul>\n<h2 id=\"Matlab-for-ODE45\"><a href=\"#Matlab-for-ODE45\" class=\"headerlink\" title=\"Matlab for ODE45\"></a>Matlab for ODE45</h2><p>solve this equation $\\frac{d^2y(t)}{dt^2}+\\epsilon[y^2(t)-1]\\frac{dy(t)}{dt}+y(t)=0$ with $\\epsilon$=0.1, t=[0:0.5:32], y(t=0)=$\\sqrt 3$ and $\\frac{dy(t=0)}{dt}$=1 by ode45 method.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function f = fvdposc(t,y,epsilon)</span><br><span class=\"line\">f1 = y(2);                          %f1=y&apos;</span><br><span class=\"line\">f2 = -epsilon*(y(1)^2-1)*y(2)-y(1);%f2=y&apos;&apos;</span><br><span class=\"line\">f = [f1;f2];    %f must be a column vector</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">abstol=10^-6;reltol=10^-6;</span><br><span class=\"line\">options = odeset(&apos;AbsTol&apos;,abstol,&apos;RelTol&apos;,reltol);</span><br><span class=\"line\">%if options not specified, use the default one. the other items must be there.</span><br><span class=\"line\">[T,Y] = ode45( @(t,y) fvdposc(t,y,epsilon),tspan,y0,options);</span><br></pre></td></tr></table></figure>\n<p>In this way, we can get Y is a [65 $\\times$ 2] matrix. This first column is the y values in tspan, and the other columne is y values in tspan.</p>\n<h1 id=\"Boundary-Value-Problem\"><a href=\"#Boundary-Value-Problem\" class=\"headerlink\" title=\"Boundary Value Problem\"></a>Boundary Value Problem</h1><p>There might be multiple solutions to this kind of problem, and we should choose those suit boundary conditions. Lets start with a simple case:</p>\n<p>$$<br>\\frac{d^2y}{dt^2} = f(t,y,\\frac{dy}{dt})\\quad y(a) = \\alpha\\quad y(b) = \\beta<br>$$</p>\n<h2 id=\"Shooting-Method\"><a href=\"#Shooting-Method\" class=\"headerlink\" title=\"Shooting Method\"></a>Shooting Method</h2><p>Actually, BVP is  comparable to IVP:</p>\n<ul>\n<li>IVP: y(a)=$\\alpha$, y(a)=A</li>\n<li>BVP: y(a)=$\\alpha$, y(b)=$\\beta$</li>\n</ul>\n<p>So we can guess an initial condition to see how difference the result from the other boundary value; and decide a new initial guess to repeat the above process until the result reaches the other boundary value.</p>\n<h2 id=\"Direct-Linear-BVP\"><a href=\"#Direct-Linear-BVP\" class=\"headerlink\" title=\"Direct-Linear BVP\"></a>Direct-Linear BVP</h2><p>Here we can consider a general case:</p>\n<p>$$<br>\\frac{d^2y}{dt^2}=p(t)\\frac{dy}{dt}+q(t)y+r(t)\\<br>\\alpha_1y(a)+\\beta_1y(a)=\\gamma_1\\<br>\\alpha_2y(b)+\\beta_2y(b)=\\gamma_2<br>$$</p>\n<p>Combine Taylor series and central difference method $y=\\frac{y(t+\\Delta t)-y(t-\\Delta t)}{2\\Delta t}+O(\\Delta t^2)$, we can get $y=\\frac{y(t+\\Delta t)-2y(t)+y(t-\\Delta t)}{\\Delta t^2}+O(\\Delta t^2)$. Finally, we can get: </p>\n<p>$$[1-\\frac{p(t)\\Delta t}{2}]\\cdot y(t+\\Delta t)-[2+q(t)\\Delta t^2]\\cdot y(t)+[1+\\frac{p(t)\\Delta t}{2}]\\cdot y(t-\\Delta t)=r(t)\\Delta t^2$$</p>\n<p>Convert it in to matrix form:</p>\n<p>$$A\\times \\overrightarrow x = \\overrightarrow b$$</p>\n<p>$$ \\begin{pmatrix} 1 &amp; 0 &amp;\\cdots &amp;\\cdots &amp;\\cdots &amp; 0 \\ a &amp; b &amp; c &amp; 0 &amp;\\cdots &amp;0 \\0&amp;a&amp;b&amp;c&amp;\\cdots&amp;0\\\\vdots&amp;\\ddots&amp;\\ddots&amp;\\ddots&amp;\\ddots&amp;\\vdots\\\\vdots&amp;\\ddots&amp;\\ddots&amp;a&amp;b&amp;c\\0&amp;\\cdots&amp;\\cdots&amp;\\cdots&amp;a&amp;1 \\end{pmatrix} \\times \\begin{pmatrix}y(t_0)\\y(t+\\Delta t)\\y(t+2\\Delta t)\\\\vdots\\\\vdots\\y(t_N) \\end{pmatrix}=\\begin{pmatrix} \\alpha\\r(t+\\Delta t)\\Delta t^2\\ r(t+2\\Delta t)\\Delta t^2\\\\vdots\\\\vdots\\\\beta \\end{pmatrix}$$</p>\n<p>In Matlab, we can use function <code>X=A\\b</code> or <code>eig(A)</code> to solve it; in python(numpy), function <code>linalg.solve(A,b)</code> or <code>eig(A)</code> also works.</p>\n<h2 id=\"Newton-Raphson-Method\"><a href=\"#Newton-Raphson-Method\" class=\"headerlink\" title=\"Newton-Raphson Method\"></a>Newton-Raphson Method</h2><p>One thing must be noted that, initial guess for this method should be close to the real value, otherwise it may diverge.<br>$$x_{n+1}=x_n-\\frac{f(x_n)}{f(x_n)}$$</p>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><ol>\n<li>Approximate y, y using central difference formula;</li>\n<li>Approximate boundary condition using FDF, DBF</li>\n<li>Solve $A\\overrightarrow x=\\overrightarrow b$</li>\n<li>solutionO($\\Delta t^2$)</li>\n</ol>\n<h2 id=\"Quantum-Harmonic-Oscillation\"><a href=\"#Quantum-Harmonic-Oscillation\" class=\"headerlink\" title=\"Quantum Harmonic Oscillation\"></a>Quantum Harmonic Oscillation</h2><p>$$\\frac{d^2\\phi_n}{dx^2}-[Kx^2-\\varepsilon_n]\\phi_n=0$$<br>we expect the solution $\\phi_n(x)\\rightarrow 0$ as $x\\rightarrow \\pm \\infty$ and $\\varepsilon_n&gt;0$ is the quantum energy. Note that $K=km/\\hbar^2$ and $\\varepsilon_n=E_nm/\\hbar^2$. Here take K=1, and always normalize so that $\\int_{-\\infty} ^{+\\infty} {|\\phi_n|^2} \\,{\\rm d}x=1$. Calculate the first five normalized eigenfunctions ($\\phi_n$) and eigenvalues($\\varepsilon_n$) up to tolerance of $10^{-4}$ in increasing order such that the first eigenvalue is the lowest one.</p>\n<ul>\n<li>Shooting method</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function f=pdefunc(x,y,e)</span><br><span class=\"line\"></span><br><span class=\"line\">f1 = y(2);</span><br><span class=\"line\">f2 = (x^2-e)*y(1);</span><br><span class=\"line\"></span><br><span class=\"line\">f = [f1;f2];</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">L=4; dx=0.1; e_start=0.5; tol=10^-4;</span><br><span class=\"line\"></span><br><span class=\"line\">xspan = -L:dx:L;</span><br><span class=\"line\">A = 1; % suggest A=phi(-L)=phi(L)</span><br><span class=\"line\"></span><br><span class=\"line\">for modes=1:5</span><br><span class=\"line\">    e = e_start;</span><br><span class=\"line\">    de=0.01;</span><br><span class=\"line\">    for j=1:1000</span><br><span class=\"line\">        y0 = [A;A*sqrt(L^2-e)];</span><br><span class=\"line\">        </span><br><span class=\"line\">        [x,phi] = ode45( @(x,phi) pdefunc(x,phi,e), xspan ,y0);</span><br><span class=\"line\">        </span><br><span class=\"line\">        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);</span><br><span class=\"line\">        if abs(rightbc)&lt;tol</span><br><span class=\"line\">            eigen_e(modes,1)=e;</span><br><span class=\"line\">            break;</span><br><span class=\"line\">        end</span><br><span class=\"line\">        </span><br><span class=\"line\">        if (-1)^(1+modes)*rightbc&gt;0</span><br><span class=\"line\">            e = e+de;</span><br><span class=\"line\">        else</span><br><span class=\"line\">            de = de/2;</span><br><span class=\"line\">            e = e-de;</span><br><span class=\"line\">        end</span><br><span class=\"line\">    end</span><br><span class=\"line\">    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));</span><br><span class=\"line\">        e_start = e+0.2;</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">%eigen_phi,eigen_e are what we want</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Direct Method</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">L=4; dx=0.1; </span><br><span class=\"line\">xspan = -L:dx:L;</span><br><span class=\"line\">max = length(xspan)-2;</span><br><span class=\"line\">A = zeros(max,max);</span><br><span class=\"line\">phi_sort = zeros(max+2,max+2);</span><br><span class=\"line\">% build up A matrix which doesn&apos;t consider phi(x1) and phi(xn). A is built</span><br><span class=\"line\">% based on 2nd order central difference. The first and last row don&apos;t</span><br><span class=\"line\">% consider x1 and xn, use FDF and BDF and approximation to make phi(x2) and</span><br><span class=\"line\">% phi(x3) express phi(x1); phi(xn-2) and phi(xn-1) express phi(xn).</span><br><span class=\"line\">A(1,1:2) = [2/3/dx^2+xspan(2)^2,-2/3/dx^2];</span><br><span class=\"line\">A(end,end-1:end) = [-2/3/dx^2,2/3/dx^2+xspan(end-1)^2];</span><br><span class=\"line\">i = 2;</span><br><span class=\"line\">while i&lt;max</span><br><span class=\"line\">    A(i,i-1) = -1/dx^2;</span><br><span class=\"line\">    A(i,i+1) = -1/dx^2;</span><br><span class=\"line\">    A(i,i) = 2/dx^2+xspan(i+1)^2;</span><br><span class=\"line\">    i=i+1;</span><br><span class=\"line\">end</span><br><span class=\"line\">%phi function only contains [phi(2),phi(3),...phi(n-2),phi(n-1)]</span><br><span class=\"line\">[phi,e]=eig(A);</span><br><span class=\"line\"></span><br><span class=\"line\">%sort phi function based on ascending energy.</span><br><span class=\"line\">for i=1:max</span><br><span class=\"line\">    eng(i,1) = e(i,i);</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">[eng, Index_eng] = sort(eng);</span><br><span class=\"line\"></span><br><span class=\"line\">%only get the first five phi functions. </span><br><span class=\"line\">%phi(1)/phi(N) are calculated based on FDF/BDF method without approximation.</span><br><span class=\"line\">for i =1:5</span><br><span class=\"line\">    phi_sort(2:end-1,i) = phi(:,Index_eng(i));</span><br><span class=\"line\">    phi_sort(1,i) = (4*phi_sort(2,i)-phi_sort(3,i))/(3+2*dx*sqrt(L^2-eng(i)));</span><br><span class=\"line\">    phi_sort(end,i) = (4*phi_sort(end-1,i)-phi_sort(end-2,i))/(3+2*dx*sqrt(L^2-eng(i)));</span><br><span class=\"line\">    phi_sort(:,i) = phi_sort(:,i)/sqrt(trapz(xspan,phi_sort(:,i).^2));</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">%phi_sort,eng is the result</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Shooting for nonlinear cases</li>\n</ul>\n<p>$$\\frac{d^2\\phi_n}{dx^2}-[\\gamma |\\phi_n|^2+Kx^2-\\varepsilon_n]\\phi_n=0$$\\</p>\n<p>Still use $x\\in [-L,L]$ with L=2 and choose xspan = -L:0.1:L. Find the first two normalized modes for  $\\gamma=0.05$:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">L=2; dx=0.1; e_start=0.5; tol=10^-4; gama=0.05; A_start=0.2;</span><br><span class=\"line\">xspan = -L:dx:L;</span><br><span class=\"line\"></span><br><span class=\"line\">for modes=1:2</span><br><span class=\"line\">    e = e_start;</span><br><span class=\"line\">    de=0.01;</span><br><span class=\"line\">    for j=1:1000</span><br><span class=\"line\">        A = A_start;</span><br><span class=\"line\">        dA = 0.1;</span><br><span class=\"line\">        for a=1:1000</span><br><span class=\"line\">            y0 = [A;A*sqrt(L^2-e)];</span><br><span class=\"line\">            </span><br><span class=\"line\">            [x,phi] = ode45( @(x,phi) nolinpdefunc(x,phi,gama,e), xspan ,y0);</span><br><span class=\"line\">         </span><br><span class=\"line\">            AA = trapz(x,phi(:,1).^2);</span><br><span class=\"line\">           </span><br><span class=\"line\">            if abs(AA-1)&lt;tol</span><br><span class=\"line\">                opt_A(modes,1)=A;</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            end</span><br><span class=\"line\">            if AA&gt;1</span><br><span class=\"line\">                A = A-dA;</span><br><span class=\"line\">            else</span><br><span class=\"line\">                dA = dA/2;</span><br><span class=\"line\">                A = A+dA;</span><br><span class=\"line\">            end       </span><br><span class=\"line\">        end</span><br><span class=\"line\">        </span><br><span class=\"line\">        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);</span><br><span class=\"line\">        if abs(rightbc)&lt;tol</span><br><span class=\"line\">            eigen_e(modes,1)=e;</span><br><span class=\"line\">            break;</span><br><span class=\"line\">        end</span><br><span class=\"line\">        </span><br><span class=\"line\">        if (-1)^(1+modes)*rightbc&gt;0</span><br><span class=\"line\">            e = e+de;</span><br><span class=\"line\">        else</span><br><span class=\"line\">            de = de/2;</span><br><span class=\"line\">            e = e-de;</span><br><span class=\"line\">        end</span><br><span class=\"line\">    end</span><br><span class=\"line\">    e_start = e+1;</span><br><span class=\"line\">    A_start = A+1;</span><br><span class=\"line\">    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));    </span><br><span class=\"line\">end</span><br></pre></td></tr></table></figure>\n<h1 id=\"Partial-Differential-Equations\"><a href=\"#Partial-Differential-Equations\" class=\"headerlink\" title=\"Partial Differential Equations\"></a>Partial Differential Equations</h1><p>Solving PDE is harder than ODE, because we need to consider both initial conditions and boundary conditions, also need to solve both in time and in space. The classic PDE is vortivity-streamfunction equations and reaction-diffusion systems. We will go through these two systems to show how to slove PDE.</p>\n<h2 id=\"Finite-Scheme-Method-for-Vorticity-Streamfunction-Equations\"><a href=\"#Finite-Scheme-Method-for-Vorticity-Streamfunction-Equations\" class=\"headerlink\" title=\"Finite Scheme Method for Vorticity-Streamfunction Equations\"></a>Finite Scheme Method for Vorticity-Streamfunction Equations</h2><p>$$\\omega_t+[\\psi,\\omega]=\\mu\\nabla^2\\psi\\quad \\nabla^2\\psi=\\omega\\<br>where\\; [\\psi,\\omega]=\\psi_x\\omega_y-\\psi_y\\omega_x \\; and \\; \\nabla^2=\\partial_x^2+\\partial_y^2$$</p>\n<ul>\n<li><p>Steps:</p>\n<ol>\n<li>Elliptic Solve: given $\\omega_0 \\rightarrow$ compute $\\psi_0$ by using $ \\nabla^2\\psi=\\omega$</li>\n<li>Time-Stepping: choose step $\\Delta t$ compute $\\omega $ using $\\omega_{k+1}=\\omega_k+\\Delta t\\cdot f(\\psi^k,\\omega^k)$</li>\n<li>Iterate</li>\n</ol>\n</li>\n<li><p>Step 1: the elliptic problem<br>$$(\\psi_{mn})<em>{xx}+(\\psi</em>{mn})<em>{yy}=\\omega</em>{mn}$$<br>By using CDF:<br>$$\\frac{\\psi_{m-1,n}-2\\psi_{m,n}+\\psi_{m+1,n}}{\\Delta x^2}+\\frac{\\psi_{m,n-1}-2\\psi_{m,n}+\\psi_{m,n+1}}{\\Delta y^2}=\\omega_{m,n}\\delta^2$$<br>If we set $\\Delta x=\\Delta y$, and reshape the matrix $\\psi_{m,n}$ and $\\omega_{m,n}$ (m=n)to vectors (the same thing as matlab fucntion <code>reshape(matrix,n^2,1)</code>), we can write the above equation into a matrix form:<br>$$A\\overrightarrow \\psi = \\overrightarrow \\omega $$<br>where $A=A/\\delta^2$, $A=A_D+A_x+A_y$, $A_D=-4\\psi_{m,n}$, $A_x=\\psi_{m-1,n}+\\psi_{m,n-1}$ and $A_y=\\psi_{m,n-1}+\\psi_{m,n+1}$</p>\n</li>\n<li><p><em>Matlab script</em></p>\n<p>  $A=\\nabla^2$, $B=\\partial_x$, $C=\\partial_y$</p>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function [A B C] = derivmatrix(dx,dy,n)</span><br><span class=\"line\"></span><br><span class=\"line\">e1 = ones(n^2,1);</span><br><span class=\"line\">%A = dx^2+dy^2</span><br><span class=\"line\"></span><br><span class=\"line\">%A = (AD+AX+AY)/dx/dy; AD=-4y(m,n),AX=y(m-1,n)+y(m+1,n), AY=y(m,n-1)+y(m,n+1)</span><br><span class=\"line\">AD = spdiags(-4*e1,0,n^2,n^2); </span><br><span class=\"line\">AD(1,1)=2;%set the first element not -4 to avoid denominator too small</span><br><span class=\"line\">AX = spdiags([e1 e1 e1 e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2);</span><br><span class=\"line\">AY = spdiags([e1 e1],[-1 1],n^2,n^2);</span><br><span class=\"line\">for i=1:n</span><br><span class=\"line\">    AY(1+n*(i-1),n*i) = 1;</span><br><span class=\"line\">    AY(n*i,1+n*(i-1)) = 1;</span><br><span class=\"line\">    if i&lt;n</span><br><span class=\"line\">        AY(n*i,1+n*i) = 0;</span><br><span class=\"line\">        AY(1+n*i,n*i) = 0;</span><br><span class=\"line\">    end</span><br><span class=\"line\">end</span><br><span class=\"line\">A = (AD+AX+AY)/(dx*dy);</span><br><span class=\"line\"></span><br><span class=\"line\">%B = dx</span><br><span class=\"line\">%B = (y(m+1,n)-y(m-1,n))/(2*dx)</span><br><span class=\"line\">B = spdiags([e1 -e1 e1 -e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2)/(2*dx);</span><br><span class=\"line\"></span><br><span class=\"line\">%C = dy</span><br><span class=\"line\">%C = (y(m,n+1)-y(m,n-1))/(2*dy)</span><br><span class=\"line\">C = spdiags([-e1 e1],[-1,1],n^2,n^2);</span><br><span class=\"line\">for i=1:n</span><br><span class=\"line\">    C(1+n*(i-1),n*i) = -1;</span><br><span class=\"line\">    C(n*i,1+n*(i-1)) = 1;</span><br><span class=\"line\">    if i&lt;n</span><br><span class=\"line\">        C(n*i,1+n*i) = 0;</span><br><span class=\"line\">        C(1+n*i,n*i) = 0;</span><br><span class=\"line\">    end</span><br><span class=\"line\">end</span><br><span class=\"line\">C = C/(2*dy);</span><br></pre></td></tr></table></figure>\n<p>then, we could use one of these two method to slove $\\psi$</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">psi = A\\w;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[L,U,P] = lu(A);</span><br><span class=\"line\">y=L\\(P*w);</span><br><span class=\"line\">psi = U\\y;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Step 2: Method Line</li>\n</ul>\n<p>$$<br>\\nabla^2\\psi(x,y)=f(x,y)\\qquad+b.c.\\<br>u_t(t,x)=u_x(t,x)\\quad+i.c.,b.c.\\<br>u_x(t,x)\\approx\\frac{u(x+\\Delta x)-u(x-\\Delta x)}{2\\Delta x}<br>$$<br>We have to condiser the stability of this method. Choose $\\lambda$ carefully to make sure it is stable and also will not run forever.<br>$$u_n^{(m)}=g^mexp(i\\zeta\\Delta x)\\<br>$$\\lambda =\\frac{\\Delta t^{num-t-der}} {\\Delta x^{num-x-der}}$$</p>\n<h2 id=\"Spectral-Method-for-Vorticity-Streamfunction-Equations\"><a href=\"#Spectral-Method-for-Vorticity-Streamfunction-Equations\" class=\"headerlink\" title=\"Spectral Method for Vorticity-Streamfunction Equations\"></a>Spectral Method for Vorticity-Streamfunction Equations</h2><p>expand u(x,t):</p>\n<p>$$u(x,t)=\\sum_{k=1}^N a_k(t)\\phi_k(x)\\qquad$$<br> where $\\phi_k(x)$are orthogonal<br>Using Fourier Series</p>\n<p>$$\\widehat{u}(t)=u(k,t)=\\sum_{n=1}^N u(n,t)e^{-i2\\pi(k-1)(n-1)/N}\\\\qquad\\;u(n,t)=1/N\\sum_{n=1}^N \\widehat u(t)e^{i2\\pi(k-1)(n-1)/N}$$<br>Derivative property:<br>$$\\widehat u^{(m)}(x,t)=(ik)^{(m)}\\widehat u(k,t)$$<br>PDE  Fourier Space<br>$$u_t=Lu+N(u) \\Longrightarrow \\widehat(u)_t=\\alpha(k)\\widehat u+\\widehat N(u)$$<br>Here attached the script for solve VSE by the above two methods.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">clear all; clf; close all; clc</span><br><span class=\"line\">nu = 0.001;</span><br><span class=\"line\">n=64;</span><br><span class=\"line\">L=10;</span><br><span class=\"line\">tspan = 0:0.5:4;</span><br><span class=\"line\"></span><br><span class=\"line\">w1 = runvs(L,n,tspan,nu,1);</span><br><span class=\"line\"></span><br><span class=\"line\">w2 = runvs(L,n,tspan,nu,2);</span><br><span class=\"line\"></span><br><span class=\"line\">w3 = runvs(L,n,tspan,nu,3);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function wfsol = runvs(L,n,tspan,nu,choice)</span><br><span class=\"line\"></span><br><span class=\"line\">x2 = linspace(-L/2,L/2,n+1);</span><br><span class=\"line\">x = x2(1:n);</span><br><span class=\"line\">dx = x(2)-x(1);</span><br><span class=\"line\"></span><br><span class=\"line\">[X,Y] = meshgrid(x);%grid</span><br><span class=\"line\">[A,B,C] = derivmatrix(dx,dx,n);%apply to vector [64*64,1]</span><br><span class=\"line\"></span><br><span class=\"line\">wfinit = exp(-X.^2-Y.^2/20);%grid</span><br><span class=\"line\">wfinitvect = reshape(wfinit,n^2,1);%vector</span><br><span class=\"line\"></span><br><span class=\"line\">[t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,1),tspan,wfinitvect);</span><br><span class=\"line\"></span><br><span class=\"line\">if choice==3</span><br><span class=\"line\">    kx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];</span><br><span class=\"line\">    kx(1) = 1e-6;</span><br><span class=\"line\"></span><br><span class=\"line\">    [KX,KY]=meshgrid(kx);</span><br><span class=\"line\">    K = KX.^2+KY.^2;</span><br><span class=\"line\">    </span><br><span class=\"line\">    [t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,K)tspan,wfinitvect);</span><br><span class=\"line\">end</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function rhs = vortstream(t,w,n,nu,A,B,C,choice,K)</span><br><span class=\"line\"></span><br><span class=\"line\">if choice==1</span><br><span class=\"line\">    psi = A\\w;%vector</span><br><span class=\"line\">elseif choice==2</span><br><span class=\"line\">    [L,U,P] = lu(A);</span><br><span class=\"line\">    y=L\\(P*w);</span><br><span class=\"line\">    psi = U\\y;</span><br><span class=\"line\">else</span><br><span class=\"line\">    wf = fft2(reshape(w,n,n));</span><br><span class=\"line\">    psif = -wf./K;</span><br><span class=\"line\">    psi = reshape(real(ifft2(psif)),n^2,1);</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">rhs = -(B*psi).*(C*w)+(C*psi).*(B*w)+nu*A*w;%vector</span><br></pre></td></tr></table></figure>\n<h2 id=\"Chebishev-Polynomials\"><a href=\"#Chebishev-Polynomials\" class=\"headerlink\" title=\"Chebishev Polynomials\"></a>Chebishev Polynomials</h2><p>$$\\phi_k(x)=T_k(x)\\quad T_k(cos\\theta)=cosk\\theta$$<br>Matlab Script:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function [D,x] = cheb(N)</span><br><span class=\"line\">  if N==0, D=0; x=1; return, end</span><br><span class=\"line\">  x = cos(pi*(0:N)/N)&apos;; </span><br><span class=\"line\">  c = [2; ones(N-1,1); 2].*(-1).^(0:N)&apos;;</span><br><span class=\"line\">  X = repmat(x,1,N+1);</span><br><span class=\"line\">  dX = X-X&apos;;                  </span><br><span class=\"line\">  D  = (c*(1./c)&apos;)./(dX+(eye(N+1)));      % off-diagonal entries</span><br><span class=\"line\">  D  = D - diag(sum(D&apos;));                 % diagonal entries</span><br></pre></td></tr></table></figure>\n<p>Solve reaction-diffusion system with both spectral and cheb methods<br>$$U_t=\\lambda(A)U-\\omega (A)V+D_1\\nabla^2U\\V_t=\\omega (a)U+\\lambda(A)V+D_2\\nabla^2V$$<br>where $A^2=U^2+V^2$ and $\\nabla^2=\\partial_x^2+\\partial_y^2$. Consider $\\lambda(A)=1-A^2$ and $\\omega(A)=-\\beta A^2$</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">clear all; close all; clc</span><br><span class=\"line\">L=20;n=64;beta=1;d1=0.1;d2=d1;m=1;</span><br><span class=\"line\">tspan=0:0.5:4;</span><br><span class=\"line\"></span><br><span class=\"line\">uv1 = runrds_fft(tspan,L,n,beta,d1,d2,m);</span><br><span class=\"line\">A1 = real(uv1);</span><br><span class=\"line\">A2 = imag(uv1);</span><br><span class=\"line\"></span><br><span class=\"line\">n=31;</span><br><span class=\"line\">uv2 = runrds_cheb(tspan,L,n,beta,d1,d2,m);</span><br><span class=\"line\">A3 = uv2;</span><br></pre></td></tr></table></figure>\n<p>we consider $x,y \\in[-10,10]$, n=64, $\\beta =1$, $D_1=D_2=0.1$, m=1, tspan=0:0.5:4 and $u_f$ stacked on top of $v_f$.<br>The following is FFT(spectral) method:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function xfsol = runrds_fft(tspan,L,n,beta,d1,d2,m)</span><br><span class=\"line\"></span><br><span class=\"line\">x2 = linspace(-L/2,L/2,n+1);</span><br><span class=\"line\">x = x2(1:n);</span><br><span class=\"line\">y=x;</span><br><span class=\"line\"></span><br><span class=\"line\">kx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];</span><br><span class=\"line\">kx(1) = 1e-6;</span><br><span class=\"line\">ky=kx;</span><br><span class=\"line\"></span><br><span class=\"line\">[X,Y]=meshgrid(x,y);</span><br><span class=\"line\">[KX,KY]=meshgrid(kx,ky);</span><br><span class=\"line\">K = KX.^2+KY.^2;</span><br><span class=\"line\">Kvec = reshape(K,n^2,1);</span><br><span class=\"line\"></span><br><span class=\"line\">uint = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid</span><br><span class=\"line\">vint = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));</span><br><span class=\"line\">ufint = fft2(uint);</span><br><span class=\"line\">vfint = fft2(vint);</span><br><span class=\"line\">ufvecint = reshape(ufint,n^2,1);</span><br><span class=\"line\">vfvecint = reshape(vfint,n^2,1);</span><br><span class=\"line\">xfvecint = [ufvecint;vfvecint];</span><br><span class=\"line\"></span><br><span class=\"line\">[t,xfsol] = ode45(@(t,xfvec) rds_fft(t,xfvec,beta,Kvec,n,d1,d2),tspan,xfvecint);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function rhs = rds_fft(t,xfvec,beta,Kvec,n,d1,d2)</span><br><span class=\"line\"></span><br><span class=\"line\">ufvec = xfvec(1:n^2);</span><br><span class=\"line\">vfvec = xfvec(n^2+1:end);</span><br><span class=\"line\"></span><br><span class=\"line\">u = real(ifft2(reshape(ufvec,n,n)));</span><br><span class=\"line\">v = real(ifft2(reshape(vfvec,n,n)));</span><br><span class=\"line\">A = u.^2+v.^2;</span><br><span class=\"line\">l = 1-A;</span><br><span class=\"line\">w = -beta*A;</span><br><span class=\"line\"></span><br><span class=\"line\">uft = reshape(fft2(l.*u-w.*v),n^2,1)-d1*Kvec.*ufvec;</span><br><span class=\"line\">vft = reshape(fft2(w.*u+l.*v),n^2,1)-d2*Kvec.*vfvec;</span><br><span class=\"line\"></span><br><span class=\"line\">rhs = [uft;vft];</span><br></pre></td></tr></table></figure>\n<p>The following is cheb method with n=30 and m=1</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function xsolvec = runrds_cheb(tspan,L,n,beta,d1,d2,m)</span><br><span class=\"line\"></span><br><span class=\"line\">[D,x2] = cheb(n-1);</span><br><span class=\"line\">D2= D^2;</span><br><span class=\"line\">D2(1,:) = zeros(1,n);</span><br><span class=\"line\">D2(n,:) = zeros(1,n);%boundary should be 0</span><br><span class=\"line\">I = eye(length(D2));</span><br><span class=\"line\">Lap = kron(D2,I)+kron(I,D2);</span><br><span class=\"line\"></span><br><span class=\"line\">x = x2*L/2;</span><br><span class=\"line\">[X,Y]=meshgrid(x);</span><br><span class=\"line\"></span><br><span class=\"line\">uinit = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid</span><br><span class=\"line\">vinit = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));</span><br><span class=\"line\"></span><br><span class=\"line\">uvecinit = reshape(uinit,n^2,1);</span><br><span class=\"line\">vvecinit = reshape(vinit,n^2,1);</span><br><span class=\"line\">xvecinit = [uvecinit;vvecinit];</span><br><span class=\"line\"></span><br><span class=\"line\">[t,xsolvec] =ode45(@(t,xvec) rds_cheb(t,L,xvec,beta,Lap,n,d1,d2),tspan,xvecinit);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function rhs = rds_cheb(t,L,xvec,beta,Lap,n,d1,d2)</span><br><span class=\"line\"></span><br><span class=\"line\">uvec = xvec(1:n^2);</span><br><span class=\"line\">vvec = xvec(n^2+1:end);</span><br><span class=\"line\"></span><br><span class=\"line\">Avec = uvec.^2+vvec.^2;</span><br><span class=\"line\">lvec = 1-Avec;</span><br><span class=\"line\">wvec = -beta*Avec;</span><br><span class=\"line\"></span><br><span class=\"line\">ut = lvec.*uvec-wvec.*vvec+d1*4/L^2*Lap*uvec;</span><br><span class=\"line\">vt = wvec.*uvec+lvec.*vvec+d2*4/L^2*Lap*vvec;</span><br><span class=\"line\"></span><br><span class=\"line\">rhs = [ut;vt];</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"excerpt":"","more":"<p><em>A manual for individual use, which focuses on how to solve ordinary and partial differential equation numerically, including how to solve initial value problem with Euler, 2nd- and 4th- order Runge-Kutta and Adams-Bashford method; how to handle boundary value problem with shooting method and direct method and how to deal with PDE with finite difference schemes and spectral methods. Quantum Harmonic Oscillator, Vorticity-Streamfunction Equations, Reaction-Diffusion Systems are are discussed.</em></p>\n<h1 id=\"Initial-Value-Problem\"><a href=\"#Initial-Value-Problem\" class=\"headerlink\" title=\"Initial Value Problem\"></a>Initial Value Problem</h1><p>$$<br>\\frac{d\\overrightarrow{y}}{dt}=f(t,\\overrightarrow{y}) \\quad \\overrightarrow{y}(0)=\\overrightarrow{y_0} \\quad t\\in[0,T]<br>$$</p>\n<h2 id=\"Forward-Euler-Method\"><a href=\"#Forward-Euler-Method\" class=\"headerlink\" title=\"Forward Euler Method\"></a>Forward Euler Method</h2><p>This is the simplest algorithm for solving this problem, which is derived from the definition of the derivative:</p>\n<p>$$<br>\\frac{d\\overrightarrow y}{dt}=\\lim_{\\Delta t \\to 0} \\frac{\\Delta\\overrightarrow y}{\\Delta t} \\approx \\frac{\\overrightarrow y_{n+1}-\\overrightarrow y_n}{t_{n+1}-t_n}<br>$$</p>\n<p>From the above equation, we can get:</p>\n<p>$$<br>\\overrightarrow{y}_{n+1} = \\overrightarrow y_n + \\Delta t \\cdot f(t_n,\\overrightarrow y_n)<br>$$</p>\n<p>Note that each subsequenct approximation in Euler Method is generated from the slope of the previous point. Considering the error coulde be very large, we need to find some ways to improve it.</p>\n<h2 id=\"Improved-from-Euler-Method\"><a href=\"#Improved-from-Euler-Method\" class=\"headerlink\" title=\"Improved from Euler Method\"></a>Improved from Euler Method</h2><p> One way we can think of is to use the slope of other points instead of that of the previous one to predict the next point. For example, the average slope (Heuns Method), or the slope of the midpoint (RK2).</p>\n<h3 id=\"Heuns\"><a href=\"#Heuns\" class=\"headerlink\" title=\"Heuns\"></a>Heuns</h3><p>  $$y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_n,y_n)+f(t_{n+1},y_{n+1})]$$</p>\n<h3 id=\"RK2\"><a href=\"#RK2\" class=\"headerlink\" title=\"RK2\"></a>RK2</h3><p>  $$y_{n+1}=y_n+\\Delta t \\cdot f[t_n+\\frac{\\Delta t}{2},y(t_n+\\frac{\\Delta t}{2})]$$</p>\n<h3 id=\"In-general\"><a href=\"#In-general\" class=\"headerlink\" title=\"In general\"></a>In general</h3><p>  $$y_{n+1}=y_n+\\Delta t[A \\cdot f(t_n,y_n)+B \\cdot f(t+P\\Delta t,y_n+Q\\Delta t \\cdot f(t_n,y_n)]\\where\\quad A+B=1\\quad B\\cdot P=\\frac{1}{2}\\quad B\\cdot Q=\\frac{1}{2}$$</p>\n<ul>\n<li>If $A=\\frac{1}{2}\\Rightarrow B=\\frac{1}{2}\\Rightarrow P=1\\Rightarrow Q=1\\Rightarrow$Heuns Method</li>\n<li>If $A=0\\Rightarrow B=0\\Rightarrow P=\\frac{1}{2}\\Rightarrow Q=\\frac{1}{2}\\Rightarrow$RK2 Method</li>\n</ul>\n<h3 id=\"RK4\"><a href=\"#RK4\" class=\"headerlink\" title=\"RK4\"></a>RK4</h3><p>$$y_{n+1}=y_n+\\frac{\\Delta t}{6}(f_1+2f_2+2f_3+f_4)\\<br>f_1=f(t_n,y_n)\\<br>f_2=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_1)\\<br>f_3=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_2)\\<br>f_4=f(t_n+\\frac{\\Delta t}{2},y_n+\\frac{\\Delta t}{2}\\cdot f_3)$$</p>\n<h3 id=\"Summary-and-Error-Analysis\"><a href=\"#Summary-and-Error-Analysis\" class=\"headerlink\" title=\"Summary and Error Analysis\"></a>Summary and Error Analysis</h3><table>\n<thead>\n<tr>\n<th>Scheme</th>\n<th>Local Error</th>\n<th>Global Error</th>\n<th>Matlab</th>\n<th>Python</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Forward Euler</td>\n<td>$\\Delta t^2$</td>\n<td>$\\Delta t$</td>\n<td></td>\n</tr>\n<tr>\n<td>Heuns/RK2</td>\n<td>$\\Delta t^3$</td>\n<td>$\\Delta t^2$</td>\n<td>ode23</td>\n<td>Method=RK23</td>\n</tr>\n<tr>\n<td>RK4</td>\n<td>$\\Delta t^5$</td>\n<td>$\\Delta t^4$</td>\n<td>ode45</td>\n<td>Method=RK45</td>\n</tr>\n</tbody>\n</table>\n<p>The error in numerical algorithm not only comes from the local error (truncated error) in the algorithm iteself, but also arises from round off error since computer can only keep limit digits of number: $Error_{total}=\\varepsilon_{round\\ off}+\\varepsilon_{truncate}$. If the round-off error is dominant, our algorithm can be unstable to be used. Thats why Backward Euler Method is introduced.</p>\n<h2 id=\"Backward-Euler-Method\"><a href=\"#Backward-Euler-Method\" class=\"headerlink\" title=\"Backward Euler Method\"></a>Backward Euler Method</h2><p>It is an implicit method, which is more stable</p>\n<p>$$y_n=y_{n+1}-\\Delta t \\cdot f(t_{n+1},y_{n+1})$$</p>\n<p>Example:</p>\n<p>$$\\frac{dy}{dt}=\\lambda y\\quad y(0)=y_0$$</p>\n<ul>\n<li><p>FE:<br>$$y_{n+1}=y_n+\\Delta t \\cdot f(t_n,y_n)=y_n+\\Delta t \\cdot \\lambda y \\Rightarrow y_n=(y_0+\\varepsilon_{round_off})(1+\\Delta t \\lambda)^N$$<br>set  $r_{FE}=(1+\\Delta t \\lambda)^N\\Rightarrow y_n=y_0\\cdot r_{FE}^N+\\varepsilon_{round_off}\\cdot r_{FE}^N$</p>\n<ul>\n<li>$\\lambda&gt;0\\Rightarrow |r_{FE}|&gt;1\\Rightarrow$ unconditionally unstable</li>\n<li>$\\lambda&lt;0\\Rightarrow |r_{FE}|&lt;1\\Rightarrow \\begin{cases} \\Delta t&lt;\\frac{2}{|\\lambda|} &amp; stable\\ \\Delta t&gt;\\frac{2}{|\\lambda|} &amp; unsatble\\ \\end{cases}$</li>\n</ul>\n</li>\n<li><p>BE:</p>\n<p>$$y_n=y_{n+1}-\\Delta t\\cdot \\lambda\\cdot y_{n+1}\\Rightarrow y_{n+1}=r_{BE}\\cdot y_n,\\ where\\ r_{BE}=\\frac{1}{1-\\Delta t\\lambda}<br>\\y_n=y_0\\cdot r_{BE}^N+\\varepsilon_{round_off}\\cdot r_{BE}^N$$</p>\n<ul>\n<li>$\\lambda&lt;0\\Rightarrow |r_{FE}|&lt;1\\Rightarrow$ unconditionally stable</li>\n<li>$\\lambda&gt;0\\Rightarrow |r_{FE}|&lt;1\\Rightarrow \\begin{cases} \\Delta t&gt;\\frac{2}{|\\lambda|} &amp; stable\\ \\Delta t&lt;\\frac{2}{|\\lambda|} &amp; unsatble\\ \\end{cases}$</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"MultiStep-Method\"><a href=\"#MultiStep-Method\" class=\"headerlink\" title=\"MultiStep Method\"></a>MultiStep Method</h2><ul>\n<li>Adams-Bash forth (explicit method)<br>$$y_{n+1}=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})$$ </li>\n<li>Adams-Moulthon (implicit method)<br>$$y_{n+1}=y_n+\\frac{\\Delta t}{2}(f_{n+1}+f_n)$$</li>\n<li>Predictor-Corrector<br>$$y_{n+1}^P=y_n+\\frac{\\Delta t}{2}(3f_n-f_{n-1})\\y_{n+1}=y_n+\\frac{\\Delta t}{2}[f(t_{n+1},y_{n+1}^P)+f_n]$$</li>\n</ul>\n<h2 id=\"Matlab-for-ODE45\"><a href=\"#Matlab-for-ODE45\" class=\"headerlink\" title=\"Matlab for ODE45\"></a>Matlab for ODE45</h2><p>solve this equation $\\frac{d^2y(t)}{dt^2}+\\epsilon[y^2(t)-1]\\frac{dy(t)}{dt}+y(t)=0$ with $\\epsilon$=0.1, t=[0:0.5:32], y(t=0)=$\\sqrt 3$ and $\\frac{dy(t=0)}{dt}$=1 by ode45 method.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function f = fvdposc(t,y,epsilon)</span><br><span class=\"line\">f1 = y(2);                          %f1=y&apos;</span><br><span class=\"line\">f2 = -epsilon*(y(1)^2-1)*y(2)-y(1);%f2=y&apos;&apos;</span><br><span class=\"line\">f = [f1;f2];    %f must be a column vector</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">abstol=10^-6;reltol=10^-6;</span><br><span class=\"line\">options = odeset(&apos;AbsTol&apos;,abstol,&apos;RelTol&apos;,reltol);</span><br><span class=\"line\">%if options not specified, use the default one. the other items must be there.</span><br><span class=\"line\">[T,Y] = ode45( @(t,y) fvdposc(t,y,epsilon),tspan,y0,options);</span><br></pre></td></tr></table></figure>\n<p>In this way, we can get Y is a [65 $\\times$ 2] matrix. This first column is the y values in tspan, and the other columne is y values in tspan.</p>\n<h1 id=\"Boundary-Value-Problem\"><a href=\"#Boundary-Value-Problem\" class=\"headerlink\" title=\"Boundary Value Problem\"></a>Boundary Value Problem</h1><p>There might be multiple solutions to this kind of problem, and we should choose those suit boundary conditions. Lets start with a simple case:</p>\n<p>$$<br>\\frac{d^2y}{dt^2} = f(t,y,\\frac{dy}{dt})\\quad y(a) = \\alpha\\quad y(b) = \\beta<br>$$</p>\n<h2 id=\"Shooting-Method\"><a href=\"#Shooting-Method\" class=\"headerlink\" title=\"Shooting Method\"></a>Shooting Method</h2><p>Actually, BVP is  comparable to IVP:</p>\n<ul>\n<li>IVP: y(a)=$\\alpha$, y(a)=A</li>\n<li>BVP: y(a)=$\\alpha$, y(b)=$\\beta$</li>\n</ul>\n<p>So we can guess an initial condition to see how difference the result from the other boundary value; and decide a new initial guess to repeat the above process until the result reaches the other boundary value.</p>\n<h2 id=\"Direct-Linear-BVP\"><a href=\"#Direct-Linear-BVP\" class=\"headerlink\" title=\"Direct-Linear BVP\"></a>Direct-Linear BVP</h2><p>Here we can consider a general case:</p>\n<p>$$<br>\\frac{d^2y}{dt^2}=p(t)\\frac{dy}{dt}+q(t)y+r(t)\\<br>\\alpha_1y(a)+\\beta_1y(a)=\\gamma_1\\<br>\\alpha_2y(b)+\\beta_2y(b)=\\gamma_2<br>$$</p>\n<p>Combine Taylor series and central difference method $y=\\frac{y(t+\\Delta t)-y(t-\\Delta t)}{2\\Delta t}+O(\\Delta t^2)$, we can get $y=\\frac{y(t+\\Delta t)-2y(t)+y(t-\\Delta t)}{\\Delta t^2}+O(\\Delta t^2)$. Finally, we can get: </p>\n<p>$$[1-\\frac{p(t)\\Delta t}{2}]\\cdot y(t+\\Delta t)-[2+q(t)\\Delta t^2]\\cdot y(t)+[1+\\frac{p(t)\\Delta t}{2}]\\cdot y(t-\\Delta t)=r(t)\\Delta t^2$$</p>\n<p>Convert it in to matrix form:</p>\n<p>$$A\\times \\overrightarrow x = \\overrightarrow b$$</p>\n<p>$$ \\begin{pmatrix} 1 &amp; 0 &amp;\\cdots &amp;\\cdots &amp;\\cdots &amp; 0 \\ a &amp; b &amp; c &amp; 0 &amp;\\cdots &amp;0 \\0&amp;a&amp;b&amp;c&amp;\\cdots&amp;0\\\\vdots&amp;\\ddots&amp;\\ddots&amp;\\ddots&amp;\\ddots&amp;\\vdots\\\\vdots&amp;\\ddots&amp;\\ddots&amp;a&amp;b&amp;c\\0&amp;\\cdots&amp;\\cdots&amp;\\cdots&amp;a&amp;1 \\end{pmatrix} \\times \\begin{pmatrix}y(t_0)\\y(t+\\Delta t)\\y(t+2\\Delta t)\\\\vdots\\\\vdots\\y(t_N) \\end{pmatrix}=\\begin{pmatrix} \\alpha\\r(t+\\Delta t)\\Delta t^2\\ r(t+2\\Delta t)\\Delta t^2\\\\vdots\\\\vdots\\\\beta \\end{pmatrix}$$</p>\n<p>In Matlab, we can use function <code>X=A\\b</code> or <code>eig(A)</code> to solve it; in python(numpy), function <code>linalg.solve(A,b)</code> or <code>eig(A)</code> also works.</p>\n<h2 id=\"Newton-Raphson-Method\"><a href=\"#Newton-Raphson-Method\" class=\"headerlink\" title=\"Newton-Raphson Method\"></a>Newton-Raphson Method</h2><p>One thing must be noted that, initial guess for this method should be close to the real value, otherwise it may diverge.<br>$$x_{n+1}=x_n-\\frac{f(x_n)}{f(x_n)}$$</p>\n<h2 id=\"Summary\"><a href=\"#Summary\" class=\"headerlink\" title=\"Summary\"></a>Summary</h2><ol>\n<li>Approximate y, y using central difference formula;</li>\n<li>Approximate boundary condition using FDF, DBF</li>\n<li>Solve $A\\overrightarrow x=\\overrightarrow b$</li>\n<li>solutionO($\\Delta t^2$)</li>\n</ol>\n<h2 id=\"Quantum-Harmonic-Oscillation\"><a href=\"#Quantum-Harmonic-Oscillation\" class=\"headerlink\" title=\"Quantum Harmonic Oscillation\"></a>Quantum Harmonic Oscillation</h2><p>$$\\frac{d^2\\phi_n}{dx^2}-[Kx^2-\\varepsilon_n]\\phi_n=0$$<br>we expect the solution $\\phi_n(x)\\rightarrow 0$ as $x\\rightarrow \\pm \\infty$ and $\\varepsilon_n&gt;0$ is the quantum energy. Note that $K=km/\\hbar^2$ and $\\varepsilon_n=E_nm/\\hbar^2$. Here take K=1, and always normalize so that $\\int_{-\\infty} ^{+\\infty} {|\\phi_n|^2} \\,{\\rm d}x=1$. Calculate the first five normalized eigenfunctions ($\\phi_n$) and eigenvalues($\\varepsilon_n$) up to tolerance of $10^{-4}$ in increasing order such that the first eigenvalue is the lowest one.</p>\n<ul>\n<li>Shooting method</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function f=pdefunc(x,y,e)</span><br><span class=\"line\"></span><br><span class=\"line\">f1 = y(2);</span><br><span class=\"line\">f2 = (x^2-e)*y(1);</span><br><span class=\"line\"></span><br><span class=\"line\">f = [f1;f2];</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">L=4; dx=0.1; e_start=0.5; tol=10^-4;</span><br><span class=\"line\"></span><br><span class=\"line\">xspan = -L:dx:L;</span><br><span class=\"line\">A = 1; % suggest A=phi(-L)=phi(L)</span><br><span class=\"line\"></span><br><span class=\"line\">for modes=1:5</span><br><span class=\"line\">    e = e_start;</span><br><span class=\"line\">    de=0.01;</span><br><span class=\"line\">    for j=1:1000</span><br><span class=\"line\">        y0 = [A;A*sqrt(L^2-e)];</span><br><span class=\"line\">        </span><br><span class=\"line\">        [x,phi] = ode45( @(x,phi) pdefunc(x,phi,e), xspan ,y0);</span><br><span class=\"line\">        </span><br><span class=\"line\">        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);</span><br><span class=\"line\">        if abs(rightbc)&lt;tol</span><br><span class=\"line\">            eigen_e(modes,1)=e;</span><br><span class=\"line\">            break;</span><br><span class=\"line\">        end</span><br><span class=\"line\">        </span><br><span class=\"line\">        if (-1)^(1+modes)*rightbc&gt;0</span><br><span class=\"line\">            e = e+de;</span><br><span class=\"line\">        else</span><br><span class=\"line\">            de = de/2;</span><br><span class=\"line\">            e = e-de;</span><br><span class=\"line\">        end</span><br><span class=\"line\">    end</span><br><span class=\"line\">    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));</span><br><span class=\"line\">        e_start = e+0.2;</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">%eigen_phi,eigen_e are what we want</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Direct Method</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">L=4; dx=0.1; </span><br><span class=\"line\">xspan = -L:dx:L;</span><br><span class=\"line\">max = length(xspan)-2;</span><br><span class=\"line\">A = zeros(max,max);</span><br><span class=\"line\">phi_sort = zeros(max+2,max+2);</span><br><span class=\"line\">% build up A matrix which doesn&apos;t consider phi(x1) and phi(xn). A is built</span><br><span class=\"line\">% based on 2nd order central difference. The first and last row don&apos;t</span><br><span class=\"line\">% consider x1 and xn, use FDF and BDF and approximation to make phi(x2) and</span><br><span class=\"line\">% phi(x3) express phi(x1); phi(xn-2) and phi(xn-1) express phi(xn).</span><br><span class=\"line\">A(1,1:2) = [2/3/dx^2+xspan(2)^2,-2/3/dx^2];</span><br><span class=\"line\">A(end,end-1:end) = [-2/3/dx^2,2/3/dx^2+xspan(end-1)^2];</span><br><span class=\"line\">i = 2;</span><br><span class=\"line\">while i&lt;max</span><br><span class=\"line\">    A(i,i-1) = -1/dx^2;</span><br><span class=\"line\">    A(i,i+1) = -1/dx^2;</span><br><span class=\"line\">    A(i,i) = 2/dx^2+xspan(i+1)^2;</span><br><span class=\"line\">    i=i+1;</span><br><span class=\"line\">end</span><br><span class=\"line\">%phi function only contains [phi(2),phi(3),...phi(n-2),phi(n-1)]</span><br><span class=\"line\">[phi,e]=eig(A);</span><br><span class=\"line\"></span><br><span class=\"line\">%sort phi function based on ascending energy.</span><br><span class=\"line\">for i=1:max</span><br><span class=\"line\">    eng(i,1) = e(i,i);</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">[eng, Index_eng] = sort(eng);</span><br><span class=\"line\"></span><br><span class=\"line\">%only get the first five phi functions. </span><br><span class=\"line\">%phi(1)/phi(N) are calculated based on FDF/BDF method without approximation.</span><br><span class=\"line\">for i =1:5</span><br><span class=\"line\">    phi_sort(2:end-1,i) = phi(:,Index_eng(i));</span><br><span class=\"line\">    phi_sort(1,i) = (4*phi_sort(2,i)-phi_sort(3,i))/(3+2*dx*sqrt(L^2-eng(i)));</span><br><span class=\"line\">    phi_sort(end,i) = (4*phi_sort(end-1,i)-phi_sort(end-2,i))/(3+2*dx*sqrt(L^2-eng(i)));</span><br><span class=\"line\">    phi_sort(:,i) = phi_sort(:,i)/sqrt(trapz(xspan,phi_sort(:,i).^2));</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">%phi_sort,eng is the result</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Shooting for nonlinear cases</li>\n</ul>\n<p>$$\\frac{d^2\\phi_n}{dx^2}-[\\gamma |\\phi_n|^2+Kx^2-\\varepsilon_n]\\phi_n=0$$\\</p>\n<p>Still use $x\\in [-L,L]$ with L=2 and choose xspan = -L:0.1:L. Find the first two normalized modes for  $\\gamma=0.05$:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">L=2; dx=0.1; e_start=0.5; tol=10^-4; gama=0.05; A_start=0.2;</span><br><span class=\"line\">xspan = -L:dx:L;</span><br><span class=\"line\"></span><br><span class=\"line\">for modes=1:2</span><br><span class=\"line\">    e = e_start;</span><br><span class=\"line\">    de=0.01;</span><br><span class=\"line\">    for j=1:1000</span><br><span class=\"line\">        A = A_start;</span><br><span class=\"line\">        dA = 0.1;</span><br><span class=\"line\">        for a=1:1000</span><br><span class=\"line\">            y0 = [A;A*sqrt(L^2-e)];</span><br><span class=\"line\">            </span><br><span class=\"line\">            [x,phi] = ode45( @(x,phi) nolinpdefunc(x,phi,gama,e), xspan ,y0);</span><br><span class=\"line\">         </span><br><span class=\"line\">            AA = trapz(x,phi(:,1).^2);</span><br><span class=\"line\">           </span><br><span class=\"line\">            if abs(AA-1)&lt;tol</span><br><span class=\"line\">                opt_A(modes,1)=A;</span><br><span class=\"line\">                break;</span><br><span class=\"line\">            end</span><br><span class=\"line\">            if AA&gt;1</span><br><span class=\"line\">                A = A-dA;</span><br><span class=\"line\">            else</span><br><span class=\"line\">                dA = dA/2;</span><br><span class=\"line\">                A = A+dA;</span><br><span class=\"line\">            end       </span><br><span class=\"line\">        end</span><br><span class=\"line\">        </span><br><span class=\"line\">        rightbc = phi(end,2)+sqrt(L^2-e)*phi(end,1);</span><br><span class=\"line\">        if abs(rightbc)&lt;tol</span><br><span class=\"line\">            eigen_e(modes,1)=e;</span><br><span class=\"line\">            break;</span><br><span class=\"line\">        end</span><br><span class=\"line\">        </span><br><span class=\"line\">        if (-1)^(1+modes)*rightbc&gt;0</span><br><span class=\"line\">            e = e+de;</span><br><span class=\"line\">        else</span><br><span class=\"line\">            de = de/2;</span><br><span class=\"line\">            e = e-de;</span><br><span class=\"line\">        end</span><br><span class=\"line\">    end</span><br><span class=\"line\">    e_start = e+1;</span><br><span class=\"line\">    A_start = A+1;</span><br><span class=\"line\">    eigen_phi(:,modes) = phi(:,1)/sqrt(trapz(x,phi(:,1).^2));    </span><br><span class=\"line\">end</span><br></pre></td></tr></table></figure>\n<h1 id=\"Partial-Differential-Equations\"><a href=\"#Partial-Differential-Equations\" class=\"headerlink\" title=\"Partial Differential Equations\"></a>Partial Differential Equations</h1><p>Solving PDE is harder than ODE, because we need to consider both initial conditions and boundary conditions, also need to solve both in time and in space. The classic PDE is vortivity-streamfunction equations and reaction-diffusion systems. We will go through these two systems to show how to slove PDE.</p>\n<h2 id=\"Finite-Scheme-Method-for-Vorticity-Streamfunction-Equations\"><a href=\"#Finite-Scheme-Method-for-Vorticity-Streamfunction-Equations\" class=\"headerlink\" title=\"Finite Scheme Method for Vorticity-Streamfunction Equations\"></a>Finite Scheme Method for Vorticity-Streamfunction Equations</h2><p>$$\\omega_t+[\\psi,\\omega]=\\mu\\nabla^2\\psi\\quad \\nabla^2\\psi=\\omega\\<br>where\\; [\\psi,\\omega]=\\psi_x\\omega_y-\\psi_y\\omega_x \\; and \\; \\nabla^2=\\partial_x^2+\\partial_y^2$$</p>\n<ul>\n<li><p>Steps:</p>\n<ol>\n<li>Elliptic Solve: given $\\omega_0 \\rightarrow$ compute $\\psi_0$ by using $ \\nabla^2\\psi=\\omega$</li>\n<li>Time-Stepping: choose step $\\Delta t$ compute $\\omega $ using $\\omega_{k+1}=\\omega_k+\\Delta t\\cdot f(\\psi^k,\\omega^k)$</li>\n<li>Iterate</li>\n</ol>\n</li>\n<li><p>Step 1: the elliptic problem<br>$$(\\psi_{mn})<em>{xx}+(\\psi</em>{mn})<em>{yy}=\\omega</em>{mn}$$<br>By using CDF:<br>$$\\frac{\\psi_{m-1,n}-2\\psi_{m,n}+\\psi_{m+1,n}}{\\Delta x^2}+\\frac{\\psi_{m,n-1}-2\\psi_{m,n}+\\psi_{m,n+1}}{\\Delta y^2}=\\omega_{m,n}\\delta^2$$<br>If we set $\\Delta x=\\Delta y$, and reshape the matrix $\\psi_{m,n}$ and $\\omega_{m,n}$ (m=n)to vectors (the same thing as matlab fucntion <code>reshape(matrix,n^2,1)</code>), we can write the above equation into a matrix form:<br>$$A\\overrightarrow \\psi = \\overrightarrow \\omega $$<br>where $A=A/\\delta^2$, $A=A_D+A_x+A_y$, $A_D=-4\\psi_{m,n}$, $A_x=\\psi_{m-1,n}+\\psi_{m,n-1}$ and $A_y=\\psi_{m,n-1}+\\psi_{m,n+1}$</p>\n</li>\n<li><p><em>Matlab script</em></p>\n<p>  $A=\\nabla^2$, $B=\\partial_x$, $C=\\partial_y$</p>\n</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function [A B C] = derivmatrix(dx,dy,n)</span><br><span class=\"line\"></span><br><span class=\"line\">e1 = ones(n^2,1);</span><br><span class=\"line\">%A = dx^2+dy^2</span><br><span class=\"line\"></span><br><span class=\"line\">%A = (AD+AX+AY)/dx/dy; AD=-4y(m,n),AX=y(m-1,n)+y(m+1,n), AY=y(m,n-1)+y(m,n+1)</span><br><span class=\"line\">AD = spdiags(-4*e1,0,n^2,n^2); </span><br><span class=\"line\">AD(1,1)=2;%set the first element not -4 to avoid denominator too small</span><br><span class=\"line\">AX = spdiags([e1 e1 e1 e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2);</span><br><span class=\"line\">AY = spdiags([e1 e1],[-1 1],n^2,n^2);</span><br><span class=\"line\">for i=1:n</span><br><span class=\"line\">    AY(1+n*(i-1),n*i) = 1;</span><br><span class=\"line\">    AY(n*i,1+n*(i-1)) = 1;</span><br><span class=\"line\">    if i&lt;n</span><br><span class=\"line\">        AY(n*i,1+n*i) = 0;</span><br><span class=\"line\">        AY(1+n*i,n*i) = 0;</span><br><span class=\"line\">    end</span><br><span class=\"line\">end</span><br><span class=\"line\">A = (AD+AX+AY)/(dx*dy);</span><br><span class=\"line\"></span><br><span class=\"line\">%B = dx</span><br><span class=\"line\">%B = (y(m+1,n)-y(m-1,n))/(2*dx)</span><br><span class=\"line\">B = spdiags([e1 -e1 e1 -e1],[-(n-1)*n -n n n*(n-1)],n^2,n^2)/(2*dx);</span><br><span class=\"line\"></span><br><span class=\"line\">%C = dy</span><br><span class=\"line\">%C = (y(m,n+1)-y(m,n-1))/(2*dy)</span><br><span class=\"line\">C = spdiags([-e1 e1],[-1,1],n^2,n^2);</span><br><span class=\"line\">for i=1:n</span><br><span class=\"line\">    C(1+n*(i-1),n*i) = -1;</span><br><span class=\"line\">    C(n*i,1+n*(i-1)) = 1;</span><br><span class=\"line\">    if i&lt;n</span><br><span class=\"line\">        C(n*i,1+n*i) = 0;</span><br><span class=\"line\">        C(1+n*i,n*i) = 0;</span><br><span class=\"line\">    end</span><br><span class=\"line\">end</span><br><span class=\"line\">C = C/(2*dy);</span><br></pre></td></tr></table></figure>\n<p>then, we could use one of these two method to slove $\\psi$</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">psi = A\\w;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[L,U,P] = lu(A);</span><br><span class=\"line\">y=L\\(P*w);</span><br><span class=\"line\">psi = U\\y;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Step 2: Method Line</li>\n</ul>\n<p>$$<br>\\nabla^2\\psi(x,y)=f(x,y)\\qquad+b.c.\\<br>u_t(t,x)=u_x(t,x)\\quad+i.c.,b.c.\\<br>u_x(t,x)\\approx\\frac{u(x+\\Delta x)-u(x-\\Delta x)}{2\\Delta x}<br>$$<br>We have to condiser the stability of this method. Choose $\\lambda$ carefully to make sure it is stable and also will not run forever.<br>$$u_n^{(m)}=g^mexp(i\\zeta\\Delta x)\\<br>$$\\lambda =\\frac{\\Delta t^{num-t-der}} {\\Delta x^{num-x-der}}$$</p>\n<h2 id=\"Spectral-Method-for-Vorticity-Streamfunction-Equations\"><a href=\"#Spectral-Method-for-Vorticity-Streamfunction-Equations\" class=\"headerlink\" title=\"Spectral Method for Vorticity-Streamfunction Equations\"></a>Spectral Method for Vorticity-Streamfunction Equations</h2><p>expand u(x,t):</p>\n<p>$$u(x,t)=\\sum_{k=1}^N a_k(t)\\phi_k(x)\\qquad$$<br> where $\\phi_k(x)$are orthogonal<br>Using Fourier Series</p>\n<p>$$\\widehat{u}(t)=u(k,t)=\\sum_{n=1}^N u(n,t)e^{-i2\\pi(k-1)(n-1)/N}\\\\qquad\\;u(n,t)=1/N\\sum_{n=1}^N \\widehat u(t)e^{i2\\pi(k-1)(n-1)/N}$$<br>Derivative property:<br>$$\\widehat u^{(m)}(x,t)=(ik)^{(m)}\\widehat u(k,t)$$<br>PDE  Fourier Space<br>$$u_t=Lu+N(u) \\Longrightarrow \\widehat(u)_t=\\alpha(k)\\widehat u+\\widehat N(u)$$<br>Here attached the script for solve VSE by the above two methods.</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">clear all; clf; close all; clc</span><br><span class=\"line\">nu = 0.001;</span><br><span class=\"line\">n=64;</span><br><span class=\"line\">L=10;</span><br><span class=\"line\">tspan = 0:0.5:4;</span><br><span class=\"line\"></span><br><span class=\"line\">w1 = runvs(L,n,tspan,nu,1);</span><br><span class=\"line\"></span><br><span class=\"line\">w2 = runvs(L,n,tspan,nu,2);</span><br><span class=\"line\"></span><br><span class=\"line\">w3 = runvs(L,n,tspan,nu,3);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function wfsol = runvs(L,n,tspan,nu,choice)</span><br><span class=\"line\"></span><br><span class=\"line\">x2 = linspace(-L/2,L/2,n+1);</span><br><span class=\"line\">x = x2(1:n);</span><br><span class=\"line\">dx = x(2)-x(1);</span><br><span class=\"line\"></span><br><span class=\"line\">[X,Y] = meshgrid(x);%grid</span><br><span class=\"line\">[A,B,C] = derivmatrix(dx,dx,n);%apply to vector [64*64,1]</span><br><span class=\"line\"></span><br><span class=\"line\">wfinit = exp(-X.^2-Y.^2/20);%grid</span><br><span class=\"line\">wfinitvect = reshape(wfinit,n^2,1);%vector</span><br><span class=\"line\"></span><br><span class=\"line\">[t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,1),tspan,wfinitvect);</span><br><span class=\"line\"></span><br><span class=\"line\">if choice==3</span><br><span class=\"line\">    kx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];</span><br><span class=\"line\">    kx(1) = 1e-6;</span><br><span class=\"line\"></span><br><span class=\"line\">    [KX,KY]=meshgrid(kx);</span><br><span class=\"line\">    K = KX.^2+KY.^2;</span><br><span class=\"line\">    </span><br><span class=\"line\">    [t,wfsol] = ode45(@(t,wfvec) vortstream(t,wfvec,n,nu,A,B,C,choice,K)tspan,wfinitvect);</span><br><span class=\"line\">end</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function rhs = vortstream(t,w,n,nu,A,B,C,choice,K)</span><br><span class=\"line\"></span><br><span class=\"line\">if choice==1</span><br><span class=\"line\">    psi = A\\w;%vector</span><br><span class=\"line\">elseif choice==2</span><br><span class=\"line\">    [L,U,P] = lu(A);</span><br><span class=\"line\">    y=L\\(P*w);</span><br><span class=\"line\">    psi = U\\y;</span><br><span class=\"line\">else</span><br><span class=\"line\">    wf = fft2(reshape(w,n,n));</span><br><span class=\"line\">    psif = -wf./K;</span><br><span class=\"line\">    psi = reshape(real(ifft2(psif)),n^2,1);</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">rhs = -(B*psi).*(C*w)+(C*psi).*(B*w)+nu*A*w;%vector</span><br></pre></td></tr></table></figure>\n<h2 id=\"Chebishev-Polynomials\"><a href=\"#Chebishev-Polynomials\" class=\"headerlink\" title=\"Chebishev Polynomials\"></a>Chebishev Polynomials</h2><p>$$\\phi_k(x)=T_k(x)\\quad T_k(cos\\theta)=cosk\\theta$$<br>Matlab Script:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function [D,x] = cheb(N)</span><br><span class=\"line\">  if N==0, D=0; x=1; return, end</span><br><span class=\"line\">  x = cos(pi*(0:N)/N)&apos;; </span><br><span class=\"line\">  c = [2; ones(N-1,1); 2].*(-1).^(0:N)&apos;;</span><br><span class=\"line\">  X = repmat(x,1,N+1);</span><br><span class=\"line\">  dX = X-X&apos;;                  </span><br><span class=\"line\">  D  = (c*(1./c)&apos;)./(dX+(eye(N+1)));      % off-diagonal entries</span><br><span class=\"line\">  D  = D - diag(sum(D&apos;));                 % diagonal entries</span><br></pre></td></tr></table></figure>\n<p>Solve reaction-diffusion system with both spectral and cheb methods<br>$$U_t=\\lambda(A)U-\\omega (A)V+D_1\\nabla^2U\\V_t=\\omega (a)U+\\lambda(A)V+D_2\\nabla^2V$$<br>where $A^2=U^2+V^2$ and $\\nabla^2=\\partial_x^2+\\partial_y^2$. Consider $\\lambda(A)=1-A^2$ and $\\omega(A)=-\\beta A^2$</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">clear all; close all; clc</span><br><span class=\"line\">L=20;n=64;beta=1;d1=0.1;d2=d1;m=1;</span><br><span class=\"line\">tspan=0:0.5:4;</span><br><span class=\"line\"></span><br><span class=\"line\">uv1 = runrds_fft(tspan,L,n,beta,d1,d2,m);</span><br><span class=\"line\">A1 = real(uv1);</span><br><span class=\"line\">A2 = imag(uv1);</span><br><span class=\"line\"></span><br><span class=\"line\">n=31;</span><br><span class=\"line\">uv2 = runrds_cheb(tspan,L,n,beta,d1,d2,m);</span><br><span class=\"line\">A3 = uv2;</span><br></pre></td></tr></table></figure>\n<p>we consider $x,y \\in[-10,10]$, n=64, $\\beta =1$, $D_1=D_2=0.1$, m=1, tspan=0:0.5:4 and $u_f$ stacked on top of $v_f$.<br>The following is FFT(spectral) method:</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function xfsol = runrds_fft(tspan,L,n,beta,d1,d2,m)</span><br><span class=\"line\"></span><br><span class=\"line\">x2 = linspace(-L/2,L/2,n+1);</span><br><span class=\"line\">x = x2(1:n);</span><br><span class=\"line\">y=x;</span><br><span class=\"line\"></span><br><span class=\"line\">kx = (2*pi/L)*[0:(n/2-1) (-n/2):-1];</span><br><span class=\"line\">kx(1) = 1e-6;</span><br><span class=\"line\">ky=kx;</span><br><span class=\"line\"></span><br><span class=\"line\">[X,Y]=meshgrid(x,y);</span><br><span class=\"line\">[KX,KY]=meshgrid(kx,ky);</span><br><span class=\"line\">K = KX.^2+KY.^2;</span><br><span class=\"line\">Kvec = reshape(K,n^2,1);</span><br><span class=\"line\"></span><br><span class=\"line\">uint = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid</span><br><span class=\"line\">vint = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));</span><br><span class=\"line\">ufint = fft2(uint);</span><br><span class=\"line\">vfint = fft2(vint);</span><br><span class=\"line\">ufvecint = reshape(ufint,n^2,1);</span><br><span class=\"line\">vfvecint = reshape(vfint,n^2,1);</span><br><span class=\"line\">xfvecint = [ufvecint;vfvecint];</span><br><span class=\"line\"></span><br><span class=\"line\">[t,xfsol] = ode45(@(t,xfvec) rds_fft(t,xfvec,beta,Kvec,n,d1,d2),tspan,xfvecint);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function rhs = rds_fft(t,xfvec,beta,Kvec,n,d1,d2)</span><br><span class=\"line\"></span><br><span class=\"line\">ufvec = xfvec(1:n^2);</span><br><span class=\"line\">vfvec = xfvec(n^2+1:end);</span><br><span class=\"line\"></span><br><span class=\"line\">u = real(ifft2(reshape(ufvec,n,n)));</span><br><span class=\"line\">v = real(ifft2(reshape(vfvec,n,n)));</span><br><span class=\"line\">A = u.^2+v.^2;</span><br><span class=\"line\">l = 1-A;</span><br><span class=\"line\">w = -beta*A;</span><br><span class=\"line\"></span><br><span class=\"line\">uft = reshape(fft2(l.*u-w.*v),n^2,1)-d1*Kvec.*ufvec;</span><br><span class=\"line\">vft = reshape(fft2(w.*u+l.*v),n^2,1)-d2*Kvec.*vfvec;</span><br><span class=\"line\"></span><br><span class=\"line\">rhs = [uft;vft];</span><br></pre></td></tr></table></figure>\n<p>The following is cheb method with n=30 and m=1</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function xsolvec = runrds_cheb(tspan,L,n,beta,d1,d2,m)</span><br><span class=\"line\"></span><br><span class=\"line\">[D,x2] = cheb(n-1);</span><br><span class=\"line\">D2= D^2;</span><br><span class=\"line\">D2(1,:) = zeros(1,n);</span><br><span class=\"line\">D2(n,:) = zeros(1,n);%boundary should be 0</span><br><span class=\"line\">I = eye(length(D2));</span><br><span class=\"line\">Lap = kron(D2,I)+kron(I,D2);</span><br><span class=\"line\"></span><br><span class=\"line\">x = x2*L/2;</span><br><span class=\"line\">[X,Y]=meshgrid(x);</span><br><span class=\"line\"></span><br><span class=\"line\">uinit = tanh(sqrt(X.^2+Y.^2)).*cos(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));%grid</span><br><span class=\"line\">vinit = tanh(sqrt(X.^2+Y.^2)).*sin(m*angle(X+i*Y)-(sqrt(X.^2+Y.^2)));</span><br><span class=\"line\"></span><br><span class=\"line\">uvecinit = reshape(uinit,n^2,1);</span><br><span class=\"line\">vvecinit = reshape(vinit,n^2,1);</span><br><span class=\"line\">xvecinit = [uvecinit;vvecinit];</span><br><span class=\"line\"></span><br><span class=\"line\">[t,xsolvec] =ode45(@(t,xvec) rds_cheb(t,L,xvec,beta,Lap,n,d1,d2),tspan,xvecinit);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function rhs = rds_cheb(t,L,xvec,beta,Lap,n,d1,d2)</span><br><span class=\"line\"></span><br><span class=\"line\">uvec = xvec(1:n^2);</span><br><span class=\"line\">vvec = xvec(n^2+1:end);</span><br><span class=\"line\"></span><br><span class=\"line\">Avec = uvec.^2+vvec.^2;</span><br><span class=\"line\">lvec = 1-Avec;</span><br><span class=\"line\">wvec = -beta*Avec;</span><br><span class=\"line\"></span><br><span class=\"line\">ut = lvec.*uvec-wvec.*vvec+d1*4/L^2*Lap*uvec;</span><br><span class=\"line\">vt = wvec.*uvec+lvec.*vvec+d2*4/L^2*Lap*vvec;</span><br><span class=\"line\"></span><br><span class=\"line\">rhs = [ut;vt];</span><br></pre></td></tr></table></figure>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cjqojihkq0000p45kydpwb5ub","category_id":"cjqojihky0004p45kfrwh3471","_id":"cjqojihl40009p45k6ozlyc67"},{"post_id":"cjqojihkw0002p45kvtn41oio","category_id":"cjqojihky0004p45kfrwh3471","_id":"cjqojihl5000bp45k4qy9716q"},{"post_id":"cjqojihq3000gp45k1fl8i9n3","category_id":"cjqojihky0004p45kfrwh3471","_id":"cjqojihq9000mp45kftqhm1aw"},{"post_id":"cjqojihq4000hp45kvwepg5u7","category_id":"cjqojihq8000jp45kbr6k1wup","_id":"cjqojihqa000pp45kag54edcp"},{"post_id":"cjqojihr9000sp45k3pjf63wq","category_id":"cjqojihky0004p45kfrwh3471","_id":"cjqojihrd000xp45kw6udnkdc"},{"post_id":"cjqojihrb000tp45kv9b694md","category_id":"cjqojihq8000jp45kbr6k1wup","_id":"cjqojihrd000zp45kte5eczop"}],"PostTag":[{"post_id":"cjqojihkq0000p45kydpwb5ub","tag_id":"cjqojihl00005p45k4jaq0qpi","_id":"cjqojihl30008p45kl2s44e4y"},{"post_id":"cjqojihkw0002p45kvtn41oio","tag_id":"cjqojihl00005p45k4jaq0qpi","_id":"cjqojihl5000dp45kh5st7j6c"},{"post_id":"cjqojihkw0002p45kvtn41oio","tag_id":"cjqojihl4000ap45kpd87es0h","_id":"cjqojihl5000ep45kygdjv9fq"},{"post_id":"cjqojihkw0002p45kvtn41oio","tag_id":"cjqojihl5000cp45khkxm69sr","_id":"cjqojihl5000fp45kslu7qq5b"},{"post_id":"cjqojihq3000gp45k1fl8i9n3","tag_id":"cjqojihl00005p45k4jaq0qpi","_id":"cjqojihq7000ip45kxqq84pr4"},{"post_id":"cjqojihq3000gp45k1fl8i9n3","tag_id":"cjqojihl4000ap45kpd87es0h","_id":"cjqojihq8000lp45kqt3j3t61"},{"post_id":"cjqojihq3000gp45k1fl8i9n3","tag_id":"cjqojihl5000cp45khkxm69sr","_id":"cjqojihq9000np45ka5fx5dbp"},{"post_id":"cjqojihq4000hp45kvwepg5u7","tag_id":"cjqojihq8000kp45kbn7szzp6","_id":"cjqojihqb000qp45kr1hs1xo0"},{"post_id":"cjqojihq4000hp45kvwepg5u7","tag_id":"cjqojihqa000op45kus5jw2u8","_id":"cjqojihqb000rp45krznld2qo"},{"post_id":"cjqojihr9000sp45k3pjf63wq","tag_id":"cjqojihl00005p45k4jaq0qpi","_id":"cjqojihrc000up45kvame3nx6"},{"post_id":"cjqojihr9000sp45k3pjf63wq","tag_id":"cjqojihl4000ap45kpd87es0h","_id":"cjqojihrd000wp45kohrj0g6v"},{"post_id":"cjqojihr9000sp45k3pjf63wq","tag_id":"cjqojihl5000cp45khkxm69sr","_id":"cjqojihrd000yp45kicmvuvj8"},{"post_id":"cjqojihrb000tp45kv9b694md","tag_id":"cjqojihrd000vp45k0gwpqz4e","_id":"cjqojihrd0010p45keakymyv4"}],"Tag":[{"name":"Hyak","_id":"cjqojihl00005p45k4jaq0qpi"},{"name":"ComputChem","_id":"cjqojihl4000ap45kpd87es0h"},{"name":"software","_id":"cjqojihl5000cp45khkxm69sr"},{"name":"nucleotide","_id":"cjqojihq8000kp45kbn7szzp6"},{"name":"pubNote","_id":"cjqojihqa000op45kus5jw2u8"},{"name":"AMATH","_id":"cjqojihrd000vp45k0gwpqz4e"}]}}